# GPU Codegen Types Re-export
#
# Re-exports GPU codegen trait types without going through the
# "common" directory (which is a reserved keyword in the interpreter parser).

use compiler.mir.mir_data.{MirBody, MirInst, MirOperand, LocalId}
use compiler.core.backend_types.{CompileError}

enum GpuBarrierScope:
    """Scope of a GPU synchronization barrier."""
    Workgroup
    Device
    Subgroup

enum GpuAtomicOpKind:
    """Kind of atomic operation on GPU."""
    Add
    Sub
    Min
    Max
    And
    Or
    Xor
    Exchange
    CompareExchange

trait GpuCodegen:
    """Interface for GPU code generation backends."""
    fn compile_kernel(func_name: text, body: MirBody) -> Result<text, CompileError>
    fn compile_device_function(func_name: text, body: MirBody) -> Result<text, CompileError>
    fn compile_gpu_instruction(inst: MirInst) -> text
    fn compile_barrier(scope: GpuBarrierScope) -> text
    fn compile_atomic(op: GpuAtomicOpKind, dest: LocalId, ptr: MirOperand, value: MirOperand) -> text
    fn gpu_memory_model() -> text
    fn is_kernel_function(body: MirBody) -> bool

export GpuCodegen, GpuBarrierScope, GpuAtomicOpKind
