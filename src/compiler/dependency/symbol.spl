# Symbol Table - Cross-module symbol tracking
#
# This module provides symbol table management for tracking symbols
# across modules, their visibility, and handling import resolution.
#
# Corresponds to Rust: src/rust/dependency_tracker/src/symbol.rs

use compiler.dependency.visibility.{Visibility}

# The kind of a symbol entry
enum SymbolKind:
    Function    # Function definition
    Type        # Type definition (struct, class, enum)
    Constant    # Constant value
    Variable    # Variable
    MacroKind   # Macro definition
    Module      # Module


# ============================================================================
# SymbolKind Methods (was: impl SymbolKind:)
# ============================================================================

# A symbol entry in the symbol table
struct SymbolEntry:
    name: text              # Local name
    qualified_name: text    # Fully qualified (e.g., "crate.sys.http.Router")
    kind: SymbolKind        # Kind of symbol
    visibility: Visibility  # Public or Private
    source_module: text     # Source module path
    is_imported: bool       # Imported vs locally defined
    original_name: text     # Original name if aliased (empty if not aliased)


# ============================================================================
# SymbolEntry Methods (was: impl SymbolEntry:)
# ============================================================================

# Symbol conflict error
struct SymbolConflictError:
    name: text                  # The conflicting name
    existing_qualified: text    # Existing symbol's qualified name
    new_qualified: text         # New symbol's qualified name


# ============================================================================
# SymbolConflictError Methods (was: impl SymbolConflictError:)
# ============================================================================

fn symbolconflicterror_new(name: text, existing: text, new_sym: text) -> SymbolConflictError:
        SymbolConflictError(
            name: name,
            existing_qualified: existing,
            new_qualified: new_sym
        )


# A symbol table for a single module
struct SymbolTable:
    module_path: text                       # Module path (e.g., "crate.sys.http")
    symbols: Dict<text, SymbolEntry>        # Symbols keyed by local name


# ============================================================================
# SymbolTable Methods (was: impl SymbolTable:)
# ============================================================================

fn symboltable_new(module_path: text) -> SymbolTable:
        SymbolTable(module_path: module_path, symbols: {})


# Public exports
export SymbolKind
export SymbolEntry
export SymbolConflictError
export SymbolTable
