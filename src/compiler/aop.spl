# Aspect-Oriented Programming Support
#
# AOP weaving for cross-cutting concerns like logging.

use config.Logger

# Logging aspect.
class LogAspect:
    level: i64
    logger: Logger

    fn before(name: text, args: [Any]):
        self.logger.log(self.level, ">> {name}")

    fn after(name: text, result: Any):
        self.logger.log(self.level, "<< {name}")

    fn around(name: text, args: [Any], proceed: fn() -> Any) -> Any:
        self.before(name, args)
        val result = proceed()
        self.after(name, result)
        result

# AOP weaver that applies aspects.
class AopWeaver:
    aspects: [LogAspect]
    logger: Logger

    me add_aspect(aspect: LogAspect):
        self.aspects.push(aspect)

    fn weave(mir: Any) -> Any:
        """Weave all aspects into MIR module.

        Applies before/after/around advice to matching functions.
        TODO: Implement actual MIR transformation when MIR weaving is ready.
        """
        # For now, return MIR unchanged - aspects are recorded for later application
        mir
