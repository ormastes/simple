use compiler.parser.*
use compiler.parser_types.*
use compiler.lexer.*
use compiler.blocks.*
use compiler.treesitter.*

print "=== Step-by-step Parser Test ==="
val src = "fn main() -> i64:\n    0\n"

# Step 1: Create TreeSitter outline
print "Step 1: TreeSitter..."
var ts = TreeSitter.new(src)
val outline = ts.parse_outline()
print "  Name: '{outline.name}'"
print "  Imports: {outline.imports.len()}"
print "  Functions: {outline.functions.len()}"
if outline.functions.len() > 0:
    print "  Fn[0] name: {outline.functions[0].name}"

# Step 2: Create parser with outline  
print "Step 2: Create parser with outline..."
var parser = Parser.new(src)
parser.outline = Some(outline)
print "  Parser created with outline"

# Step 3: Parse
print "Step 3: Parsing..."
val ast = parser.parse()
print "  Module: {ast.name}"
print "=== SUCCESS ==="
