# Interpreter Codegen Adapter
#
# Implements the Codegen trait for the interpreter backend.
# The interpreter doesn't produce object code; it returns
# an empty CodegenOutput with a MIR dump.

use compiler.mir_data.{MirModule}
use compiler.core.backend_types.{BackendKind, CodegenTarget, CompileOptions, CompileError}
use compiler.backend.codegen_types.{Codegen, CodegenOutput, CodegenOutputKind}
use compiler.backend.backend_helpers.{format_mir_module}

# ============================================================================
# Interpreter Codegen Adapter
# ============================================================================

class InterpreterCodegenAdapter:
    """Adapts the interpreter to the Codegen trait interface."""
    options: CompileOptions

impl Codegen for InterpreterCodegenAdapter:
    fn backend_kind() -> BackendKind: BackendKind.Interpreter
    fn backend_name() -> text: "interpreter"
    fn supports_target(target: CodegenTarget) -> bool: true
    fn output_kind() -> CodegenOutputKind: CodegenOutputKind.InterpretedResult

    fn compile_module(module: MirModule) -> Result<CodegenOutput, CompileError>:
        Ok(CodegenOutput.interpreted(module.name))

# ============================================================================
# Exports
# ============================================================================

export InterpreterCodegenAdapter
