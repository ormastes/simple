"""
Effect System - HIR Expression Scanner

Scans real HIR expression trees to detect suspension operators and async
function calls. Used by the effect pass to build FunctionEffectInfo from
actual HirFunction bodies.

This module bridges the gap between HIR expression types (from 20.hir)
and the lightweight FunctionEffectInfo used by the fixed-point solver.
It cannot import HIR types directly (circular dependency), so it provides
scanning utility functions that work on text-based function name lists
and boolean flags.

The actual HIR walking is done in effect_pass.spl (30.types layer).
"""

use compiler.common.effects.{EffectTag, EffectEnv}

# ============================================================================
# Scan Results
# ============================================================================

struct ScanResult:
    """Result of scanning a function body for effect-relevant operations."""
    contains_suspension: bool
    called_functions: [text]

impl ScanResult:
    static fn empty() -> ScanResult:
        ScanResult(contains_suspension: false, called_functions: [])

    fn merge(other: ScanResult) -> ScanResult:
        """Merge two scan results."""
        ScanResult(
            contains_suspension: self.contains_suspension or other.contains_suspension,
            called_functions: self.called_functions.concat(other.called_functions)
        )

# ============================================================================
# Exports
# ============================================================================

export ScanResult
