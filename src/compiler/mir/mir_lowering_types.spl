# MIR Lowering - Type Definitions
#
# Core struct definitions for MIR lowering.
# This file exists to break circular dependencies between
# mir_lowering.spl and its split modules (expr, stmts, ml).

use mir_data.*
use hir.*
use lexer.Span

# ============================================================================
# MIR Lowering Types
# ============================================================================

struct MirLowering:
    """Lowers HIR to MIR."""
    builder: MirBuilder
    symbols: SymbolTable
    local_map: Dict<SymbolId, LocalId>
    loop_stack: [(BlockId, BlockId)]  # (continue_block, break_block)
    errors: [MirError]
    field_map: Dict<i64, [text]>  # type symbol ID -> ordered field names

struct MirError:
    """MIR lowering error."""
    message: text
    span: Span?

# ============================================================================
# Exports
# ============================================================================

export MirLowering, MirError
