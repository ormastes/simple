# MirOptView - bridges MIR lowering output to optimizer input
# The optimizer reads MIR functions and instruction counts to
# decide which passes to run and at what intensity.

struct MirOptView:
    """MIR snapshot ready for optimization pass pipeline."""
    mir_fn_count: i64
    mir_inst_count: i64
    optimization_level: i64   # 0 = none, 1 = basic, 2 = full, 3 = aggressive

    fn has_functions() -> bool:
        self.mir_fn_count > 0

    fn is_optimized() -> bool:
        self.optimization_level > 0

    fn average_insts_per_fn() -> i64:
        var result = 0
        if self.mir_fn_count > 0:
            result = self.mir_inst_count / self.mir_fn_count
        result

    static fn empty(level: i64) -> MirOptView:
        MirOptView(
            mir_fn_count: 0,
            mir_inst_count: 0,
            optimization_level: level
        )

export MirOptView
