# Module Loading Stage Ports
#
# Port interfaces for module resolution, file reading, and registry.
# These ports make the module loader independently testable by
# swapping the file system adapter with an in-memory mock.
#
# Design: doc/report/compiler_mdsoc_impl_plan.md Phase 5

struct ModuleResolverPort:
    """Module path resolution (not file reading).

    Maps (module_name, context_dir) to absolute file path.
    Returns empty string when the module cannot be resolved.
    """
    name: text
    resolve_fn: fn(text, text) -> text

struct ModuleStoragePort:
    """File source reading (swappable in tests).

    Reads source text for a module at the given absolute path.
    Returns empty string when the file cannot be read.
    """
    name: text
    read_source_fn: fn(text) -> text

struct ModuleRegistryPort:
    """Loaded module tracking and export registry.

    Tracks which modules have been loaded and their exports.
    """
    name: text
    is_loaded_fn: fn(text) -> bool
    register_fn: fn(text, [text])
    get_exports_fn: fn(text) -> [text]

export ModuleResolverPort, ModuleStoragePort, ModuleRegistryPort
