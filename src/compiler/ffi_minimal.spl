//! Minimal FFI Declarations for Simple Runtime
//!
//! This module declares the essential FFI functions from build/rust/ffi_gen
//! These functions are implemented in Rust and linked via C ABI.
//!
//! NOTE: This module provides low-level FFI bindings. For normal Simple code,
//! use the standard library types (Int, String, List, etc.) which will
//! eventually use these FFI functions under the hood.

// ==============================================================================
// Value Type
// ==============================================================================

# Value type tags
enum ValueType:
    Nil = 0
    Bool = 1
    Int = 2
    Float = 3
    String = 4
    Array = 5
    Dict = 6
    Object = 7
    Function = 8

// ==============================================================================
// RuntimeValue - Opaque pointer type
// ==============================================================================

# Opaque pointer to RuntimeValue (managed by Rust FFI)
# In Simple, we represent C pointers as i64 for now
type RuntimeValuePtr = i64

// ==============================================================================
// Garbage Collector
// ==============================================================================

extern fn rt_gc_init()
extern fn rt_gc_malloc(size: i64) -> i64
extern fn rt_gc_collect()

// ==============================================================================
// Constructors
// ==============================================================================

extern fn rt_value_nil() -> RuntimeValuePtr
extern fn rt_value_bool(value: bool) -> RuntimeValuePtr
extern fn rt_value_int(value: i64) -> RuntimeValuePtr
extern fn rt_value_float(value: f64) -> RuntimeValuePtr
extern fn rt_value_string(ptr: i64, len: i64) -> RuntimeValuePtr
extern fn rt_value_array_new() -> RuntimeValuePtr
extern fn rt_value_dict_new() -> RuntimeValuePtr

// ==============================================================================
// Type Checking
// ==============================================================================

extern fn rt_value_type(value: RuntimeValuePtr) -> ValueType
extern fn rt_value_is_nil(value: RuntimeValuePtr) -> bool
extern fn rt_value_is_bool(value: RuntimeValuePtr) -> bool
extern fn rt_value_is_int(value: RuntimeValuePtr) -> bool
extern fn rt_value_is_float(value: RuntimeValuePtr) -> bool
extern fn rt_value_is_string(value: RuntimeValuePtr) -> bool
extern fn rt_value_is_array(value: RuntimeValuePtr) -> bool
extern fn rt_value_is_dict(value: RuntimeValuePtr) -> bool

// ==============================================================================
// Conversions
// ==============================================================================

extern fn rt_value_as_bool(value: RuntimeValuePtr) -> bool
extern fn rt_value_as_int(value: RuntimeValuePtr) -> i64
extern fn rt_value_as_float(value: RuntimeValuePtr) -> f64
extern fn rt_value_as_string(value: RuntimeValuePtr, out_len: i64) -> i64

// ==============================================================================
// Arithmetic Operations
// ==============================================================================

extern fn rt_value_add(left: RuntimeValuePtr, right: RuntimeValuePtr) -> RuntimeValuePtr
extern fn rt_value_sub(left: RuntimeValuePtr, right: RuntimeValuePtr) -> RuntimeValuePtr
extern fn rt_value_mul(left: RuntimeValuePtr, right: RuntimeValuePtr) -> RuntimeValuePtr
extern fn rt_value_div(left: RuntimeValuePtr, right: RuntimeValuePtr) -> RuntimeValuePtr

// ==============================================================================
// Comparison
// ==============================================================================

extern fn rt_value_eq(left: RuntimeValuePtr, right: RuntimeValuePtr) -> bool
extern fn rt_value_lt(left: RuntimeValuePtr, right: RuntimeValuePtr) -> bool

// ==============================================================================
// Printing
// ==============================================================================

extern fn rt_value_print(value: RuntimeValuePtr)
extern fn rt_value_println(value: RuntimeValuePtr)

// ==============================================================================
// Memory Management
// ==============================================================================

extern fn rt_value_free(value: RuntimeValuePtr)
extern fn rt_value_clone(value: RuntimeValuePtr) -> RuntimeValuePtr

// ==============================================================================
// File I/O
// ==============================================================================

extern fn rt_file_exists(path_ptr: i64, path_len: i64) -> bool
extern fn rt_file_read_text(path_ptr: i64, path_len: i64) -> i64
extern fn rt_file_write_text(path_ptr: i64, path_len: i64, content_ptr: i64, content_len: i64) -> bool
extern fn rt_file_delete(path_ptr: i64, path_len: i64) -> bool
extern fn rt_string_free(ptr: i64)

// ==============================================================================
// Environment Variables
// ==============================================================================

extern fn rt_env_get(name_ptr: i64, name_len: i64) -> i64
extern fn rt_env_set(name_ptr: i64, name_len: i64, value_ptr: i64, value_len: i64) -> bool
