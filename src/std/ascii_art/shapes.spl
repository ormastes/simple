# ASCII Art Shape Drawing Functions

use std.text.{NL}

# ============================================================================
# Basic Drawing Primitives
# ============================================================================

# Repeat a character n times
fn repeat_char(char: text, count: i64) -> text:
    if count <= 0:
        return ""
    var result = ""
    var i = 0
    while i < count:
        result = result + char
        i = i + 1
    result

# Create a horizontal line
fn horizontal_line(width: i64, char: text) -> text:
    repeat_char(char, width)

# Create a vertical line (returns list of lines)
fn vertical_line(height: i64, char: text) -> list:
    var lines = []
    var i = 0
    while i < height:
        lines = lines + [char]
        i = i + 1
    lines

# ============================================================================
# Shape Drawing Functions
# ============================================================================

# Draw a filled rectangle
fn draw_rectangle(w: i64, h: i64, fill: bool) -> text:
    if fill:
        var result = ""
        var i = 0
        while i < h:
            result = result + repeat_char("█", w)
            if i < h - 1:
                result = result + NL
            i = i + 1
        result
    else:
        # Import box_single from types module when available
        var style = ("+", "+", "+", "+", "-", "|", "+", "+", "+", "+", "+")
        draw_box(w, h, style)

# Draw a triangle (ASCII art)
fn draw_triangle(height: i64) -> text:
    var result = ""
    var i = 0
    while i < height:
        var spaces = repeat_char(" ", height - i - 1)
        var stars = repeat_char("*", (i * 2) + 1)
        result = result + spaces + stars
        if i < height - 1:
            result = result + NL
        i = i + 1
    result

# Draw a diamond shape
fn draw_diamond(size: i64) -> text:
    var result = ""
    var i = 0
    while i < size:
        var spaces = repeat_char(" ", size - i - 1)
        var stars = repeat_char("*", (i * 2) + 1)
        result = result + spaces + stars + NL
        i = i + 1
    i = size - 2
    while i >= 0:
        var spaces = repeat_char(" ", size - i - 1)
        var stars = repeat_char("*", (i * 2) + 1)
        result = result + spaces + stars
        if i > 0:
            result = result + NL
        i = i - 1
    result

# Helper for box drawing (imported from types concept)
fn draw_box(width: i64, height: i64, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    if width < 2:
        return ""
    if height < 2:
        return ""

    var tl = style.0
    var tr = style.1
    var bl = style.2
    var br = style.3
    var h = style.4
    var v = style.5

    var top_line = tl + repeat_char(h, width - 2) + tr
    var middle_line = v + repeat_char(" ", width - 2) + v
    var bottom_line = bl + repeat_char(h, width - 2) + br

    var result = top_line + NL
    var i = 0
    while i < height - 2:
        result = result + middle_line + NL
        i = i + 1
    result = result + bottom_line
    result

# ============================================================================
# Gradients and Patterns
# ============================================================================

# Create a horizontal gradient using shade characters
fn horizontal_gradient(width: i64) -> text:
    var result = ""
    var i = 0
    while i < width:
        var pos = (i * 3) / width
        if pos == 0:
            result = result + "░"
        else:
            if pos == 1:
                result = result + "▒"
            else:
                result = result + "▓"
        i = i + 1
    result

# Create a vertical gradient
fn vertical_gradient(height: i64) -> text:
    var result = ""
    var i = 0
    while i < height:
        var pos = (i * 3) / height
        var char = "░"
        if pos == 0:
            char = "░"
        else:
            if pos == 1:
                char = "▒"
            else:
                char = "▓"
        result = result + repeat_char(char, 20)
        if i < height - 1:
            result = result + NL
        i = i + 1
    result

# Create a checkerboard pattern
fn checkerboard_pattern(width: i64, height: i64) -> text:
    var result = ""
    var i = 0
    while i < height:
        var line = ""
        var j = 0
        while j < width:
            var sum = i + j
            if sum % 2 == 0:
                line = line + "█"
            else:
                line = line + " "
            j = j + 1
        result = result + line
        if i < height - 1:
            result = result + NL
        i = i + 1
    result

# Create a dotted pattern
fn dotted_pattern(width: i64, height: i64) -> text:
    var result = ""
    var i = 0
    while i < height:
        var line = ""
        var j = 0
        while j < width:
            if i % 2 == 0:
                if j % 2 == 0:
                    line = line + "·"
                else:
                    line = line + " "
            else:
                if j % 2 == 0:
                    line = line + " "
                else:
                    line = line + "·"
            j = j + 1
        result = result + line
        if i < height - 1:
            result = result + NL
        i = i + 1
    result
