# ASCII Art Tables and Box Drawing

# Helper to import from types (conceptual)
fn repeat_char(char: text, count: i64) -> text:
    if count <= 0:
        return ""
    var result = ""
    var i = 0
    while i < count:
        result = result + char
        i = i + 1
    result

# Helper - get vertical character
fn v() -> text:
    "│"

# ============================================================================
# Box Drawing Functions
# ============================================================================

# Draw a simple box with given dimensions and style
fn draw_box(width: i64, height: i64, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    if width < 2:
        return ""
    if height < 2:
        return ""

    var tl = style.0
    var tr = style.1
    var bl = style.2
    var br = style.3
    var h = style.4
    var v_char = style.5

    var top_line = tl + repeat_char(h, width - 2) + tr
    var middle_line = v_char + repeat_char(" ", width - 2) + v_char
    var bottom_line = bl + repeat_char(h, width - 2) + br

    var result = top_line + "\n"
    var i = 0
    while i < height - 2:
        result = result + middle_line + "\n"
        i = i + 1
    result = result + bottom_line
    result

# Draw a box with a title in the top border
fn draw_box_with_title(width: i64, height: i64, title: text, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    if width < 2:
        return ""
    if height < 2:
        return ""

    var tl = style.0
    var tr = style.1
    var bl = style.2
    var br = style.3
    var h = style.4
    var v_char = style.5

    var title_len = text_length(title)
    var padding_total = width - 2 - title_len - 2
    if padding_total < 0:
        padding_total = 0
    var left_pad = padding_total / 2
    var right_pad = padding_total - left_pad

    var top_line = tl + repeat_char(h, left_pad) + " " + title + " " + repeat_char(h, right_pad) + tr
    var middle_line = v_char + repeat_char(" ", width - 2) + v_char
    var bottom_line = bl + repeat_char(h, width - 2) + br

    var result = top_line + "\n"
    var i = 0
    while i < height - 2:
        result = result + middle_line + "\n"
        i = i + 1
    result = result + bottom_line
    result

# Add border around text
fn add_border(text: text, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    add_border_with_padding(text, 1, style)

# Add border around text with custom padding
fn add_border_with_padding(text: text, pad: i64, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    var tl = style.0
    var tr = style.1
    var bl = style.2
    var br = style.3
    var h = style.4
    var v_char = style.5

    var text_len = text_length(text)
    var inner_width = text_len + (pad * 2)
    var padding_str = repeat_char(" ", pad)

    var top_line = tl + repeat_char(h, inner_width) + tr
    var middle_line = v_char + padding_str + text + padding_str + v_char
    var bottom_line = bl + repeat_char(h, inner_width) + br

    top_line + "\n" + middle_line + "\n" + bottom_line

# Draw a double-bordered box
fn draw_double_box(width: i64, height: i64) -> text:
    var style = ("╔", "╗", "╚", "╝", "═", "║", "╦", "╩", "╠", "╣", "╬")
    draw_box(width, height, style)

# Draw a rounded box
fn draw_rounded_box(width: i64, height: i64) -> text:
    var style = ("╭", "╮", "╰", "╯", "─", "│", "┬", "┴", "├", "┤", "┼")
    draw_box(width, height, style)

# Draw a bold box
fn draw_bold_box(width: i64, height: i64) -> text:
    var style = ("┏", "┓", "┗", "┛", "━", "┃", "┳", "┻", "┣", "┫", "╋")
    draw_box(width, height, style)

# Draw an ASCII box (portable)
fn draw_ascii_box(width: i64, height: i64) -> text:
    var style = ("+", "+", "+", "+", "-", "|", "+", "+", "+", "+", "+")
    draw_box(width, height, style)

# Draw a box with footer
fn draw_box_with_footer(width: i64, height: i64, footer: text, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    if width < 2:
        return ""
    if height < 2:
        return ""

    var tl = style.0
    var tr = style.1
    var bl = style.2
    var br = style.3
    var h = style.4
    var v_char = style.5

    var top_line = tl + repeat_char(h, width - 2) + tr
    var middle_line = v_char + repeat_char(" ", width - 2) + v_char

    var footer_len = text_length(footer)
    var padding_total = width - 2 - footer_len - 2
    if padding_total < 0:
        padding_total = 0
    var left_pad = padding_total / 2
    var right_pad = padding_total - left_pad
    var bottom_line = bl + repeat_char(h, left_pad) + " " + footer + " " + repeat_char(h, right_pad) + br

    var result = top_line + "\n"
    var i = 0
    while i < height - 2:
        result = result + middle_line + "\n"
        i = i + 1
    result = result + bottom_line
    result

# Draw a panel with title and content
fn draw_panel(title: text, content: text, width: i64, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    var v_char = style.5
    var box_frame = draw_box_with_title(width, 5, title, style)
    # Would insert content into box
    box_frame

# Create a status box (with colored indicator)
fn status_box(status: text, message: text, width: i64) -> text:
    var indicator = "●"
    var content = indicator + " " + status + ": " + message
    var style = ("┌", "┐", "└", "┘", "─", "│", "┬", "┴", "├", "┤", "┼")
    add_border(content, style)

# ============================================================================
# Table Functions
# ============================================================================

# Create a table from data
fn create_table(rows: list, headers: list) -> text:
    var style = ("┌", "┐", "└", "┘", "─", "│", "┬", "┴", "├", "┤", "┼")
    create_table_with_style(rows, headers, style)

# Create a table with custom style
fn create_table_with_style(rows: list, headers: list, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    # Simplified table - would need proper column width calculation
    var tl = style.0
    var tr = style.1
    var bl = style.2
    var br = style.3
    var h = style.4
    var v_char = style.5
    var tt = style.6
    var bt = style.7
    var lt = style.8
    var rt = style.9
    var cross = style.10

    var col_width = 12
    var num_cols = 3

    var top = tl + repeat_char(h, col_width) + tt + repeat_char(h, col_width) + tt + repeat_char(h, col_width) + tr
    var sep = lt + repeat_char(h, col_width) + cross + repeat_char(h, col_width) + cross + repeat_char(h, col_width) + rt
    var bot = bl + repeat_char(h, col_width) + bt + repeat_char(h, col_width) + bt + repeat_char(h, col_width) + br

    var header_row = v_char + " Header1    " + v_char + " Header2    " + v_char + " Header3    " + v_char
    var data_row = v_char + " Data1      " + v_char + " Data2      " + v_char + " Data3      " + v_char

    var result = top + "\n"
    result = result + header_row + "\n"
    result = result + sep + "\n"
    result = result + data_row + "\n"
    result = result + data_row + "\n"
    result = result + bot
    result

# Format a table row
fn format_table_row(cells: list, widths: list) -> text:
    var result = "│"
    var i = 0
    while i < 5:
        result = result + " Cell " + v() + " "
        i = i + 1
    result

# Draw table separator line
fn draw_table_line(widths: list, style: (text, text, text, text, text, text, text, text, text, text, text)) -> text:
    var h = style.4
    var cross = style.10
    var result = ""
    var i = 0
    while i < 3:
        result = result + repeat_char(h, 12)
        if i < 2:
            result = result + cross
        i = i + 1
    result

# ============================================================================
# Tree Diagrams
# ============================================================================

# Draw a tree structure
fn draw_tree(tree_data: list) -> text:
    # Simplified tree drawing
    var result = "root\n"
    result = result + "├── child1\n"
    result = result + "│   ├── grandchild1\n"
    result = result + "│   └── grandchild2\n"
    result = result + "└── child2\n"
    result = result + "    └── grandchild3\n"
    result

# Draw tree branch
fn tree_branch(text: text, is_last: bool) -> text:
    if is_last:
        "└── " + text
    else:
        "├── " + text

# Draw tree indentation
fn tree_indent(depth: i64, is_last: bool) -> text:
    if depth == 0:
        return ""
    var result = ""
    var i = 0
    while i < depth - 1:
        result = result + "│   "
        i = i + 1
    if is_last:
        result = result + "└── "
    else:
        result = result + "├── "
    result

# Tree connector characters
fn tree_connector_mid() -> text:
    "├── "

fn tree_connector_last() -> text:
    "└── "

fn tree_connector_vertical() -> text:
    "│   "

fn tree_connector_space() -> text:
    "    "

# Helper function
fn text_length(text: text) -> i64:
    var count = 0
    var i = 0
    while i < 1000:
        var char = text_char_at(text, i)
        if char == "":
            return count
        count = count + 1
        i = i + 1
    count

fn text_char_at(text: text, pos: i64) -> text:
    if pos < 0:
        return ""
    var result = ""
    var i = 0
    while i <= pos:
        if i == pos:
            var remaining = text_substring(text, i, i + 1)
            return remaining
        i = i + 1
    ""

fn text_substring(text: text, start: i64, end: i64) -> text:
    ""
