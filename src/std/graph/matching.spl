# Matching Algorithms
#
# Purpose: Graph matching and bipartite graph algorithms
#
# Contains:
# - Bipartite graph checking
# - Graph properties related to matching

# Import types module
mod graph.types

# ============================================================================
# Graph Properties
# ============================================================================

# Check if graph is bipartite (2-colorable)
fn graph_is_bipartite(graph: tuple) -> bool:
    var num_vertices = graph.2
    var color = {}

    fn bfs_bipartite(start: i64) -> bool:
        var queue = [start]
        color = color.set(start, 0)

        while queue.len() > 0:
            var vertex = queue.get(0)
            queue = queue.slice(1, queue.len())
            var vertex_color = color.get(vertex)

            var neighbors = graph_neighbors(graph, vertex)
            var i = 0
            while i < neighbors.len():
                var neighbor = neighbors.get(i)
                var neighbor_id = neighbor.0
                var neighbor_color = color.get(neighbor_id)

                if neighbor_color == nil:
                    var new_color = 0
                    if vertex_color == 0:
                        new_color = 1
                    color = color.set(neighbor_id, new_color)
                    queue = queue.append(neighbor_id)
                else:
                    if neighbor_color == vertex_color:
                        return false

                i = i + 1

        true

    var j = 0
    while j < num_vertices:
        var has_color = color.get(j)
        if has_color == nil:
            if !bfs_bipartite(j):
                return false
        j = j + 1

    true

export *
