# Tree Creation and Construction
#
# Functions for building trees from arrays and other structures.

# ============================================================================
# Exports
# ============================================================================

export insert_level_order, array_to_tree, bst_from_sorted

# ============================================================================
# Tree Construction
# ============================================================================

fn insert_level_order(arr, index: i64):
    """Build binary tree from array using level-order insertion.

    Array representation: nil values indicate missing nodes.

    Example:
        insert_level_order([1, 2, 3, 4, 5], 0)
        # Tree:     1
        #          / \\
        #         2   3
        #        / \\
        #       4   5
    """
    if index >= arr.len():
        return nil

    if not arr[index].?:
        return nil

    val left_idx = 2 * index + 1
    val right_idx = 2 * index + 2

    val left_child = insert_level_order(arr, left_idx)
    val right_child = insert_level_order(arr, right_idx)

    create_node(arr[index], left_child, right_child)

fn array_to_tree(arr):
    """Convert array to binary tree (level-order).

    Example:
        array_to_tree([1, 2, 3, 4, 5])
    """
    insert_level_order(arr, 0)

fn bst_from_sorted(arr, start: i64, end: i64):
    """Build balanced BST from sorted array.

    Example:
        bst_from_sorted([1, 2, 3, 4, 5, 6, 7], 0, 6)
    """
    if start > end:
        return nil

    val mid = (start + end) / 2
    val left = bst_from_sorted(arr, start, mid - 1)
    val right = bst_from_sorted(arr, mid + 1, end)

    create_node(arr[mid], left, right)
