# Digital Signature Types Module
# Tuple-based data structures for signatures, keys, and metadata

# =============================================================================
# Signature Structure
# =============================================================================

# Signature: (r, s, algorithm)
# - r: i64 - first component (or entire signature for RSA)
# - s: i64 - second component (DSA, ECDSA) or 0 for RSA
# - algorithm: text - "RSA-PKCS1", "RSA-PSS", "DSA", etc.
fn create_signature(r: i64, s: i64, algorithm: text) -> tuple:
    (r, s, algorithm)

fn signature_r(sig: tuple) -> i64:
    sig[0]

fn signature_s(sig: tuple) -> i64:
    sig[1]

fn signature_algorithm(sig: tuple) -> text:
    sig[2]

# =============================================================================
# RSA Key Structures
# =============================================================================

# RSA Public Key: (n, e)
# - n: i64 - modulus
# - e: i64 - public exponent (typically 65537)
fn create_rsa_public_key(n: i64, e: i64) -> tuple:
    (n, e)

fn rsa_public_key_n(key: tuple) -> i64:
    key[0]

fn rsa_public_key_e(key: tuple) -> i64:
    key[1]

# RSA Private Key: (n, d)
# - n: i64 - modulus
# - d: i64 - private exponent
fn create_rsa_private_key(n: i64, d: i64) -> tuple:
    (n, d)

fn rsa_private_key_n(key: tuple) -> i64:
    key[0]

fn rsa_private_key_d(key: tuple) -> i64:
    key[1]

# =============================================================================
# DSA Structures
# =============================================================================

# DSA Parameters: (p, q, g, bits)
# - p: i64 - large prime modulus
# - q: i64 - prime divisor of p-1
# - g: i64 - generator
# - bits: i64 - bit size of p
fn create_dsa_params(p: i64, q: i64, g: i64, bits: i64) -> tuple:
    (p, q, g, bits)

fn dsa_params_p(params: tuple) -> i64:
    params[0]

fn dsa_params_q(params: tuple) -> i64:
    params[1]

fn dsa_params_g(params: tuple) -> i64:
    params[2]

fn dsa_params_bits(params: tuple) -> i64:
    params[3]

# DSA Public Key: (params, y)
# - params: tuple - DSA parameters
# - y: i64 - public key value (y = g^x mod p)
fn create_dsa_public_key(params: tuple, y: i64) -> tuple:
    (params, y)

fn dsa_public_key_params(key: tuple) -> tuple:
    key[0]

fn dsa_public_key_y(key: tuple) -> i64:
    key[1]

# DSA Private Key: (params, x)
# - params: tuple - DSA parameters
# - x: i64 - private key value
fn create_dsa_private_key(params: tuple, x: i64) -> tuple:
    (params, x)

fn dsa_private_key_params(key: tuple) -> tuple:
    key[0]

fn dsa_private_key_x(key: tuple) -> i64:
    key[1]

# =============================================================================
# Metadata Structure
# =============================================================================

# Signature Metadata: (algorithm, timestamp, signer)
fn create_signature_metadata(algorithm: text, timestamp: i64, signer: text) -> tuple:
    (algorithm, timestamp, signer)

fn signature_metadata_algorithm(meta: tuple) -> text:
    meta[0]

fn signature_metadata_timestamp(meta: tuple) -> i64:
    meta[1]

fn signature_metadata_signer(meta: tuple) -> text:
    meta[2]
