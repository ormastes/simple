# Set Utilities Module
#
# Set operations on arrays of integers (i64).
# Sets are represented as arrays with no duplicate elements.
#
# Categories:
# - Basic operations: set_contains, set_add, set_remove
# - Set algebra: set_union, set_intersection, set_difference
# - Predicates: is_subset, is_superset, sets_equal
#
# All operations preserve immutability (return new arrays).

# ============================================================================
# Exports
# ============================================================================

export set_contains, set_add, set_remove
export set_union, set_intersection, set_difference
export is_subset, is_superset, sets_equal

# ============================================================================
# Basic Set Operations
# ============================================================================

fn set_contains(set: [i64], x: i64) -> bool:
    """Check if element is in the set.

    Example:
        set_contains([1, 2, 3], 2)  # true
        set_contains([1, 2, 3], 5)  # false
    """
    for item in set:
        if item == x:
            return true
    false

fn set_add(set: [i64], x: i64) -> [i64]:
    """Add element to set if not already present.
    Returns original set if element exists.

    Example:
        set_add([1, 2], 3)  # [1, 2, 3]
        set_add([1, 2], 2)  # [1, 2]
    """
    if set_contains(set, x):
        return set
    set + [x]

fn set_remove(set: [i64], x: i64) -> [i64]:
    """Remove element from set.
    Returns new set without the element.

    Example:
        set_remove([1, 2, 3], 2)  # [1, 3]
    """
    var result: [i64] = []
    for item in set:
        if item != x:
            result = result + [item]
    result

# ============================================================================
# Set Algebra Operations
# ============================================================================

fn set_union(a: [i64], b: [i64]) -> [i64]:
    """Union of two sets - all elements from both sets.

    Example:
        set_union(a=[1, 2], b=[2, 3])  # [1, 2, 3]
    """
    var result = a
    for x in b:
        result = set_add(result, x)
    result

fn set_intersection(a: [i64], b: [i64]) -> [i64]:
    """Intersection of two sets - elements present in both.

    Example:
        set_intersection(a=[1, 2, 3], b=[2, 3, 4])  # [2, 3]
    """
    var result: [i64] = []
    for x in a:
        if set_contains(b, x):
            result = set_add(result, x)
    result

fn set_difference(a: [i64], b: [i64]) -> [i64]:
    """Difference of two sets - elements in A but not in B.

    Example:
        set_difference(a=[1, 2, 3], b=[2, 3, 4])  # [1]
    """
    var result: [i64] = []
    for x in a:
        if not set_contains(b, x):
            result = set_add(result, x)
    result

# ============================================================================
# Set Predicates
# ============================================================================

fn is_subset(a: [i64], b: [i64]) -> bool:
    """Check if A is a subset of B (all elements of A are in B).

    Example:
        is_subset(a=[1, 2], b=[1, 2, 3])  # true
        is_subset(a=[1, 4], b=[1, 2, 3])  # false
    """
    for x in a:
        if not set_contains(b, x):
            return false
    true

fn is_superset(a: [i64], b: [i64]) -> bool:
    """Check if A is a superset of B (all elements of B are in A).

    Example:
        is_superset(a=[1, 2, 3], b=[1, 2])  # true
    """
    is_subset(b, a)

fn sets_equal(a: [i64], b: [i64]) -> bool:
    """Check if two sets are equal (same elements, regardless of order).

    Example:
        sets_equal(a=[1, 2, 3], b=[3, 2, 1])  # true
        sets_equal(a=[1, 2], b=[1, 2, 3])     # false
    """
    is_subset(a, b) and is_subset(b, a)
