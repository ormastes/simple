# Actor Module
#
# Pure Simple wrappers around Rust runtime actor SFFI.
#
# Usage:
#   val actor = actor_spawn(\msg: msg * 2)
#   actor.send(21)
#   val result = actor.recv()  # 42

# --- SFFI declarations ---
extern fn rt_actor_spawn(handler: Any) -> i64
extern fn rt_actor_send(actor_id: i64, message: Any)
extern fn rt_actor_recv(actor_id: i64) -> Any

# --- ActorRef ---

class ActorRef:
    _id: i64

    fn send(message: Any):
        rt_actor_send(self._id, message)

    fn recv() -> Any:
        rt_actor_recv(self._id)

    fn id() -> i64:
        self._id

# --- API ---

fn actor_spawn(handler: Any) -> ActorRef:
    val id = rt_actor_spawn(handler)
    ActorRef(_id: id)
