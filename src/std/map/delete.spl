# Map Delete Operations

fn map_remove(map, key: text):
    """Remove key from map. Returns new map without the key.

    Example:
        val m = map_put(map_create(), "x", 10)
        val m2 = map_remove(m, "x")
        map_get(m2, "x")  # nil
    """
    var result = []
    var i = 0
    while i < map.len():
        val entry = map[i]
        if entry[0] != key:
            result.push(entry)
        i = i + 1
    result

fn map_clear(map):
    """Remove all entries from map. Returns empty map.

    Example:
        val m = map_put(map_create(), "x", 10)
        val m2 = map_clear(m)
        map_size(m2)  # 0
    """
    []

fn map_pick(map, keys):
    """Create new map with only specified keys.

    Example:
        val m = map_put(map_put(map_create(), "x", 1), "y", 2)
        val m2 = map_pick(m, ["x"])
        map_size(m2)  # 1
    """
    var result = map_create()
    var i = 0
    while i < keys.len():
        val key = keys[i]
        val value = map_get(map, key)
        if value != nil:
            result = map_put(result, key, value)
        i = i + 1
    result

fn map_omit(map, keys):
    """Create new map without specified keys.

    Example:
        val m = map_put(map_put(map_create(), "x", 1), "y", 2)
        val m2 = map_omit(m, ["y"])
        map_size(m2)  # 1
    """
    var result = map_create()
    var i = 0
    while i < map.len():
        val entry = map[i]
        val key = entry[0]

        var should_include = true
        var j = 0
        while j < keys.len():
            if keys[j] == key:
                should_include = false
            j = j + 1

        if should_include:
            result.push(entry)
        i = i + 1
    result
