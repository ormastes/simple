# Huffman Encoding Module
# Encoding operations

import huffman.types
import huffman.tree
import huffman.codes

# ============================================================================
# ENCODING
# ============================================================================

fn huffman_encode_symbol(symbol, code_table):
    """Encode a single symbol using code table"""
    huffman_get_code(code_table, symbol)

fn huffman_encode_data(data, code_table):
    """Encode data string using Huffman code table"""
    var result = ""
    var i = 0
    val data_len = string_length(data)

    while i < data_len:
        val byte_val = string_byte_at(data, i)
        val code = huffman_encode_symbol(byte_val, code_table)
        result = string_concat(result, code)
        i = i + 1

    result

fn huffman_encode(data):
    """Full encoding pipeline: build tree, generate codes, encode data"""
    val tree = huffman_build_tree_from_data(data)
    if tree == nil:
        nil
    else:
        val code_table = huffman_build_code_table(tree)
        val encoded = huffman_encode_data(data, code_table)
        (tree, encoded)
