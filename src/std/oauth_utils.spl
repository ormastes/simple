# OAuth 2.0 Utilities Module - Facade
# Comprehensive OAuth 2.0 implementation
#
# This is a facade that re-exports all OAuth functionality
# from the refactored oauth/ subdirectory modules

import oauth.types
import oauth.authorize
import oauth.token
import oauth.refresh
import oauth.validate
import oauth.utilities

# ============================================================================
# RE-EXPORTS
# ============================================================================

# Types
export create_oauth_config, get_config_client_id, get_config_client_secret
export get_config_redirect_uri, get_config_auth_url, get_config_token_url, validate_oauth_config
export create_access_token, get_access_token, get_token_type, get_expires_in
export get_refresh_token, get_token_scope, get_token_issued_at, create_token_now

# Authorization
export generate_state, verify_state, generate_state_with_timestamp, verify_state_with_expiry
export generate_code_verifier, generate_code_challenge, verify_code_challenge, get_pkce_method
export build_auth_url, build_auth_url_with_pkce, build_auth_url_with_params
export parse_auth_response, get_auth_code, get_response_state, get_response_error
export get_response_error_description, has_auth_error

# Token
export exchange_code_for_token, exchange_code_with_pkce, build_token_request_body
export get_client_credentials_token, build_client_credentials_request
export create_auth_header, create_auth_headers, create_token_request_headers, create_full_request_headers
export parse_token_response, extract_json_value

# Refresh
export refresh_access_token, build_refresh_token_request, refresh_token_with_scopes

# Validation
export parse_scopes, build_scope_string, has_scope, has_all_scopes, has_any_scope
export validate_scope, validate_scopes
export is_token_expired, get_token_expiry, get_time_until_expiry, validate_access_token
export token_needs_refresh, get_token_age
export validate_redirect_uri, is_secure_url, validate_client_id, validate_auth_code
export build_introspection_request, parse_introspection_response, is_token_active
export build_revocation_request, revoke_access_token, revoke_refresh_token

# Utilities
export url_encode, is_unreserved_char, parse_query_params, get_param_value
export url_decode, build_url_with_params
export get_current_timestamp, random_int, generate_random_string, is_alphanumeric
export array_contains, i64_to_text, text_to_i64, digit_to_char, char_to_digit
export hash_sha256, i64_to_hex, base64url_encode, percent_encode_char
export extract_until_delimiter, create_mock_access_token
export generate_client_id, generate_client_secret, hash_client_secret, verify_client_secret
export get_invalid_request_error, get_invalid_client_error, get_invalid_grant_error
export get_unauthorized_client_error, get_unsupported_grant_type_error
export get_invalid_scope_error, get_access_denied_error
export create_error_response, get_error_code, get_error_description
