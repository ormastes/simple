# DNS Name Resolution and Validation Functions

fn dns_validate_domain(domain: text) -> i64:
    # Validate domain name format
    # Returns 1 if valid, 0 if invalid
    var is_valid = 1
    if domain.size() == 0:
        is_valid = 0
    if domain.size() > 253:
        is_valid = 0
    val labels = dns_split_labels(domain)
    var i = 0
    while i < labels.size():
        val label = labels.get(i)
        val label_valid = dns_validate_label(label)
        if label_valid == 0:
            is_valid = 0
        i = i + 1
    is_valid

fn dns_validate_label(label: text) -> i64:
    # Validate DNS label format
    # Returns 1 if valid, 0 if invalid
    var is_valid = 1
    if label.size() == 0:
        is_valid = 0
    if label.size() > 63:
        is_valid = 0
    val starts_with_hyphen = label.starts_with("-")
    if starts_with_hyphen:
        is_valid = 0
    val ends_with_hyphen = label.ends_with("-")
    if ends_with_hyphen:
        is_valid = 0
    is_valid

fn dns_is_fqdn(domain: text) -> i64:
    # Check if domain is fully qualified (ends with dot)
    val ends_with_dot = domain.ends_with(".")
    val result = 0
    if ends_with_dot:
        result = 1
    result

fn dns_normalize_domain(domain: text) -> text:
    # Normalize domain name (lowercase, remove trailing dot)
    var normalized = domain.to_lower()
    val ends_with_dot = normalized.ends_with(".")
    if ends_with_dot:
        normalized = normalized.substring(0, normalized.size() - 1)
    normalized

fn dns_split_labels(name: text):
    # Split domain name into labels
    # "example.com" -> ["example", "com"]
    name.split(".")

fn dns_join_labels(labels):
    # Join labels into domain name
    # ["example", "com"] -> "example.com"
    labels.join(".")

fn dns_reverse_ip_addr(ip: text) -> text:
    # Reverse IP address for PTR query
    # "192.0.2.1" -> "1.2.0.192.in-addr.arpa"
    val octets = ip.split(".")
    var reversed = []
    var i = octets.size() - 1
    while i >= 0:
        reversed = reversed.append(octets.get(i))
        i = i - 1
    val joined = reversed.join(".")
    joined + ".in-addr.arpa"
