# Secure Random Types and Constants
#
# Type definitions and constants for cryptographically secure random number generation

# ChaCha20 constants: "expand 32-byte k" in little-endian
val CHACHA_CONST_0 = 0x61707865  # "expa"
val CHACHA_CONST_1 = 0x3320646e  # "nd 3"
val CHACHA_CONST_2 = 0x79622d32  # "2-by"
val CHACHA_CONST_3 = 0x6b206574  # "te k"

# Reseed threshold: reseed after this many bytes generated
val RESEED_THRESHOLD = 1048576  # 1 MB

# Number of entropy pools for Fortuna-style design
val NUM_ENTROPY_POOLS = 32

# ChaCha20 rounds (20 rounds = 10 double-rounds)
val CHACHA_ROUNDS = 20

# Global CSPRNG state - initialized on first use
# Structure: (key: list[8], counter: i64, pool: list, reseed_count: i64,
#             bytes_generated: i64, initialized: bool)
var global_csprng_state = nil

# Entropy pools for Fortuna-style entropy accumulation
# Structure: list of 32 pools, each pool is a list of integers
var entropy_pools = nil

# Pool reseed counters - tracks which pools have been used
var pool_reseed_counter = 0

export CHACHA_CONST_0
export CHACHA_CONST_1
export CHACHA_CONST_2
export CHACHA_CONST_3
export RESEED_THRESHOLD
export NUM_ENTROPY_POOLS
export CHACHA_ROUNDS
export global_csprng_state
export entropy_pools
export pool_reseed_counter
