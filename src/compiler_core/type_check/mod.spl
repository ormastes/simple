# Type Checker
#
# Type checker for Simple language with bidirectional type checking.
#
# This module implements:
# - Promise auto-wrapping for async functions
# - Function signature validation
# - Return type checking
#
# Architecture:
# The type checker operates in multiple passes:
# 1. Collect function signatures (already done in HIR lowering)
# 2. Check function bodies match signatures
# 3. Apply Promise auto-wrapping for async functions
#
# Promise Auto-Wrapping:
# Functions with suspension operators (`~=`, `if~`, etc.) are async.
# If such a function declares return type `T`, the type checker
# automatically wraps it to `Promise<T>`.
#
# Example:
# ```simple
# fn fetch_user(id: i64) -> User:  # Declared as User
#     val resp ~= http.get(url)
#     return parse(resp)
# # Auto-wrapped to: -> Promise<User>
# ```
#
# Port of rust/compiler/src/type_check/mod.rs (208 lines)

export TypeChecker

use hir (HirFunction, HirModule, HirType, TypeId, TypeRegistry)
use hir (LowerError, LowerResult)

# ============================================================================
# Type Checker
# ============================================================================

struct TypeChecker:
    """Type checker context.

    Tracks function return types for checking calls.
    """
    function_types: {text: TypeId}


# ============================================================================
# TypeChecker Methods (was: impl TypeChecker:)
# ============================================================================

fn typechecker_new() -> TypeChecker:
        """Create a new type checker."""
        TypeChecker(function_types: {})

