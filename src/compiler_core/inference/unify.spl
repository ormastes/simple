# Unification Algorithm
#
# Robinson's unification with occurs check.
# Shared by compiler, loader, and linker.

use compiler.inference.types.*

# ============================================================================
# Unifier
# ============================================================================

class Unifier:
    """Type unifier with substitution tracking.

    Maintains a mapping from type variables to their resolved types.
    Supports occurs check to prevent infinite types.
    """
    substitutions: Dict<i64, Type>
    next_var: i64


# ============================================================================
# Unifier Methods (was: impl Unifier:)
# ============================================================================

fn unifier_empty() -> Unifier:
        Unifier(substitutions: {}, next_var: 0)


fn unifier_fresh_var(self: Unifier) -> Type:
        """Create a fresh type variable."""
        val id = TypeVarId(id: self.next_var)
        self.next_var = self.next_var + 1
        type_Var(id: id)


export Unifier
