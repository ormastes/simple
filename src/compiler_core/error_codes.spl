# Compiler Error Codes
#
# Format: E1xxx for semantic, E2xxx for codegen, E3xxx for runtime
#
# This module provides standardized error codes for compiler diagnostics.
# Each error code corresponds to a specific type of compilation error.

# --- Semantic Errors (E10xx) ---

val UNDEFINED_VARIABLE = "E1001"
val UNDEFINED_FUNCTION = "E1002"
val TYPE_MISMATCH = "E1003"
val INVALID_ASSIGNMENT = "E1004"
val INVALID_OPERATION = "E1005"
val INVALID_PATTERN = "E1006"
val MISSING_FIELD = "E1007"
val DUPLICATE_DEFINITION = "E1008"
val CIRCULAR_DEPENDENCY = "E1009"
val MODULE_NOT_FOUND = "E1010"
val UNDEFINED_TYPE = "E1011"
val UNDEFINED_FIELD = "E1012"
val UNKNOWN_METHOD = "E1013"
val UNKNOWN_CLASS = "E1014"
val UNKNOWN_ENUM = "E1015"
val LET_BINDING_FAILED = "E1016"
val IMPURE_FUNCTION_IN_CONTRACT = "E1017"
val EFFECT_DECLARATION_FAILED = "E1018"
val DUPLICATE_BINDING = "E1019"
val ARGUMENT_COUNT_MISMATCH = "E1020"
val MISSING_STRUCT_FIELDS = "E1021"
val INVALID_LHS_ASSIGNMENT = "E1022"
val INVALID_STRUCT_LITERAL = "E1023"
val CONST_EVAL_FAILED = "E1024"
val DUPLICATE_METHOD = "E1025"
val UNKNOWN_ASSOC_TYPE = "E1026"
val UNCONSTRAINED_TYPE_PARAM = "E1027"
val UNKNOWN_ASSOC_TYPE_NAME = "E1028"
val CONFLICTING_TRAIT_BOUNDS = "E1029"
val INVALID_LIFETIME_ON_TRAIT = "E1030"
val MISSING_TRAIT_METHOD = "E1031"
val SELF_IN_STATIC = "E1032"
val INVALID_SELF_IMPORT = "E1033"
val UNRESOLVED_IMPORT = "E1034"
val INVALID_SELF_CONTEXT = "E1035"
val CLOSURE_CAPTURE_FAILED = "E1036"
val INVALID_SELF_PARAM = "E1037"
val PRIVATE_IN_PUBLIC = "E1038"
val INVALID_VISIBILITY = "E1039"
val PRIVATE_FIELD_ACCESS = "E1040"
val INVALID_UNARY_OP = "E1041"
val INVALID_SELF_TYPE = "E1042"
val INVALID_INDEX_TYPE = "E1043"
val TUPLE_INDEX_OOB = "E1044"
val INVALID_FIELD_ASSIGN = "E1045"
val PRIVATE_FIELD = "E1046"
val CANNOT_BORROW_MUT_FIELD = "E1047"
val NOT_CALLABLE = "E1048"
val CANNOT_CALL_NON_FUNCTION = "E1049"
val DISALLOWED_COERCION = "E1050"
val CLOSURE_SIGNATURE_MISMATCH = "E1051"
val INVALID_LET_ELSE_PATTERN = "E1052"
val CANNOT_BORROW_IMMUTABLE = "E1053"
val INVALID_DEREFERENCE = "E1054"
val TYPE_ALIAS_BOUNDS = "E1055"
val INVALID_RANGE = "E1056"
val YIELD_OUTSIDE_GENERATOR = "E1057"
val INVALID_DOC_COMMENT = "E1058"
val INVALID_IMPLICIT_DEREFERENCE = "E1059"
val INVALID_CONST_EXPRESSION = "E1060"
val EMPTY_ENUM = "E1061"
val RECURSION_LIMIT_EXCEEDED = "E1062"
val TYPE_SIZE_LIMIT_EXCEEDED = "E1063"
val WRONG_INTRINSIC_TYPE = "E1064"
val INVALID_RETURN_TYPE = "E1065"
val INVALID_MAIN_SIGNATURE = "E1066"
val INVALID_BUILTIN_ATTRIBUTE = "E1067"
val INCONSISTENT_BINDINGS = "E1068"
val MISMATCHED_BINDING = "E1069"
val INVALID_DEFAULT_VARIANT = "E1070"
val INVALID_ATTRIBUTE_POSITION = "E1071"
val INVALID_DESTRUCTURING = "E1072"
val NON_EXHAUSTIVE_TYPE = "E1073"
val CONFLICTING_REPRESENTATION = "E1074"
val DISCRIMINANT_OVERFLOW = "E1075"
val UNKNOWN_INTRINSIC = "E1076"
val WRONG_INTRINSIC_SIGNATURE = "E1077"
val INVALID_INTRINSIC_RETURN = "E1078"
val MISSING_GENERIC_ARGUMENTS = "E1079"
val TYPE_TOO_COMPLEX = "E1080"
val INVALID_CONTEXT = "E1081"

# --- Control Flow Errors (E11xx) ---

val BREAK_OUTSIDE_LOOP = "E1101"
val CONTINUE_OUTSIDE_LOOP = "E1102"
val RETURN_OUTSIDE_FUNCTION = "E1103"
val RETURN_IN_CLOSURE = "E1104"
val INVALID_CONTROL_FLOW = "E1105"

# --- Actor/Concurrency Errors (E12xx) ---

val ACTOR_SEND_FAILED = "E1201"
val ACTOR_RECV_FAILED = "E1202"
val CHANNEL_CLOSED = "E1203"
val DEADLOCK_DETECTED = "E1204"
val ACTOR_JOIN_FAILED = "E1205"

# --- Capability Errors (E13xx) ---

val CAPABILITY_VIOLATION = "E1301"
val ISOLATION_VIOLATION = "E1302"
val BORROW_VIOLATION = "E1303"
val USE_AFTER_FREE = "E1304"

# --- Macro Errors (E14xx) ---

val MACRO_UNDEFINED = "E1401"
val MACRO_USED_BEFORE_DEFINITION = "E1402"
val KEYWORD_IN_MACRO = "E1403"
val MACRO_SHADOWING = "E1403"  # Alias for backward compatibility
val MACRO_INVALID_BLOCK_POSITION = "E1404"
val MACRO_MISSING_TYPE_ANNOTATION = "E1405"
val MACRO_INVALID_QIDENT = "E1406"

# --- AOP Errors (E15xx) ---

val INVALID_POINTCUT_SYNTAX = "E1501"
val UNDEFINED_JOINPOINT = "E1502"
val INVALID_ADVICE_TYPE = "E1503"
val CONFLICTING_ADVICE_ORDER = "E1504"
val INVALID_WEAVING_TARGET = "E1505"
val ASPECT_CIRCULAR_DEPENDENCY = "E1506"
val INVALID_POINTCUT_SELECTOR = "E1507"
val ASPECT_NOT_ENABLED = "E1508"

# --- Custom Block Errors (E16xx) ---

val UNKNOWN_BLOCK_TYPE = "E1601"
val INVALID_BLOCK_SYNTAX = "E1602"
val MATH_BLOCK_INVALID_EXPR = "E1603"
val MATH_BLOCK_UNDEFINED_VAR = "E1604"
val SHELL_BLOCK_INVALID_CMD = "E1605"
val SHELL_BLOCK_UNSAFE_OP = "E1606"
val SQL_BLOCK_SYNTAX_ERROR = "E1607"
val SQL_BLOCK_INVALID_PARAM = "E1608"
val REGEX_BLOCK_INVALID = "E1609"
val REGEX_BLOCK_UNKNOWN_FLAG = "E1610"
val BLOCK_MISSING_CLOSING = "E1611"
val BLOCK_TYPE_MISMATCH = "E1612"

# --- Mixin Errors (E17xx) ---

val MIXIN_NOT_FOUND = "E1701"
val MIXIN_METHOD_CONFLICT = "E1702"
val MIXIN_MISSING_REQUIRED = "E1703"
val MIXIN_CIRCULAR_DEPENDENCY = "E1704"
val MIXIN_INVALID_USE = "E1705"
val MIXIN_FIELD_CONFLICT = "E1706"
val MIXIN_SELF_REFERENCE = "E1707"
val MIXIN_TYPE_MISMATCH = "E1708"

# --- SDN Errors (E18xx) ---

val SDN_SYNTAX_ERROR = "E1801"
val SDN_UNKNOWN_KEY = "E1802"
val SDN_TYPE_MISMATCH = "E1803"
val SDN_MISSING_REQUIRED = "E1804"
val SDN_DUPLICATE_KEY = "E1805"
val SDN_INVALID_VALUE = "E1806"
val SDN_NESTING_LIMIT = "E1807"
val SDN_CIRCULAR_REFERENCE = "E1808"

# --- DI Errors (E19xx) ---

val DI_MISSING_BINDING = "E1901"
val DI_AMBIGUOUS_BINDING = "E1902"
val DI_CIRCULAR_DEPENDENCY = "E1903"
val DI_INVALID_SCOPE = "E1904"
val DI_INJECT_FAILED = "E1905"
val DI_INVALID_ATTRIBUTE = "E1906"
val DI_SCOPE_MISMATCH = "E1907"
val DI_MOCK_NOT_TEST = "E1908"

# --- Architecture Rule Errors (E1Axx) ---

val ARCH_FORBIDDEN_IMPORT = "E1A01"
val ARCH_FORBIDDEN_DEPEND = "E1A02"
val ARCH_LAYER_VIOLATION = "E1A03"
val ARCH_INVALID_RULE = "E1A04"
val ARCH_CONFLICTING_RULES = "E1A05"
val ARCH_CIRCULAR_MODULES = "E1A06"

# --- Codegen Errors (E20xx) ---

val UNSUPPORTED_FEATURE = "E2001"
val FFI_ERROR = "E2002"
val FAILED_BUILD_LOAD = "E2003"
val FAILED_BUILD_STORE = "E2004"
val FAILED_BUILD_ALLOCA = "E2005"
val FAILED_BUILD_CALL = "E2006"
val FAILED_TO_CAST = "E2007"
val FAILED_BUILD_GEP = "E2008"
val UNSUPPORTED_RETURN_TYPE = "E2009"

# --- Runtime Errors (E30xx) ---

val DIVISION_BY_ZERO = "E3001"
val INDEX_OUT_OF_BOUNDS = "E3002"
val STACK_OVERFLOW = "E3003"
val ASSERTION_FAILED = "E3004"
val TIMEOUT = "E3005"
val AWAIT_FAILED = "E3006"
val PROMISE_REJECTED = "E3007"
val FUNCTION_NOT_FOUND = "E3008"
val UNHANDLED_EXCEPTION = "E3009"
val NULL_POINTER = "E3010"
val MEMORY_ERROR = "E3011"
val TYPE_ERROR = "E3012"
val CONTRACT_VIOLATION = "E3013"
val INVARIANT_VIOLATION = "E3014"
val POSTCONDITION_VIOLATION = "E3015"
val PRECONDITION_VIOLATION = "E3016"

# Helper function to get error category
fn get_category(code: text) -> text:
    val prefix = code_substring(code, 0, 2)
    match prefix:
        case "E1": "Semantic"
        case "E2": "Codegen"
        case "E3": "Runtime"
        case _: "Unknown"

# Helper function to check if error is semantic
fn is_semantic(code: text) -> bool:
    code.starts_with("E1")

# Helper function to check if error is codegen
fn is_codegen(code: text) -> bool:
    code.starts_with("E2")

# Helper function to check if error is runtime
fn is_runtime(code: text) -> bool:
    code.starts_with("E3")
