# Interpreter Type Mapper - Interpreter-Specific Type Mapping Implementation
#
# Maps MIR types to Interpreter runtime value type strings.
# Implements TypeMapper trait for Interpreter backend.

use compiler.mir_data.*
use compiler.backend.common.type_mapper.*

# ============================================================================
# Interpreter Type Mapper
# ============================================================================

class InterpreterTypeMapper:
    """
    Maps MIR types to Interpreter runtime value representations.

    The interpreter uses tagged RuntimeValue variants:
    - Int(i64)
    - Float(f64)
    - Bool(bool)
    - String(text)
    - Array([RuntimeValue])
    - Tuple([RuntimeValue])
    - Dict(Dict<RuntimeValue, RuntimeValue>)
    - Nil

    Type mapping is mostly for validation and error messages,
    since the interpreter is dynamically typed at runtime.

    Example mappings:
        I64 → "Int"
        F64 → "Float"
        Bool → "Bool"
        Ptr(_) → "Ptr"
        [I64] → "Array<Int>"
    """

    static fn create() -> InterpreterTypeMapper:
        """Create interpreter type mapper."""
        InterpreterTypeMapper()

# REMOVED: impl TypeMapper for InterpreterTypeMapper:
# (Trait implementations not supported in Core Simple)
    # fn map_primitive(ty: PrimitiveType) -> text:
        # """
        # Map primitive types to Interpreter runtime types.

        # All integers map to Int(i64).
        # All floats map to Float(f64).
        # """
        # match ty:
            # case I64, I32, I16, I8:
                # "Int"  # All integers are i64 at runtime
            # case F64, F32:
                # "Float"  # All floats are f64 at runtime
            # case Bool:
                # "Bool"
            # case Unit:
                # "Nil"  # Unit is nil at runtime

    # fn map_pointer(pointee: text, mutability: Mutability) -> text:
        # """
        # Map pointer types to Interpreter representation.

        # Pointers are opaque references in the interpreter.
        # They're rarely used since interpreter works with values.

        # Returns: "Ptr<pointee>"
        # """
        # "Ptr<{pointee}>"

    # fn backend_name() -> text:
        # "Interpreter"


# ============================================================================
# InterpreterTypeMapper Methods (was: impl InterpreterTypeMapper:)
# ============================================================================

# ============================================================================
# Export
# ============================================================================

# Export desugared static method names
fn InterpreterTypeMapper__create() -> InterpreterTypeMapper:
    interpretertypemapper_create()

export InterpreterTypeMapper
export InterpreterTypeMapper__create
