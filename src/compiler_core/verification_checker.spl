# Verification Constraint Checker
#
# Enforces verified subset rules for Lean verification mode.
# Rules: V-UNSAFE, V-EFFECT, V-REFLECT, V-GHOST, V-TRUSTED, V-PARTIAL
#
# Port of rust/compiler/src/verification_checker.rs (320 lines)

export VerificationRule, VerificationViolation, VerificationChecker

# ============================================================================
# Types
# ============================================================================

enum VerificationRule:
    VUnsafe     # No @unsafe in @verify code
    VEffect     # No impure effects in verified code
    VReflect    # No reflection in verified code
    VGhost      # Ghost code can only access ghost state
    VTrusted    # Trusted functions must have contracts
    VPartial    # Recursive functions need termination proof


# ============================================================================
# VerificationRule Methods (was: impl VerificationRule:)
# ============================================================================

struct VerificationViolation:
    rule: VerificationRule
    location: text
    message: text


# ============================================================================
# VerificationViolation Methods (was: impl VerificationViolation:)
# ============================================================================

# ============================================================================
# Checker
# ============================================================================

struct FunctionInfo:
    """Minimal function info for verification checking."""
    name: text
    effects: [text]
    is_verified: bool
    is_trusted: bool
    has_contract: bool
    has_ghost_params: bool
    has_ghost_locals: bool
    is_recursive: bool
    has_termination_proof: bool
    uses_reflection: bool

class VerificationChecker:
    """Checks modules for verification constraint violations."""
    violations: [VerificationViolation]
    strict: bool


# ============================================================================
# VerificationChecker Methods (was: impl VerificationChecker:)
# ============================================================================

fn verificationchecker_create(strict: bool) -> VerificationChecker:
        VerificationChecker(violations: [], strict: strict)

