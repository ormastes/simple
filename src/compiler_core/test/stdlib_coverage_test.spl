# Stdlib Branch Coverage Tests
#
# Tests core stdlib functions to improve branch coverage
# without depending on compiler modules.

use std.spec.*

describe "String operations branch coverage":
    it "tests empty string":
        val s = ""
        expect s_len(s) == 0
        expect s_is_empty(s) == true

    it "tests non-empty string":
        val s = "hello"
        expect s_len(s) == 5
        expect s_is_empty(s) == false

    it "tests string contains":
        val s = "hello world"
        expect s.contains("world") == true
        expect s.contains("xyz") == false

describe "List operations branch coverage":
    it "tests empty list":
        val lst: [i32] = list_new()
        expect lst_len(lst) == 0
        expect lst_is_empty(lst) == true

    it "tests non-empty list":
        var lst: [i32] = list_new()
        lst_push(lst, 1)
        lst_push(lst, 2)
        lst_push(lst, 3)
        expect lst_len(lst) == 3
        expect lst_is_empty(lst) == false

    it "tests list contains":
        var lst: [i32] = list_new()
        lst_push(lst, 10)
        lst_push(lst, 20)
        expect lst_contains(lst, &10) == true
        expect lst_contains(lst, &99) == false

describe "Option branch coverage":
    it "tests Some variant":
        val opt: Option<i32> = has_field = true, field_value = 42
        expect opt_is_some(opt) == true
        expect opt_is_none(opt) == false
        expect opt_value == 42

    it "tests None variant":
        val opt: Option<i32> = nil
        expect opt_is_some(opt) == false
        expect opt_is_none(opt) == true

    it "tests unwrap_or with Some":
        val opt: Option<i32> = has_field = true, field_value = 42
        expect opt_unwrap_or(opt, 99) == 42

    it "tests unwrap_or with None":
        val opt: Option<i32> = nil
        expect opt_unwrap_or(opt, 99) == 99

describe "Result branch coverage":
    it "tests Ok variant":
        val res: Result<i32, text> = Ok(42)
        expect res_is_ok(res) == true
        expect res_is_err(res) == false

    it "tests Err variant":
        val res: Result<i32, text> = Err("error")
        expect res_is_ok(res) == false
        expect res_is_err(res) == true

    it "tests unwrap_or with Ok":
        val res: Result<i32, text> = Ok(42)
        expect res_unwrap_or(res, 99) == 42

    it "tests unwrap_or with Err":
        val res: Result<i32, text> = Err("error")
        expect res_unwrap_or(res, 99) == 99
