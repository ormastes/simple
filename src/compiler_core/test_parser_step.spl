use compiler.parser.*
use compiler.parser_types.*
use compiler.lexer.*
use compiler.blocks.*
use compiler.treesitter.*

print "=== Step-by-step Parser Test ==="
val src = "fn main() -> i64:\n    0\n"

# Step 1: Create TreeSitter outline
print "Step 1: TreeSitter..."
var ts = treesitter_new(src)
val outline = ts_parse_outline(ts)
print "  Name: '{outline.name}'"
print "  Imports: {outline.imports.len()}"
print "  Functions: {outline.functions.len()}"
if outline.functions_len(functions) > 0:
    print "  Fn[0] name: {outline.functions[0].name}"

# Step 2: Create parser with outline  
print "Step 2: Create parser with outline..."
var parser = parser_new(src)
parser.outline = outline
print "  Parser created with outline"

# Step 3: Parse
print "Step 3: Parsing..."
val ast = parser_parse(parser)
print "  Module: {ast.name}"
print "=== SUCCESS ==="
