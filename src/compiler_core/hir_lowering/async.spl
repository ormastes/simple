# HIR Lowering - Async/Await Support
#
# This module provides HIR integration for async/await features:
# - Future<T> type recognition and lowering
# - Async function validation
# - State machine type checking
# - Poll function signature validation
# - Error diagnostics integration

use hir_types.*
use hir_definitions.*
use parser.*
use lexer.Span
use hir_lowering.types.{HirLowering, LoweringError, LoweringErrorKind}
use hir_lowering.async_errors.{
    AsyncError,
    AsyncErrorCollector,
    async_fn_must_return_future,
    type_mismatch_in_state,
    poll_function_wrong_signature,
    future_type_param_mismatch,
    invalid_state_enum_structure,
    future_type_not_found
}

# ================================================================
# Future<T> Type Support
# ================================================================


# ============================================================================
# HirLowering Methods (was: impl HirLowering:)
# ============================================================================

# ================================================================
# Async Function Validation
# ================================================================


# ============================================================================
# HirLowering Methods (was: impl HirLowering:)
# ============================================================================

struct AsyncFunctionCheck:
    """Validation results for an async function.

    Contains information about type consistency between:
    - Async function return type
    - Generated state enum
    - Generated poll function

    Now includes detailed error diagnostics with helpful messages.
    """
    is_valid: bool
    errors: [text]
    detailed_errors: [AsyncError]  # Detailed error diagnostics
    function_name: text
    # # DESUGARED: inner_type: HirType
    has_inner_type: bool
    inner_type: HirType


# ============================================================================
# HirLowering Methods (was: impl HirLowering:)
# ============================================================================

# ================================================================
# Helper Functions
# ================================================================


# ============================================================================
# HirLowering Methods (was: impl HirLowering:)
# ============================================================================

# ================================================================
# Exports
# ================================================================

export AsyncFunctionCheck
