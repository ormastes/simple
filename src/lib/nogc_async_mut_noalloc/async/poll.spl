# Poll - Polling Result Type for Noalloc Async
#
# Minimal poll result using i32 status + i64 value.
# No generics, no heap â€” pure value types.
#
# Usage:
#   val result = PollResult.pending()
#   if result.is_ready():
#       val v = result.value

export POLL_PENDING, POLL_READY, PollResult

# ============================================================================
# Poll Status Constants
# ============================================================================

val POLL_PENDING: i32 = 0
val POLL_READY: i32   = 1

# ============================================================================
# PollResult - Polling Outcome
# ============================================================================

class PollResult:
    """Result of polling an async task.

    status: POLL_PENDING (task not done) or POLL_READY (task complete).
    value: Result value when ready (meaningful only if status == POLL_READY).
    """
    status: i32
    value: i64

    static fn pending() -> PollResult:
        """Create a pending poll result."""
        PollResult(status: POLL_PENDING, value: 0)

    static fn ready(v: i64) -> PollResult:
        """Create a ready poll result with the given value."""
        PollResult(status: POLL_READY, value: v)

    fn is_ready() -> bool:
        """Check if the task is complete."""
        self.status == POLL_READY

    fn is_pending() -> bool:
        """Check if the task is still running."""
        self.status == POLL_PENDING
