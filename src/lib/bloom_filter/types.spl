# Bloom Filter Data Structures and Type Definitions

# Standard Bloom filter
# (size, num_hashes, bits, item_count)
fn create_bloom_filter_struct(size: i64, num_hashes: i64, bits: List, item_count: i64) -> tuple:
    ("bloom", size, num_hashes, bits, item_count)

# Counting Bloom filter (uses 8-bit counters instead of bits)
# (size, num_hashes, counters, item_count)
fn create_counting_filter_struct(size: i64, num_hashes: i64, counters: List, item_count: i64) -> tuple:
    ("counting", size, num_hashes, counters, item_count)

# Scalable Bloom filter (list of filters with decreasing error rates)
# (initial_capacity, base_error_rate, growth_factor, filters, total_items)
fn create_scalable_filter_struct(initial_capacity: i64, base_error_rate: f64, growth_factor: i64, filters: List, total_items: i64) -> tuple:
    ("scalable", initial_capacity, base_error_rate, growth_factor, filters, total_items)

# Cuckoo filter (bucket_count, bucket_size, fingerprint_size, buckets, item_count)
fn create_cuckoo_filter_struct(bucket_count: i64, bucket_size: i64, fingerprint_size: i64, buckets: List, item_count: i64) -> tuple:
    ("cuckoo", bucket_count, bucket_size, fingerprint_size, buckets, item_count)

# Bit array operations (using list of integers as bit storage)
fn create_bit_array(size: i64) -> List:
    val num_words = (size + 63) / 64
    val words = []
    for i in 0..num_words:
        words.append(0)
    words

fn get_bit(array: List, index: i64) -> bool:
    val word_index = index / 64
    val bit_index = index % 64
    val word = array[word_index]
    val mask = 1 << bit_index
    (word & mask) != 0

fn set_bit(array: List, index: i64) -> nil:
    val word_index = index / 64
    val bit_index = index % 64
    val word = array[word_index]
    val mask = 1 << bit_index
    array[word_index] = word | mask
    nil

fn clear_bit(array: List, index: i64) -> nil:
    val word_index = index / 64
    val bit_index = index % 64
    val word = array[word_index]
    val mask = 1 << bit_index
    array[word_index] = word & ~mask
    nil

fn count_set_bits(array: List, total_bits: i64) -> i64:
    var count = 0
    for i in 0..total_bits:
        if get_bit(array, i):
            count = count + 1
    count
