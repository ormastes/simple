# Diagnostic Severity Levels
#
# Provides severity classification for compiler diagnostics.
# Pure functional implementation with ANSI color support.
#
# Lean-friendly: Simple enum with pure methods, no state, provable properties

# Severity level of a diagnostic
enum Severity:
    # Fatal error that prevents compilation
    Error
    # Warning that doesn't prevent compilation
    Warning
    # Informational note
    Note
    # Helpful suggestion
    Help
    # General information
    Info

impl Severity:
    # Get the English name (for error codes, internal use)
    fn name() -> text:
        match self:
            Severity.Error -> "error"
            Severity.Warning -> "warning"
            Severity.Note -> "note"
            Severity.Help -> "help"
            Severity.Info -> "info"

    # Get ANSI color code for terminal output
    fn color() -> text:
        match self:
            Severity.Error -> "\x1b[1;31m"      # Bold red
            Severity.Warning -> "\x1b[1;33m"    # Bold yellow
            Severity.Note -> "\x1b[1;36m"       # Bold cyan
            Severity.Help -> "\x1b[1;32m"       # Bold green
            Severity.Info -> "\x1b[1;34m"       # Bold blue

    # Get reset code for ANSI colors
    static fn reset_color() -> text:
        "\x1b[0m"

    # Format severity with color for terminal output
    fn colored() -> text:
        "{self.color()}{self.name()}{Severity.reset_color()}"

    # Check if severity is an error
    fn is_error() -> bool:
        match self:
            Severity.Error -> true
            _ -> false

    # Check if severity is a warning
    fn is_warning() -> bool:
        match self:
            Severity.Warning -> true
            _ -> false

    # Check if severity blocks compilation
    fn blocks_compilation() -> bool:
        self.is_error()

    # Get severity order for sorting (lower = more severe)
    fn order() -> i32:
        match self:
            Severity.Error -> 0
            Severity.Warning -> 1
            Severity.Note -> 2
            Severity.Help -> 3
            Severity.Info -> 4

    # Parse severity from string name
    static fn from_name(name: text) -> Option<Severity>:
        if name == "error":
            Some(Severity.Error)
        else if name == "warning":
            Some(Severity.Warning)
        else if name == "note":
            Some(Severity.Note)
        else if name == "help":
            Some(Severity.Help)
        else if name == "info":
            Some(Severity.Info)
        else:
            None

    # Get all severity levels in order
    static fn all() -> [Severity]:
        [Severity.Error, Severity.Warning, Severity.Note, Severity.Help, Severity.Info]
