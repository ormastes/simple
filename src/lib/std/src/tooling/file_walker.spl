# File walking utilities for migration operations
# Migrated from: src/driver/src/cli/migrate/file_walker.rs
# Purpose: Collect files and print migration summaries

# Collect .spl files from a path (file or directory)
fn collect_spl_files(path: text) -> List<text>:
    if is_file(path):
        [path]
    else:
        # Walk directory and find all .spl files
        walk_directory(path=path, extension=".spl")

# Collect *_spec.spl files from a path (file or directory)
fn collect_spec_files(path: text) -> List<text>:
    if is_file(path):
        [path]
    else:
        # Walk directory and find all *_spec.spl files
        val all_files = walk_directory(path=path, extension=".spl")
        all_files.filter(\f: get_filename(f).ends_with("_spec.spl"))

# Print migration summary for dry-run mode
fn print_dry_run_summary(modified_count: i32, total_files: i32, error_count: i32):
    print ""
    print "DRY RUN complete!"
    print "  Would modify: {modified_count}"
    print "  Unchanged: {total_files - modified_count - error_count}"
    print "  Errors: {error_count}"
    if modified_count > 0:
        print ""
        print "Run without --dry-run to apply these changes"

# Print migration summary for actual run
fn print_migration_summary(modified_count: i32, total_files: i32, error_count: i32):
    print ""
    print "Migration complete!"
    print "  Modified: {modified_count}"
    print "  Unchanged: {total_files - modified_count - error_count}"
    print "  Errors: {error_count}"

# Helper: Get filename from path
fn get_filename(path: text) -> text:
    val parts = path.split("/")
    if parts.len() > 0:
        parts[parts.len() - 1]
    else:
        path


# Stub functions
# NOTE: These are now available in infra.file_io module
# Replace these stubs with: use infra.file_io.{is_file, list_dir, glob}

fn is_file(path: text) -> bool:
    # Stub: would check if path is a file (use infra.file_io.is_file instead)
    path.contains(".")

fn walk_directory(path: text, extension: text) -> List<text>:
    # Stub: would walk directory and find all files with extension
    ["{path}/example.spl", "{path}/test.spl"]
