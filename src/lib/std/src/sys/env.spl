# Environment Variables - Access and manipulation
#
# Provides access to environment variables in the current process.

# FFI for environment access
extern fn rt_env_get(name: text) -> text
extern fn rt_env_set(name: text, value: text) -> bool
extern fn rt_env_remove(name: text) -> bool
extern fn rt_env_exists(name: text) -> bool
extern fn rt_env_all() -> List<(text, text)>
extern fn rt_env_cwd() -> text
extern fn rt_env_home() -> text
extern fn rt_env_temp() -> text

# Get an environment variable, returns empty string if not set
fn get(name: text) -> text:
    return rt_env_get(name)

# Get an environment variable with a default value
fn get_or(name: text, default: text) -> text:
    val value = rt_env_get(name)
    if value == "":
        return default
    return value

# Get an environment variable as Option
fn get_opt(name: text) -> Option<text>:
    if rt_env_exists(name):
        return Option.some(rt_env_get(name))
    return Option.none()

# Set an environment variable
fn set(name: text, value: text) -> bool:
    return rt_env_set(name, value)

# Remove an environment variable
fn remove(name: text) -> bool:
    return rt_env_remove(name)

# Check if an environment variable exists
fn exist(name: text) -> bool:
    return rt_env_exists(name)

# Get all environment variables as key-value pairs
fn all() -> List<(text, text)>:
    return rt_env_all()

# Get the current working directory
fn cwd() -> text:
    return rt_env_cwd()

# Get the user's home directory
fn home() -> text:
    return rt_env_home()

# Get the temporary directory
fn temp() -> text:
    return rt_env_temp()

# Common environment variable accessors
fn path() -> text:
    return get("PATH")

fn user() -> text:
    return get("USER")

fn shell() -> text:
    return get("SHELL")

fn lang() -> text:
    return get("LANG")

fn term() -> text:
    return get("TERM")

export get, get_or, get_opt, set, remove, exists, all
export cwd, home, temp
export path, user, shell, lang, term
