# Package System Smoke Test
# Quick verification that FFI bindings work

use app.io
fn main():
    print "Running Package FFI Smoke Test..."
    print ""

    var passed = 0
    var failed = 0

    # Test 1: Path existence check
    print "Test 1: Path existence check"
    if package_ffi.path_exists("/tmp"):
        print "  ✓ /tmp exists (as expected)"
        passed = passed + 1
    else:
        print "  ✗ FAILED: /tmp should exist"
        failed = failed + 1

    # Test 2: Directory check
    print "Test 2: Directory check"
    if package_ffi.is_directory("/tmp"):
        print "  ✓ /tmp is a directory (as expected)"
        passed = passed + 1
    else:
        print "  ✗ FAILED: /tmp should be a directory"
        failed = failed + 1

    # Test 3: Create directory
    print "Test 3: Create directory"
    val test_dir = "/tmp/simple-smoke-test"
    if package_ffi.path_exists(test_dir):
        package_ffi.remove_dir_all(test_dir)

    if package_ffi.mkdir_all(test_dir):
        print "  ✓ Created directory: {test_dir}"
        passed = passed + 1
    else:
        print "  ✗ FAILED: Could not create directory"
        failed = failed + 1

    # Test 4: Verify created directory exists
    print "Test 4: Verify created directory"
    if package_ffi.path_exists(test_dir) and package_ffi.is_directory(test_dir):
        print "  ✓ Directory exists and is a directory"
        passed = passed + 1
    else:
        print "  ✗ FAILED: Directory should exist"
        failed = failed + 1

    # Test 5: Remove directory
    print "Test 5: Remove directory"
    if package_ffi.remove_dir_all(test_dir):
        print "  ✓ Removed directory: {test_dir}"
        passed = passed + 1
    else:
        print "  ✗ FAILED: Could not remove directory"
        failed = failed + 1

    # Test 6: Verify directory removed
    print "Test 6: Verify directory removed"
    if not package_ffi.path_exists(test_dir):
        print "  ✓ Directory no longer exists"
        passed = passed + 1
    else:
        print "  ✗ FAILED: Directory should be removed"
        failed = failed + 1

    # Test 7: Platform detection
    print "Test 7: Platform detection"
    val platform = detect_platform()
    if platform.contains("-"):
        print "  ✓ Platform detected: {platform}"
        passed = passed + 1
    else:
        print "  ✗ FAILED: Invalid platform format"
        failed = failed + 1

    # Summary
    print ""
    print "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
    print "Test Results:"
    print "  Passed: {passed}"
    print "  Failed: {failed}"
    print "  Total:  {passed + failed}"

    if failed == 0:
        print ""
        print "✅ All tests passed!"
        print "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
    else:
        print ""
        print "❌ Some tests failed!"
        print "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
