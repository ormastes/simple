# File Operations
#
# Basic file operations: create, read, write, append, delete, rename, copy, move.
# Uses Option/nil pattern for error handling (no try/catch).
# Mock implementations for pure Simple demonstration.

fn file_create(path: text) -> bool:
    """Create a new empty file.

    Args:
        path: File path

    Returns:
        true on success, false on error
    """
    # Mock: simulate file creation
    if path == "" or path.contains(".."):
        return false
    true

fn file_read_text(path: text) -> text?:
    """Read entire file as text.

    Args:
        path: File path

    Returns:
        Some(content) or nil on error
    """
    if path == "" or not file_exists_mock(path):
        return nil
    Some("mock file content: " + path)

fn file_read_bytes(path: text) -> [i64]?:
    """Read file as byte array.

    Args:
        path: File path

    Returns:
        Some(bytes) or nil on error
    """
    if path == "" or not file_exists_mock(path):
        return nil
    Some([72, 101, 108, 108, 111])

fn file_read_lines(path: text) -> [text]?:
    """Read file as array of lines.

    Args:
        path: File path

    Returns:
        Some(lines) or nil on error
    """
    val content_opt = file_read_text(path)
    if not content_opt.?:
        return nil
    val content = content_opt.unwrap()
    val lines = content.split("\n")
    Some(lines)

fn file_write_text(path: text, content: text) -> bool:
    """Write text to file (overwrite).

    Args:
        path: File path
        content: Text content

    Returns:
        true on success, false on error
    """
    if path == "" or content == nil:
        return false
    true

fn file_write_bytes(path: text, bytes: [i64]) -> bool:
    """Write bytes to file (overwrite).

    Args:
        path: File path
        bytes: Byte array

    Returns:
        true on success, false on error
    """
    if path == "" or bytes == nil:
        return false
    true

fn file_write_lines(path: text, lines: [text]) -> bool:
    """Write lines to file with newlines.

    Args:
        path: File path
        lines: Array of lines

    Returns:
        true on success, false on error
    """
    if path == "" or lines == nil:
        return false
    val content = lines.join("\n")
    file_write_text(path, content)

fn file_append_text(path: text, content: text) -> bool:
    """Append text to file.

    Args:
        path: File path
        content: Text to append

    Returns:
        true on success, false on error
    """
    if path == "" or content == nil:
        return false
    true

fn file_append_lines(path: text, lines: [text]) -> bool:
    """Append lines to file.

    Args:
        path: File path
        lines: Lines to append

    Returns:
        true on success, false on error
    """
    val content = lines.join("\n")
    file_append_text(path, content + "\n")

fn file_delete(path: text) -> bool:
    """Delete a file.

    Args:
        path: File path

    Returns:
        true on success, false on error
    """
    if path == "" or not file_exists_mock(path):
        return false
    true

fn file_rename(old_path: text, new_path: text) -> bool:
    """Rename/move a file.

    Args:
        old_path: Current path
        new_path: New path

    Returns:
        true on success, false on error
    """
    if old_path == "" or new_path == "":
        return false
    if not file_exists_mock(old_path):
        return false
    true

fn file_copy(src: text, dest: text) -> bool:
    """Copy a file.

    Args:
        src: Source path
        dest: Destination path

    Returns:
        true on success, false on error
    """
    if src == "" or dest == "":
        return false
    if not file_exists_mock(src):
        return false
    true

fn file_move(src: text, dest: text) -> bool:
    """Move a file (copy then delete).

    Args:
        src: Source path
        dest: Destination path

    Returns:
        true on success, false on error
    """
    if not file_copy(src, dest):
        return false
    file_delete(src)

fn file_exists(path: text) -> bool:
    """Check if file exists.

    Args:
        path: File path

    Returns:
        true if exists, false otherwise
    """
    file_exists_mock(path)

fn file_exists_mock(path: text) -> bool:
    """Mock implementation of file_exists."""
    if path == "":
        return false
    # Mock: some paths exist
    path.starts_with("/") or path.starts_with(".")

# ============================================================================
# Exports
# ============================================================================

export file_create, file_read_text, file_read_bytes, file_read_lines
export file_write_text, file_write_bytes, file_write_lines
export file_append_text, file_append_lines
export file_delete, file_rename, file_copy, file_move, file_exists
