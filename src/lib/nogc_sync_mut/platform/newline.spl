# Newline Translation
#
# TextMode enum and translation functions for handling newlines
# across different platforms.

use std.platform.config.{PlatformConfig, host_config}
use std.platform.convert.{send_text, recv_text}

export TextMode, translate_write, translate_read

enum TextMode:
    Binary       # No newline translation
    Text         # Translate using host config
    Remote       # Translate using a provided remote config

fn translate_write(content: text, mode: TextMode, remote: PlatformConfig) -> text:
    val host = host_config()
    match mode:
        case TextMode.Binary: content
        case TextMode.Text:
            send_text(host, host, content)  # hostâ†’host (normalize only)
        case TextMode.Remote:
            send_text(host, remote, content)

fn translate_read(content: text, mode: TextMode, remote: PlatformConfig) -> text:
    val host = host_config()
    match mode:
        case TextMode.Binary: content
        case TextMode.Text:
            recv_text(host, host, content)  # normalize to host
        case TextMode.Remote:
            recv_text(host, remote, content)
