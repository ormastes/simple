# TLS Validation Module
#
# Provides cryptographic validation functions including constant-time
# comparison for timing attack resistance.

# =============================================================================
# VALIDATION FUNCTIONS
# =============================================================================

# Constant-time comparison to prevent timing attacks
# Parameters:
#   a: First byte array
#   b: Second byte array
# Returns: true if equal, false otherwise
fn constant_time_compare(a, b):
    val len_a = len(a)
    val len_b = len(b)

    if len_a != len_b:
        false
    else:
        var diff = 0
        var i = 0
        while i < len_a:
            val byte_a = byte_at(a, i)
            val byte_b = byte_at(b, i)
            val xor_result = xor(byte_a, byte_b)
            diff = or(diff, xor_result)
            i = i + 1
        diff == 0
