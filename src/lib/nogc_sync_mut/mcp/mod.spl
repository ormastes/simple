# MCP Library - Public API
#
# Model Context Protocol (MCP) implementation library.
# Provides core types, helpers, schemas, handler registry, and protocol I/O for MCP servers.
#
# Usage:
#   use std.mcp.{McpState, create_mcp_state, dispatch_tool}
#   use std.mcp.{create_protocol_state, protocol_read_message, protocol_write_message}
#
# Modules:
#   - core: Core types (McpState, ToolHandler, ResourceHandler, PromptHandler)
#   - helpers: JSON utilities, string escaping, response builders
#   - schema: Pre-computed tool schemas
#   - handler_registry: Lazy handler loading and dispatch
#   - protocol: Stdin/stdout message handling (Content-Length + JSON Lines)

# Re-export public API from submodules

# Core types and factories
export core.{
    McpState,
    ToolHandler,
    ResourceHandler,
    PromptHandler,
    SessionManager,
    create_mcp_state,
    create_tool_handler,
    create_resource_handler,
    create_prompt_handler,
    create_session_manager,
    add_session,
    remove_session,
    session_exists
}

# Helper utilities
export helpers.{
    LB,
    RB,
    Q,
    parse_int,
    min_int,
    unwrap_idx,
    unwrap_str,
    get_clean_args,
    has_flag,
    jp,
    js,
    jo1,
    jo2,
    jo3,
    jo4,
    jo5,
    extract_json_string_v2,
    extract_json_string,
    extract_json_value,
    extract_nested_string,
    extract_arguments_dict,
    extract_arg,
    make_result_response,
    make_error_response,
    make_tool_result,
    make_notification,
    make_notification_no_params,
    log_level_to_int,
    make_tool_schema_multi
}

# Schema management
export schema.{
    ToolSchema,
    get_tool_schema,
    get_all_tool_schemas,
    get_tool_count,
    init_core_schemas
}

# Handler registry
export handler_registry.{
    register_tool_handler,
    register_resource_handler,
    register_prompt_handler,
    find_tool_handler,
    find_resource_handler,
    find_prompt_handler,
    dispatch_tool,
    get_registered_tools,
    get_tool_handler_count,
    get_resource_handler_count,
    get_prompt_handler_count,
    clear_registries
}

# Protocol I/O
export protocol.{
    ProtocolState,
    create_protocol_state,
    protocol_read_message,
    protocol_write_message
}
