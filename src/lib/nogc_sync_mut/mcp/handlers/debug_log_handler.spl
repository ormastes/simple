# Debug Log Tools Handler - Loaded on-demand
#
# Handles: debug_log_enable, debug_log_disable, debug_log_clear,
#          debug_log_query, debug_log_tree, debug_log_status
#
# This script is invoked as a subprocess, so imports only load when needed.

use std.nogc_async_mut.mcp.helpers.{make_error_response}
use std.nogc_async_mut.mcp.debug_log_tools.{handle_debug_log_enable, handle_debug_log_disable, handle_debug_log_clear, handle_debug_log_query, handle_debug_log_tree, handle_debug_log_status}

extern fn rt_cli_get_args() -> [text]

val args = rt_cli_get_args()
if args.len() < 4:
    print "ERROR: Usage: debug_log_handler.spl <tool_name> <id> <request_body>"
else:
    val tool_name = args[1]
    val id = args[2]
    val body = args[3]

    var response = ""
    if tool_name == "debug_log_enable":
        response = handle_debug_log_enable(id, body)
    elif tool_name == "debug_log_disable":
        response = handle_debug_log_disable(id, body)
    elif tool_name == "debug_log_clear":
        response = handle_debug_log_clear(id, body)
    elif tool_name == "debug_log_query":
        response = handle_debug_log_query(id, body)
    elif tool_name == "debug_log_tree":
        response = handle_debug_log_tree(id, body)
    elif tool_name == "debug_log_status":
        response = handle_debug_log_status(id, body)
    else:
        response = make_error_response(id, -32601, "Unknown debug_log tool: " + tool_name)

    print_raw(response)
