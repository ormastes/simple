# Pure Simple Dataset
#
# Base dataset class for data loading and iteration
# Zero external dependencies

# ============================================================================
# Dataset Base Class
# ============================================================================

class Dataset:
    """
    Base class for all datasets.

    Subclasses must implement:
    - len() -> i64: Return the total number of samples
    - get_item(index: i64) -> any: Return a single sample

    Example:
        ```simple
        class MyDataset(Dataset):
            data: [[f64]]

            fn len() -> i64:
                self.data.len()

            fn get_item(index: i64) -> [f64]:
                self.data[index]
        ```
    """

    fn len() -> i64:
        """Return the total number of samples in the dataset."""
        0

    fn get_item(index: i64):
        """
        Get a single sample at the given index.

        Args:
            index: The index of the sample to retrieve

        Returns:
            The sample at the given index
        """
        nil

# ============================================================================
# Array Dataset (Simple Implementation)
# ============================================================================

class ArrayDataset:
    """
    Simple dataset that wraps an array of samples.

    Example:
        ```simple
        val data = [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]
        val dataset = ArrayDataset(data: data)
        print dataset.len()  # 3
        print dataset.get_item(0)  # [1.0, 2.0]
        ```
    """
    data: [[f64]]

    fn len() -> i64:
        """Return the number of samples."""
        self.data.len()

    fn get_item(index: i64) -> [f64]:
        """
        Get sample at index.

        Args:
            index: Sample index (must be >= 0 and < len())

        Returns:
            The sample array at the given index, or empty array if out of bounds
        """
        if index < 0:
            return []
        if index >= self.data.len():
            return []
        self.data[index]

# ============================================================================
# Labeled Dataset
# ============================================================================

class LabeledDataset:
    """
    Dataset with features and labels.

    Example:
        ```simple
        val features = [[1.0, 2.0], [3.0, 4.0]]
        val labels = [0.0, 1.0]
        val dataset = LabeledDataset(features: features, labels: labels)
        val item = dataset.get_item(0)
        print item.feature  # [1.0, 2.0]
        print item.label    # 0.0
        ```
    """
    features: [[f64]]
    labels: [f64]

    fn len() -> i64:
        """Return the number of samples."""
        self.features.len()

    fn get_item(index: i64) -> LabeledSample:
        """
        Get sample with label at index.

        Args:
            index: Sample index

        Returns:
            LabeledSample with feature and label, or empty sample if out of bounds
        """
        if index < 0:
            return LabeledSample(feature: [], label: 0.0)
        if index >= self.features.len():
            return LabeledSample(feature: [], label: 0.0)
        LabeledSample(
            feature: self.features[index],
            label: self.labels[index]
        )

class LabeledSample:
    """A single labeled sample (feature, label pair)."""
    feature: [f64]
    label: f64

# ============================================================================
# Exports
# ============================================================================

export Dataset, ArrayDataset, LabeledDataset, LabeledSample
