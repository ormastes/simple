# CLI Parser Module
# Core argument parsing functionality

# =============================================================================
# Parser Creation
# =============================================================================

# Create a new argument parser
fn create_parser(name: text, version: text) -> tuple:
    val flags = []
    val options = []
    val positionals = []
    val commands = []
    val description = ""
    (name, version, flags, options, positionals, commands, description)

# Set parser description
fn set_description(parser: tuple, desc: text) -> tuple:
    val name = parser[0]
    val version = parser[1]
    val flags = parser[2]
    val options = parser[3]
    val positionals = parser[4]
    val commands = parser[5]
    (name, version, flags, options, positionals, commands, desc)

# =============================================================================
# Argument Definition
# =============================================================================

# Add a boolean flag (e.g., -v, --verbose)
fn add_flag(parser: tuple, name: text, short: text, long: text, help: text) -> tuple:
    val parser_name = parser[0]
    val version = parser[1]
    val flags = parser[2]
    val options = parser[3]
    val positionals = parser[4]
    val commands = parser[5]
    val description = parser[6]

    val flag = (name, short, long, help, false)
    val new_flags = flags + [flag]
    (parser_name, version, new_flags, options, positionals, commands, description)

# Add an option with a value (e.g., -o file.txt, --output=file.txt)
fn add_option(parser: tuple, name: text, short: text, long: text, default: text, help: text) -> tuple:
    val parser_name = parser[0]
    val version = parser[1]
    val flags = parser[2]
    val options = parser[3]
    val positionals = parser[4]
    val commands = parser[5]
    val description = parser[6]

    val option = (name, short, long, default, help, default, false)
    val new_options = options + [option]
    (parser_name, version, flags, new_options, positionals, commands, description)

# Add a required option
fn add_required_option(parser: tuple, name: text, short: text, long: text, help: text) -> tuple:
    val parser_name = parser[0]
    val version = parser[1]
    val flags = parser[2]
    val options = parser[3]
    val positionals = parser[4]
    val commands = parser[5]
    val description = parser[6]

    val option = (name, short, long, "", help, "", true)
    val new_options = options + [option]
    (parser_name, version, flags, new_options, positionals, commands, description)

# Add a positional argument
fn add_positional(parser: tuple, name: text, help: text) -> tuple:
    val parser_name = parser[0]
    val version = parser[1]
    val flags = parser[2]
    val options = parser[3]
    val positionals = parser[4]
    val commands = parser[5]
    val description = parser[6]

    val positional = (name, help, "", false)
    val new_positionals = positionals + [positional]
    (parser_name, version, flags, options, new_positionals, commands, description)

# Add a required positional argument
fn add_required_positional(parser: tuple, name: text, help: text) -> tuple:
    val parser_name = parser[0]
    val version = parser[1]
    val flags = parser[2]
    val options = parser[3]
    val positionals = parser[4]
    val commands = parser[5]
    val description = parser[6]

    val positional = (name, help, "", true)
    val new_positionals = positionals + [positional]
    (parser_name, version, flags, options, new_positionals, commands, description)
