# OAuth 2.0 Types Module
# Data structures for OAuth implementation

# ============================================================================
# OAuth Configuration
# ============================================================================

# Create OAuth configuration
# Returns: (client_id, client_secret, redirect_uri, auth_url, token_url)
fn create_oauth_config(client_id: text, client_secret: text, redirect_uri: text, auth_url: text, token_url: text):
    (client_id, client_secret, redirect_uri, auth_url, token_url)

# Get client ID from config
fn get_config_client_id(config):
    config.0

# Get client secret from config
fn get_config_client_secret(config):
    config.1

# Get redirect URI from config
fn get_config_redirect_uri(config):
    config.2

# Get authorization URL from config
fn get_config_auth_url(config):
    config.3

# Get token URL from config
fn get_config_token_url(config):
    config.4

# Validate OAuth configuration
fn validate_oauth_config(config) -> bool:
    val client_id = get_config_client_id(config)
    val client_secret = get_config_client_secret(config)
    val redirect_uri = get_config_redirect_uri(config)
    val auth_url = get_config_auth_url(config)
    val token_url = get_config_token_url(config)

    var valid = true
    if string.length(client_id) == 0:
        valid = false
    if string.length(client_secret) == 0:
        valid = false
    if string.length(redirect_uri) == 0:
        valid = false
    if string.length(auth_url) == 0:
        valid = false
    if string.length(token_url) == 0:
        valid = false

    valid

# ============================================================================
# Access Token Structure
# ============================================================================

# Create access token
# Returns: (token, token_type, expires_in, refresh_token, scope, issued_at)
fn create_access_token(token: text, token_type: text, expires_in: i64, refresh_token: text, scope: text, issued_at: i64):
    (token, token_type, expires_in, refresh_token, scope, issued_at)

# Get access token string
fn get_access_token(token):
    token.0

# Get token type (usually "Bearer")
fn get_token_type(token):
    token.1

# Get expires_in value (seconds)
fn get_expires_in(token):
    token.2

# Get refresh token
fn get_refresh_token(token):
    token.3

# Get token scope
fn get_token_scope(token):
    token.4

# Get token issued timestamp
fn get_token_issued_at(token):
    token.5

# Create token with current timestamp
fn create_token_now(token: text, token_type: text, expires_in: i64, refresh_token: text, scope: text):
    val now = get_current_timestamp()
    create_access_token(token, token_type, expires_in, refresh_token, scope, now)

# ============================================================================
# EXPORTS
# ============================================================================

export create_oauth_config, get_config_client_id, get_config_client_secret
export get_config_redirect_uri, get_config_auth_url, get_config_token_url, validate_oauth_config
export create_access_token, get_access_token, get_token_type, get_expires_in
export get_refresh_token, get_token_scope, get_token_issued_at, create_token_now
