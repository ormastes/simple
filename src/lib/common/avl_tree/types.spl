# AVL Tree Types and Node Operations
#
# Core data structures and node manipulation for AVL trees

# ============================================================================
# Data Structures (tuple-based)
# ============================================================================

# AVLTree: (root: node, size: i64)
# AVLNode: (value: i64, left: node, right: node, height: i64)
# NIL_NODE: Special sentinel for empty nodes

# ============================================================================
# Constants and Sentinel Values
# ============================================================================

# NIL_NODE sentinel: (value: -999999999, left: nil, right: nil, height: 0)
# We use -999999999 as a sentinel value to represent nil nodes
fn NIL_SENTINEL() -> i64:
    -999999999

# ============================================================================
# Node Creation and Basic Accessors
# ============================================================================

# Create a nil node (sentinel)
fn nil_node() -> (i64, (i64, (i64, (i64, (i64, i64)))), (i64, (i64, (i64, (i64, i64)))), i64):
    val sentinel = NIL_SENTINEL()
    (sentinel, nil, nil, 0)

# Check if a node is nil
fn is_nil(node) -> bool:
    if node == nil:
        return true
    val value = node.0
    value == NIL_SENTINEL()

# Create a new AVL node with a value
fn create_node(value: i64) -> (i64, (i64, (i64, (i64, (i64, i64)))), (i64, (i64, (i64, (i64, i64)))), i64):
    (value, nil, nil, 1)

# Get node value
fn get_value(node) -> i64:
    if is_nil(node):
        return 0
    node.0

# Get left child
fn get_left(node):
    if is_nil(node):
        return nil
    node.1

# Get right child
fn get_right(node):
    if is_nil(node):
        return nil
    node.2

# Get node height
fn get_node_height(node) -> i64:
    if is_nil(node):
        return 0
    node.3

# Set node value
fn set_value(node, value: i64):
    if is_nil(node):
        return node
    (value, get_left(node), get_right(node), get_node_height(node))

# Set left child
fn set_left(node, left):
    if is_nil(node):
        return node
    (get_value(node), left, get_right(node), get_node_height(node))

# Set right child
fn set_right(node, right):
    if is_nil(node):
        return node
    (get_value(node), get_left(node), right, get_node_height(node))

# Set node height
fn set_height(node, height: i64):
    if is_nil(node):
        return node
    (get_value(node), get_left(node), get_right(node), height)
