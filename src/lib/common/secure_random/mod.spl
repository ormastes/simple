# Cryptographically Secure Random Number Generation - Facade Module
#
# This module provides a comprehensive CSPRNG (Cryptographically Secure
# Pseudo-Random Number Generator) implementation based on ChaCha20 stream cipher.
#
# SECURITY PROPERTIES:
# - Unpredictability: Cannot predict future outputs from past outputs
# - Backtracking resistance: Past outputs don't reveal previous state
# - Forward secrecy: Compromise of state doesn't reveal past outputs
# - Uniform distribution: All values equally likely
#
# IMPLEMENTATION:
# - ChaCha20 stream cipher as core CSPRNG
# - Automatic entropy collection and reseeding
# - Fortuna-inspired multi-pool design
# - Constant-time operations where possible
#
# NOTE: Pure Simple implementation - no FFI or system calls
# Uses timestamps and execution state for entropy

import "types" as Types
import "entropy" as Entropy
import "generate" as Generate
import "shuffle" as Shuffle
import "sample" as Sample
import "utilities" as Utilities

# Re-export all public functions

# Main random bytes generation
export secure_random_bytes = Generate.secure_random_bytes
export fill_random_bytes = Generate.fill_random_bytes

# Random integers
export secure_random_u32 = Generate.secure_random_u32
export secure_random_u64 = Generate.secure_random_u64
export secure_random_int = Generate.secure_random_int

# Random floats
export secure_random_float = Generate.secure_random_float
export secure_random_range = Generate.secure_random_range
export secure_random_double = Generate.secure_random_double

# Random choice and sampling
export secure_choice = Shuffle.secure_choice
export secure_sample = Shuffle.secure_sample
export secure_shuffle = Shuffle.secure_shuffle

# UUID generation
export generate_uuid_v4 = Generate.generate_uuid_v4
export generate_uuid_hex = Generate.generate_uuid_hex

# Token generation
export generate_token = Generate.generate_token
export generate_hex_token = Generate.generate_hex_token
export generate_base64_token = Generate.generate_base64_token

# Password generation
export generate_password = Generate.generate_password
export generate_secure_password = Generate.generate_secure_password
export generate_alphanumeric_password = Generate.generate_alphanumeric_password
export generate_pin = Generate.generate_pin

# Utility functions
export bytes_to_hex = Utilities.bytes_to_hex
export hex_to_bytes = Utilities.hex_to_bytes
export xor_bytes = Utilities.xor_bytes
export constant_time_compare = Utilities.constant_time_compare

# Additional random utilities
export secure_random_bool = Generate.secure_random_bool
export secure_random_byte = Generate.secure_random_byte
export secure_random_hex = Generate.secure_random_hex
export secure_random_alnum = Generate.secure_random_alnum
export secure_random_lowercase = Generate.secure_random_lowercase
export secure_random_uppercase = Generate.secure_random_uppercase
export secure_random_digits = Generate.secure_random_digits

# Advanced random operations
export secure_weighted_choice = Shuffle.secure_weighted_choice
export secure_random_permutation = Shuffle.secure_random_permutation
export secure_random_subset = Shuffle.secure_random_subset

# State management
export add_custom_entropy = Entropy.add_custom_entropy
export force_reseed = Generate.force_reseed
export get_csprng_stats = Generate.get_csprng_stats
export reset_csprng = Generate.reset_csprng
export is_csprng_initialized = Generate.is_csprng_initialized
export get_entropy_pool_sizes = Entropy.get_entropy_pool_sizes

# ChaCha20 core (for advanced users)
export chacha20_block = Generate.chacha20_block

# Utility conversions
export bytes_to_base64 = Utilities.bytes_to_base64
export bytes_to_u32_le = Utilities.bytes_to_u32_le
export u32_to_bytes_le = Utilities.u32_to_bytes_le
export rotate_left = Utilities.rotate_left
