# Fraction Type Definitions and Constants
#
# Fractions are represented as tuples: (numerator, denominator)
# All operations maintain the invariant that denominator > 0

fn from_int(num: i64, den: i64) -> (i64, i64):
    if den == 0:
        print "Error: denominator cannot be zero"
        return (0, 1)

    if den < 0:
        return (-num, -den)

    return (num, den)

fn from_whole(n: i64) -> (i64, i64):
    return (n, 1)

fn from_fraction(frac: (i64, i64)) -> (i64, i64):
    return frac

fn from_decimal_approx(value: f64, max_iterations: i64) -> (i64, i64):
    if max_iterations <= 0:
        return (0, 1)

    val sign = if value < 0.0: -1 else: 1
    val abs_value = if value < 0.0: -value else: value

    # Extract integer part
    val int_part = floor_decimal(abs_value)
    val frac_part = abs_value - int_part

    # If no fractional part, return integer
    if frac_part < 0.0000001:
        return (sign * int_part, 1)

    # Continued fractions algorithm
    var h1 = 1
    var h2 = 0
    var k1 = 0
    var k2 = 1
    var b = int_part
    var remainder = frac_part

    var iter = 0
    loop:
        if iter >= max_iterations:
            break

        val h = b * h1 + h2
        val k = b * k1 + k2

        h2 = h1
        h1 = h
        k2 = k1
        k1 = k

        if remainder < 0.0000001:
            break

        val inv = 1.0 / remainder
        val new_b = floor_decimal(inv)
        remainder = inv - new_b
        b = new_b

        iter = iter + 1

    return (sign * h1, k1)

# Common fraction constants
fn zero() -> (i64, i64):
    return (0, 1)

fn one() -> (i64, i64):
    return (1, 1)

fn half() -> (i64, i64):
    return (1, 2)

fn third() -> (i64, i64):
    return (1, 3)

fn quarter() -> (i64, i64):
    return (1, 4)

fn fifth() -> (i64, i64):
    return (1, 5)

fn sixth() -> (i64, i64):
    return (1, 6)

fn eighth() -> (i64, i64):
    return (1, 8)

fn tenth() -> (i64, i64):
    return (1, 10)

fn two_thirds() -> (i64, i64):
    return (2, 3)

fn three_quarters() -> (i64, i64):
    return (3, 4)

fn four_fifths() -> (i64, i64):
    return (4, 5)

fn five_sixths() -> (i64, i64):
    return (5, 6)
