# Common GPU Device Types
#
# Shared GpuBackend enum and Gpu struct usable by both gc_async_mut and nogc_sync_mut.
# Pure data types â€” no ownership, no torch dependency.
#
# Usage:
#   use std.common.gpu.device.{GpuBackend, Gpu, gpu_cuda, gpu_vulkan, gpu_none}

# ============================================================================
# Backend Enumeration
# ============================================================================

enum GpuBackend:
    """GPU backend type."""
    Cuda       # NVIDIA CUDA (via PyTorch)
    Vulkan     # Vulkan compute (planned)
    None_       # No GPU / CPU fallback

# ============================================================================
# Device Info
# ============================================================================

struct Gpu:
    """GPU device handle."""
    backend: GpuBackend
    device_id: i32
    is_initialized: bool

impl Gpu:
    fn is_valid() -> bool:
        self.is_initialized

    fn sync() -> bool:
        """Wait for all operations on this device to complete."""
        true

# ============================================================================
# Device Constructors
# ============================================================================

fn gpu_cuda(device_id: i32) -> Gpu:
    """Create CUDA GPU handle.

    Args:
        device_id: Device ID (0=1st GPU, 1=2nd GPU, etc.)

    Returns:
        GPU handle for CUDA device
    """
    Gpu(
        backend: GpuBackend.Cuda,
        device_id: device_id,
        is_initialized: true
    )

fn gpu_vulkan(device_id: i32) -> Gpu:
    """Create Vulkan GPU handle (future).

    Args:
        device_id: Device ID

    Returns:
        GPU handle for Vulkan device
    """
    Gpu(
        backend: GpuBackend.Vulkan,
        device_id: device_id,
        is_initialized: true
    )

fn gpu_none() -> Gpu:
    """Create CPU fallback handle.

    Returns:
        GPU handle for CPU fallback
    """
    Gpu(
        backend: GpuBackend.None,
        device_id: -1,
        is_initialized: true
    )

# ============================================================================
# Exports
# ============================================================================

export GpuBackend, Gpu
export gpu_cuda, gpu_vulkan, gpu_none
