# AES Types and Constants Module
#
# This module contains core AES type definitions and constants

# =============================================================================
# AES STATE OPERATIONS
# =============================================================================

# Create AES state from block (16 bytes)
# State is 4x4 matrix in column-major order
fn create_state(block: list) -> list:
    val state = []
    var i = 0
    while i < 16:
        state.append(block[i])
        i = i + 1
    state

# Extract block from state
fn state_to_block(state: list) -> list:
    val block = []
    var i = 0
    while i < 16:
        block.append(state[i])
        i = i + 1
    block

# Get state element at (row, col)
fn state_get(state: list, row: i64, col: i64) -> i64:
    val index = col * 4 + row
    state[index]

# Set state element at (row, col)
fn state_set(state: list, row: i64, col: i64, value: i64) -> list:
    val index = col * 4 + row
    val new_state = []
    var i = 0
    while i < 16:
        if i == index:
            new_state.append(value)
        else:
            new_state.append(state[i])
        i = i + 1
    new_state
