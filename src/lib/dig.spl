# Standard Library â€” Dig (Nested Access)
#
# @tag:api
# @tag:stdlib
#
# Ruby-inspired dig: safely access nested arrays using a list of indices.
# Returns nil if any key in the path is missing or out of bounds.
#
# Usage:
#   val matrix = [[1, 2], [3, 4]]
#   dig(matrix, [1, 0])       # 3
#   dig(matrix, [5, 0])       # nil (out of bounds)
#   dig_or(matrix, [5, 0], 0) # 0  (default)

# Safely access a nested structure via a list of integer indices.
# Returns nil if out of bounds at any step.
fn dig(obj, keys):
    var current = obj
    for key in keys:
        if current == nil:
            return nil
        if key >= current.len():
            return nil
        if key < 0:
            return nil
        current = current[key]
    current

# Like dig but returns default_val instead of nil when the path is missing.
fn dig_or(obj, keys, default_val):
    val result = dig(obj, keys)
    if result == nil:
        return default_val
    result

export dig, dig_or
