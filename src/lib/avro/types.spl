# Avro Type Constants and Type Checking
#
# Provides type constants, primitive type constructors, and type checking
# functions for the Avro serialization system.

# ============================================================================
# Avro Type Constants
# ============================================================================

fn avro_type_null() -> i64: 0
fn avro_type_boolean() -> i64: 1
fn avro_type_int() -> i64: 2
fn avro_type_long() -> i64: 3
fn avro_type_float() -> i64: 4
fn avro_type_double() -> i64: 5
fn avro_type_bytes() -> i64: 6
fn avro_type_string() -> i64: 7
fn avro_type_record() -> i64: 8
fn avro_type_enum() -> i64: 9
fn avro_type_array() -> i64: 10
fn avro_type_map() -> i64: 11
fn avro_type_union() -> i64: 12
fn avro_type_fixed() -> i64: 13

# ============================================================================
# Primitive Type Constructors
# ============================================================================

fn avro_null_type():
    """Create an Avro null type."""
    (type: avro_type_null(), name: "null")

fn avro_boolean_type():
    """Create an Avro boolean type."""
    (type: avro_type_boolean(), name: "boolean")

fn avro_int_type():
    """Create an Avro int type (32-bit signed integer)."""
    (type: avro_type_int(), name: "int")

fn avro_long_type():
    """Create an Avro long type (64-bit signed integer)."""
    (type: avro_type_long(), name: "long")

fn avro_float_type():
    """Create an Avro float type (single precision)."""
    (type: avro_type_float(), name: "float")

fn avro_double_type():
    """Create an Avro double type (double precision)."""
    (type: avro_type_double(), name: "double")

fn avro_bytes_type():
    """Create an Avro bytes type (arbitrary byte sequence)."""
    (type: avro_type_bytes(), name: "bytes")

fn avro_string_type():
    """Create an Avro string type (unicode text)."""
    (type: avro_type_string(), name: "string")

# ============================================================================
# Type Checking Functions
# ============================================================================

fn avro_is_primitive(schema):
    """Check if schema is a primitive type."""
    val type_id = schema.type
    if type_id == avro_type_null(): return true
    if type_id == avro_type_boolean(): return true
    if type_id == avro_type_int(): return true
    if type_id == avro_type_long(): return true
    if type_id == avro_type_float(): return true
    if type_id == avro_type_double(): return true
    if type_id == avro_type_bytes(): return true
    if type_id == avro_type_string(): return true
    false

fn avro_is_complex(schema):
    """Check if schema is a complex type."""
    val type_id = schema.type
    if type_id == avro_type_record(): return true
    if type_id == avro_type_enum(): return true
    if type_id == avro_type_array(): return true
    if type_id == avro_type_map(): return true
    if type_id == avro_type_union(): return true
    if type_id == avro_type_fixed(): return true
    false

fn avro_is_named_type(schema):
    """Check if schema is a named type (record, enum, fixed)."""
    val type_id = schema.type
    if type_id == avro_type_record(): return true
    if type_id == avro_type_enum(): return true
    if type_id == avro_type_fixed(): return true
    false

fn avro_type_name(schema) -> text:
    """Get the type name from schema."""
    schema.name

fn avro_get_type_name(type_id: i64) -> text:
    """Get type name string from type ID."""
    if type_id == avro_type_null(): return "null"
    if type_id == avro_type_boolean(): return "boolean"
    if type_id == avro_type_int(): return "int"
    if type_id == avro_type_long(): return "long"
    if type_id == avro_type_float(): return "float"
    if type_id == avro_type_double(): return "double"
    if type_id == avro_type_bytes(): return "bytes"
    if type_id == avro_type_string(): return "string"
    if type_id == avro_type_record(): return "record"
    if type_id == avro_type_enum(): return "enum"
    if type_id == avro_type_array(): return "array"
    if type_id == avro_type_map(): return "map"
    if type_id == avro_type_union(): return "union"
    if type_id == avro_type_fixed(): return "fixed"
    "unknown"
