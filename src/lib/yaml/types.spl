# YAML Types Module
# Value constructors and type checks

# ============================================================================
# Value Constructors
# ============================================================================

fn yaml_null() -> (text, (text, text)):
    """Create a YAML null value."""
    ("scalar", ("null", "null"))

fn yaml_boolean(value: bool) -> (text, (text, text)):
    """Create a YAML boolean value."""
    val str_value = if value: "true" else: "false"
    ("scalar", ("boolean", str_value))

fn yaml_number(value: text) -> (text, (text, text)):
    """Create a YAML number value."""
    ("scalar", ("number", value))

fn yaml_string(value: text) -> (text, (text, text)):
    """Create a YAML string value."""
    ("scalar", ("string", value))

fn yaml_sequence(items: list) -> (text, list):
    """Create a YAML sequence value."""
    ("sequence", items)

fn yaml_mapping(pairs: list) -> (text, list):
    """Create a YAML mapping value."""
    ("mapping", pairs)

# ============================================================================
# Value Type Checks
# ============================================================================

fn is_yaml_null(value: (text, any)) -> bool:
    """Check if value is a YAML null."""
    val value_type = value.0
    val value_data = value.1
    var result = false
    if value_type == "scalar":
        val scalar_type = value_data.0
        result = scalar_type == "null"
    result

fn is_yaml_boolean(value: (text, any)) -> bool:
    """Check if value is a YAML boolean."""
    val value_type = value.0
    val value_data = value.1
    var result = false
    if value_type == "scalar":
        val scalar_type = value_data.0
        result = scalar_type == "boolean"
    result

fn is_yaml_number(value: (text, any)) -> bool:
    """Check if value is a YAML number."""
    val value_type = value.0
    val value_data = value.1
    var result = false
    if value_type == "scalar":
        val scalar_type = value_data.0
        result = scalar_type == "number"
    result

fn is_yaml_string(value: (text, any)) -> bool:
    """Check if value is a YAML string."""
    val value_type = value.0
    val value_data = value.1
    var result = false
    if value_type == "scalar":
        val scalar_type = value_data.0
        result = scalar_type == "string"
    result

fn is_yaml_sequence(value: (text, any)) -> bool:
    """Check if value is a YAML sequence."""
    val value_type = value.0
    value_type == "sequence"

fn is_yaml_mapping(value: (text, any)) -> bool:
    """Check if value is a YAML mapping."""
    val value_type = value.0
    value_type == "mapping"

fn is_yaml_scalar(value: (text, any)) -> bool:
    """Check if value is a YAML scalar."""
    val value_type = value.0
    value_type == "scalar"

# ============================================================================
# Value Extraction
# ============================================================================

fn yaml_get_scalar_type(value: (text, any)) -> text:
    """Get the scalar type from a scalar value."""
    val value_data = value.1
    value_data.0

fn yaml_get_scalar_content(value: (text, any)) -> text:
    """Get the scalar content from a scalar value."""
    val value_data = value.1
    value_data.1

fn yaml_get_sequence_items(value: (text, any)) -> list:
    """Get items from a sequence value."""
    value.1

fn yaml_get_mapping_pairs(value: (text, any)) -> list:
    """Get key-value pairs from a mapping value."""
    value.1

# ============================================================================
# EXPORTS
# ============================================================================

export yaml_null, yaml_boolean, yaml_number, yaml_string, yaml_sequence, yaml_mapping
export is_yaml_null, is_yaml_boolean, is_yaml_number, is_yaml_string
export is_yaml_sequence, is_yaml_mapping, is_yaml_scalar
export yaml_get_scalar_type, yaml_get_scalar_content
export yaml_get_sequence_items, yaml_get_mapping_pairs
