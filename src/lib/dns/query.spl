# DNS Query Access Functions

fn dns_get_header_id(header) -> i64:
    # Extract transaction ID from header
    val result = header.0
    result

fn dns_get_header_flags(header) -> i64:
    # Extract flags from header
    val result = header.1
    result

fn dns_get_header_qd_count(header) -> i64:
    # Extract question count from header
    val result = header.2
    result

fn dns_get_header_an_count(header) -> i64:
    # Extract answer count from header
    val result = header.3
    result

fn dns_get_header_ns_count(header) -> i64:
    # Extract authority count from header
    val result = header.4
    result

fn dns_get_header_ar_count(header) -> i64:
    # Extract additional count from header
    val result = header.5
    result

fn dns_is_response(header) -> i64:
    # Check if message is a response (QR=1)
    val flags = dns_get_header_flags(header)
    val decoded = dns_decode_flags(flags)
    val qr = decoded.0
    qr

fn dns_get_rcode(header) -> i64:
    # Extract response code from header
    val flags = dns_get_header_flags(header)
    val decoded = dns_decode_flags(flags)
    val rcode = decoded.6
    rcode

fn dns_get_question_name(question) -> text:
    # Extract name from question
    val result = question.0
    result

fn dns_get_question_type(question) -> i64:
    # Extract query type from question
    val result = question.1
    result

fn dns_get_question_class(question) -> i64:
    # Extract query class from question
    val result = question.2
    result

fn dns_get_rr_name(rr) -> text:
    # Extract name from resource record
    val result = rr.0
    result

fn dns_get_rr_type(rr) -> i64:
    # Extract type from resource record
    val result = rr.1
    result

fn dns_get_rr_class(rr) -> i64:
    # Extract class from resource record
    val result = rr.2
    result

fn dns_get_rr_ttl(rr) -> i64:
    # Extract TTL from resource record
    val result = rr.3
    result

fn dns_get_rr_data(rr) -> text:
    # Extract data from resource record
    val result = rr.4
    result

fn dns_is_a_record(rr) -> i64:
    # Check if record is A type (IPv4)
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_A
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_aaaa_record(rr) -> i64:
    # Check if record is AAAA type (IPv6)
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_AAAA
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_cname_record(rr) -> i64:
    # Check if record is CNAME type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_CNAME
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_mx_record(rr) -> i64:
    # Check if record is MX type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_MX
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_ns_record(rr) -> i64:
    # Check if record is NS type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_NS
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_ptr_record(rr) -> i64:
    # Check if record is PTR type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_PTR
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_soa_record(rr) -> i64:
    # Check if record is SOA type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_SOA
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_txt_record(rr) -> i64:
    # Check if record is TXT type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_TXT
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_is_srv_record(rr) -> i64:
    # Check if record is SRV type
    val rtype = dns_get_rr_type(rr)
    val result = rtype == DNS_TYPE_SRV
    val int_result = 0
    if result:
        int_result = 1
    int_result

fn dns_get_message_header(message):
    # Extract header from message
    val result = message.0
    result

fn dns_get_message_questions(message):
    # Extract questions from message
    val result = message.1
    result

fn dns_get_message_answers(message):
    # Extract answers from message
    val result = message.2
    result

fn dns_get_message_authority(message):
    # Extract authority records from message
    val result = message.3
    result

fn dns_get_message_additional(message):
    # Extract additional records from message
    val result = message.4
    result

fn dns_is_success(rcode: i64) -> i64:
    # Check if response code indicates success
    val result = rcode == DNS_RCODE_NOERROR
    val int_result = 0
    if result:
        int_result = 1
    int_result
