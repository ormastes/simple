# AsyncIO - Async I/O Operations
#
# Non-blocking I/O operations.

use std.async.future.{Future}
use std.async.ffi.{async_sleep, async_yield, async_read_file, async_write_file}

class AsyncIO:
    """Non-blocking I/O operations.

    Provides async versions of blocking I/O operations.

    Example:
        val io = AsyncIO.new()

        # Async read
        val data = await io.read_file("data.txt")

        # Async write
        await io.write_file("output.txt", data)
    """
    executor: Executor  # IO executor

    static fn new() -> AsyncIO:
        """Create async I/O runtime."""
        AsyncIO(executor: Executor.new())

    fn sleep(millis: usize) -> Future<()>:
        """Sleep for specified milliseconds (async).

        Args:
            millis: Milliseconds to sleep

        Returns:
            Future that completes after delay
        """
        val state = async_sleep(millis)
        Future(state: state)

    fn yield_now() -> Future<()>:
        """Yield to other tasks.

        Returns:
            Future that completes immediately but allows scheduling
        """
        val state = async_yield()
        Future(state: state)

    fn read_file(path: text) -> Future<[u8]>:
        """Read file asynchronously.

        Args:
            path: File path

        Returns:
            Future with file contents
        """
        val state = async_read_file(path)
        Future(state: state)

    fn write_file(path: text, data: [u8]) -> Future<bool>:
        """Write file asynchronously.

        Args:
            path: File path
            data: Data to write

        Returns:
            Future with success flag
        """
        val state = async_write_file(path, data)
        Future(state: state)

export AsyncIO
