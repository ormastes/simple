# Standard Library — Tap / Side-Effect Utilities
#
# @tag:api
# @tag:stdlib
#
# Ruby-inspired tap: apply a side effect to a value, then return the value unchanged.
# Useful for debugging, logging, or chaining side effects in pipelines.
#
# Usage:
#   val result = compute_something()
#     |> tap(\x: print("debug: {x}"))
#     |> transform()

# Applies f to value for side effects, returns value unchanged.
fn tap(value, f):
    f(value)
    value

# Applies f to value only if condition is true, returns value unchanged.
fn tap_if(value, condition, f):
    if condition:
        f(value)
    value

# Applies f to value only if value is nil, returns value unchanged.
fn tap_nil(value, f):
    if value == nil:
        f(value)
    value

# Alias for tap — Ruby's `also`/Kotlin convention.
fn also(value, f):
    f(value)
    value

export tap, tap_if, tap_nil, also
