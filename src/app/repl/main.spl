# Simple Language REPL
# Interactive Read-Eval-Print Loop with TUI
# Usage: simple_repl [--version]

# REPL version information
val VERSION = "0.1.0"

# Get the banner text
fn get_banner() -> text:
    return "Simple Language REPL v" + VERSION + "\nType 'exit()' or press ESC to quit\nType 'help()' for help\n"

# Show help information
fn show_help() -> text:
    return "Simple REPL Help\n================\n\nCommands:\n  exit()         - Exit the REPL\n  help()         - Show this help\n  clear()        - Clear the screen\n\nFeatures:\n  - Multi-line input (end lines with ':' to continue)\n  - Auto-indentation (4 spaces after ':')\n  - Smart backspace (deletes 4 spaces in indentation)\n  - Tab inserts 4 spaces\n  - ESC to exit\n\nExamples:\n  >>> 1 + 1\n  2\n\n  >>> val x = 42\n  >>> x * 2\n  84\n"

# Main REPL loop
fn run_repl() -> i64:
    print get_banner()

    # Track if we should continue running
    var running = true
    var output_buffer = []

    # Main event loop
    while running:
        # Read input
        var line = input(">>> ")
        val trimmed = line.trim()

        # Handle built-in commands
        if trimmed == "exit()" or trimmed == "quit()":
            running = false
        elif trimmed == "help()":
            val help_text = show_help()
            print help_text
        elif trimmed == "clear()":
            output_buffer = []
        elif trimmed.len() > 0:
            # Echo input for now (actual execution requires runner)
            print trimmed

    return 0

# Entry point
fn main():
    val args = get_args()

    # Handle --version flag
    for arg in args:
        if arg == "--version":
            print "Simple REPL v" + VERSION
            return

    # Handle --help flag
    for arg in args:
        if arg == "--help" or arg == "-h":
            print "Simple Language REPL"
            print "===================="
            print ""
            print "Usage: simple_repl [OPTIONS]"
            print ""
            print "Options:"
            print "  --version    Show version information"
            print "  --help, -h   Show this help"
            print ""
            print "Interactive Commands:"
            print "  exit()       Exit the REPL"
            print "  help()       Show help"
            print "  clear()      Clear screen"
            print ""
            print "Keyboard Shortcuts:"
            print "  ESC          Exit REPL"
            print "  Ctrl+C       Exit REPL"
            print "  Ctrl+D       Exit REPL"
            print "  Ctrl+L       Clear screen"
            print "  Tab          Insert 4 spaces"
            print ""
            return

    # Run REPL
    val exit_code = run_repl()
