# Documentation item types and enumerations

# Enumeration for different kinds of documentation items
enum DocKind:
    Function
    Struct
    Class
    Enum
    EnumVariant
    Constant
    Variable
    Module
    ImplBlock

# Represents a single documentable item in the codebase
struct DocItem:
    kind: DocKind
    name: text
    file: text
    line: i64
    col: i64
    visibility: text
    signature: text
    has_inline_comment: bool
    inline_comment: text
    has_docstring: bool
    docstring: text
    has_sdoctest: bool
    sdoctest_tags: [text]
    parent: text
    is_public: bool
    is_exported: bool

impl DocItem:
    static fn create_function(name: text, file: text, line: i64, col: i64, visibility: text, signature: text) -> DocItem:
        DocItem(
            kind: DocKind.Function,
            name: name,
            file: file,
            line: line,
            col: col,
            visibility: visibility,
            signature: signature,
            has_inline_comment: false,
            inline_comment: "",
            has_docstring: false,
            docstring: "",
            has_sdoctest: false,
            sdoctest_tags: [],
            parent: "",
            is_public: false,
            is_exported: false
        )

    static fn create_struct(name: text, file: text, line: i64, col: i64, visibility: text) -> DocItem:
        DocItem(
            kind: DocKind.Struct,
            name: name,
            file: file,
            line: line,
            col: col,
            visibility: visibility,
            signature: "",
            has_inline_comment: false,
            inline_comment: "",
            has_docstring: false,
            docstring: "",
            has_sdoctest: false,
            sdoctest_tags: [],
            parent: "",
            is_public: false,
            is_exported: false
        )

    static fn create_class(name: text, file: text, line: i64, col: i64, visibility: text) -> DocItem:
        DocItem(
            kind: DocKind.Class,
            name: name,
            file: file,
            line: line,
            col: col,
            visibility: visibility,
            signature: "",
            has_inline_comment: false,
            inline_comment: "",
            has_docstring: false,
            docstring: "",
            has_sdoctest: false,
            sdoctest_tags: [],
            parent: "",
            is_public: false,
            is_exported: false
        )

    static fn create_enum(name: text, file: text, line: i64, col: i64, visibility: text) -> DocItem:
        DocItem(
            kind: DocKind.Enum,
            name: name,
            file: file,
            line: line,
            col: col,
            visibility: visibility,
            signature: "",
            has_inline_comment: false,
            inline_comment: "",
            has_docstring: false,
            docstring: "",
            has_sdoctest: false,
            sdoctest_tags: [],
            parent: "",
            is_public: false,
            is_exported: false
        )

    static fn create_constant(name: text, file: text, line: i64, col: i64, visibility: text) -> DocItem:
        DocItem(
            kind: DocKind.Constant,
            name: name,
            file: file,
            line: line,
            col: col,
            visibility: visibility,
            signature: "",
            has_inline_comment: false,
            inline_comment: "",
            has_docstring: false,
            docstring: "",
            has_sdoctest: false,
            sdoctest_tags: [],
            parent: "",
            is_public: false,
            is_exported: false
        )

    fn is_documented() -> bool:
        val has_inline = self.has_inline_comment
        val has_doc = self.has_docstring
        has_inline or has_doc

    fn needs_sdoctest() -> bool:
        val is_func = self.kind == DocKind.Function
        val is_pub = self.is_public
        is_func and is_pub

    fn kind_str() -> text:
        match self.kind:
            DocKind.Function: "function"
            DocKind.Struct: "struct"
            DocKind.Class: "class"
            DocKind.Enum: "enum"
            DocKind.EnumVariant: "variant"
            DocKind.Constant: "constant"
            DocKind.Variable: "variable"
            DocKind.Module: "module"
            DocKind.ImplBlock: "impl"

export DocKind, DocItem
