# warning.spl - Git compatibility warning generator
#
# Every git_* tool response is prefixed with a warning explaining
# that the repo uses jj, not git.

use app.io.mod (env_get)

fn git_compat_warning(git_tool: String, jj_command: String, jj_tool: String) -> String:
    var w = "[jj-mcp] This repository uses Jujutsu (jj), not Git.\n"
    w = w + "'" + git_tool + "' was translated to '" + jj_command + "'.\n"
    w = w + "Tip: Use '" + jj_tool + "' for native jj output.\n"
    w = w + "---\n"
    w

fn git_compat_warning_no_equiv(git_tool: String, explanation: String) -> String:
    var w = "[jj-mcp] This repository uses Jujutsu (jj), not Git.\n"
    w = w + "'" + git_tool + "' has no direct jj equivalent.\n"
    w = w + explanation + "\n"
    w = w + "---\n"
    w

fn show_warnings() -> Bool:
    val env_val = env_get("JJ_MCP_SHOW_WARNINGS")
    if env_val == "false" or env_val == "0":
        return false
    true

export git_compat_warning, git_compat_warning_no_equiv, show_warnings
