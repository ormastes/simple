# Simple Test Runner (Written in Simple)
#
# Refactored into modules for maintainability.
# See test_runner_*.spl files for implementation details.
#
# Usage:
#   simple_old src/app/test_runner_new/main.spl [path] [options]
#
# Options:
#   --unit              Run unit tests only
#   --integration       Run integration tests only
#   --system            Run system tests only
#   --fail-fast         Stop on first failure
#   --tag <name>        Filter by tag
#   --mode <mode>       Execution mode: interpreter (default), smf, native
#   --mode=<mode>       Equals syntax also supported
#   --timeout <secs>    Timeout per test file (default: 120)
#   --list              List test files without running
#   --list-ignored      List ignored tests
#   --only-slow         Run only slow tests
#   --only-skipped      Run only skipped tests
#   --show-tags         Show tags in output
#   --seed <N>          Shuffle tests deterministically
#   --safe-mode/--safe  Run in safe mode (subprocess, already default)
#   --force-rebuild     Force rebuild cached artifacts
#   --keep-artifacts    Keep compiled artifacts after run
#   --all               Run all tests including slow
#   --format doc        Nested RSpec-style output
#   --list-skip-features  List features from .skip files
#   --planned-only/--pending  Filter skip features to planned only
#   --gc-log            Enable GC logging
#   --gc=off            Disable GC

# Import all modules
use test_runner_types.*
use test_runner_args.*
use test_runner_files.*
use test_runner_execute.*
use test_runner_output.*
use test_runner_db.*
use test_runner_main.*

# Re-export all public APIs
# Types
export TestExecutionMode, TestLevel, OutputFormat
export TestOptions, TestFileResult, TestRunResult
export SkipFeatureStatus, SkipFeatureInfo

# Args module
export parse_mode_str, parse_test_args

# Files module
export discover_test_files, shuffle_files
export extract_skip_feature_info, file_has_slow_test
export print_discovery_summary, is_test_file, strip_ansi, read_file_content

# Execute module
export find_simple_new_binary, find_runtime_lib_dir, find_simple_binary
export parse_test_output, extract_number_before
export build_child_args, make_result_from_output
export run_test_file_interpreter, run_test_file_smf
export run_test_file_native_old, run_test_file_native
export preprocess_sspec_file

# Output module
export print_result_default, print_result_doc
export print_result, print_summary

# DB module
export write_test_db_run, atomic_update_file_test_db
export acquire_file_lock, micros_to_iso

# Main orchestration
export propagate_env_vars, run_tests, mode_to_str, run_single_test
export main
