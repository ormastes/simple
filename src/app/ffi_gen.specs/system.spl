# System Module - Intern FFI Spec
#
# Declares system/environment extern functions for auto-generation of
# interpreter_extern/system.rs boilerplate.
#
# Usage: simple ffi-gen --gen-intern src/app/ffi_gen/specs/system.spl

use app.ffi_gen.intern_codegen (InternFnSpec, InternParamSpec)

fn system_specs() -> [InternFnSpec]:
    var specs: [InternFnSpec] = []

    # =========================================================================
    # Environment Variables
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_env_get", category: "system",
        params: [InternParamSpec(name: "name", value_type: "String")],
        return_type: "String", runtime_fn: "rt_env_get",
        doc: "Get environment variable (empty string if not set)"
    ))

    specs.push(InternFnSpec(
        name: "rt_env_set", category: "system",
        params: [InternParamSpec(name: "name", value_type: "String"),
                 InternParamSpec(name: "value", value_type: "String")],
        return_type: "void", runtime_fn: "rt_env_set",
        doc: "Set environment variable"
    ))

    specs.push(InternFnSpec(
        name: "rt_env_remove", category: "system",
        params: [InternParamSpec(name: "name", value_type: "String")],
        return_type: "void", runtime_fn: "rt_env_remove",
        doc: "Remove environment variable"
    ))

    specs.push(InternFnSpec(
        name: "rt_env_has", category: "system",
        params: [InternParamSpec(name: "name", value_type: "String")],
        return_type: "bool", runtime_fn: "rt_env_has",
        doc: "Check if environment variable exists"
    ))

    specs.push(InternFnSpec(
        name: "rt_env_all", category: "system",
        params: [],
        return_type: "Value", runtime_fn: "rt_env_all",
        doc: "Get all environment variables as dict"
    ))

    # =========================================================================
    # System Information
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_sys_platform", category: "system",
        params: [],
        return_type: "String", runtime_fn: "rt_sys_platform",
        doc: "Get platform name (linux, macos, windows)"
    ))

    specs.push(InternFnSpec(
        name: "rt_sys_arch", category: "system",
        params: [],
        return_type: "String", runtime_fn: "rt_sys_arch",
        doc: "Get CPU architecture (x86_64, aarch64, etc.)"
    ))

    specs.push(InternFnSpec(
        name: "rt_sys_hostname", category: "system",
        params: [],
        return_type: "String", runtime_fn: "rt_sys_hostname",
        doc: "Get system hostname"
    ))

    specs.push(InternFnSpec(
        name: "rt_sys_num_cpus", category: "system",
        params: [],
        return_type: "i64", runtime_fn: "rt_sys_num_cpus",
        doc: "Get number of CPU cores"
    ))

    # =========================================================================
    # Command Line Arguments
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_args", category: "system",
        params: [],
        return_type: "Value", runtime_fn: "rt_args",
        doc: "Get command line arguments as array"
    ))

    specs.push(InternFnSpec(
        name: "rt_args_count", category: "system",
        params: [],
        return_type: "i64", runtime_fn: "rt_args_count",
        doc: "Get number of command line arguments"
    ))

    specs.push(InternFnSpec(
        name: "rt_args_get", category: "system",
        params: [InternParamSpec(name: "index", value_type: "i64")],
        return_type: "String", runtime_fn: "rt_args_get",
        doc: "Get command line argument at index (empty string if out of bounds)"
    ))

    specs
