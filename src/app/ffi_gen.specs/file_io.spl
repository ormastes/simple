# File I/O Module - Intern FFI Spec
#
# Declares file I/O extern functions for auto-generation of
# interpreter_extern/file_io.rs boilerplate.
#
# Usage: simple ffi-gen --gen-intern src/app/ffi_gen/specs/file_io.spl

use app.ffi_gen.intern_codegen (InternFnSpec, InternParamSpec)

fn file_io_specs() -> [InternFnSpec]:
    var specs: [InternFnSpec] = []

    # --- File reading ---

    specs.push(InternFnSpec(
        name: "rt_file_read_text", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "String", runtime_fn: "rt_file_read_text",
        doc: "Read entire file as text"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_read_bytes", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "Value", runtime_fn: "rt_file_read_bytes",
        doc: "Read entire file as byte array"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_read_lines", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "Value", runtime_fn: "rt_file_read_lines",
        doc: "Read file as array of lines"
    ))

    # --- File writing ---

    specs.push(InternFnSpec(
        name: "rt_file_write_text", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String"),
                 InternParamSpec(name: "content", value_type: "String")],
        return_type: "void", runtime_fn: "rt_file_write_text",
        doc: "Write text to file (overwrite)"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_append_text", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String"),
                 InternParamSpec(name: "content", value_type: "String")],
        return_type: "void", runtime_fn: "rt_file_append_text",
        doc: "Append text to file"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_write_bytes", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String"),
                 InternParamSpec(name: "bytes", value_type: "Value")],
        return_type: "void", runtime_fn: "rt_file_write_bytes",
        doc: "Write byte array to file"
    ))

    # --- File metadata ---

    specs.push(InternFnSpec(
        name: "rt_file_exists", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "bool", runtime_fn: "rt_file_exists",
        doc: "Check if file exists"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_is_dir", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "bool", runtime_fn: "rt_file_is_dir",
        doc: "Check if path is a directory"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_is_file", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "bool", runtime_fn: "rt_file_is_file",
        doc: "Check if path is a regular file"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_size", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "i64", runtime_fn: "rt_file_size",
        doc: "Get file size in bytes"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_modified", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "i64", runtime_fn: "rt_file_modified",
        doc: "Get file modification time as unix timestamp"
    ))

    # --- Directory operations ---

    specs.push(InternFnSpec(
        name: "rt_dir_create", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "void", runtime_fn: "rt_dir_create",
        doc: "Create directory (parents included)"
    ))

    specs.push(InternFnSpec(
        name: "rt_dir_list", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "Value", runtime_fn: "rt_dir_list",
        doc: "List directory entries as array of strings"
    ))

    specs.push(InternFnSpec(
        name: "rt_dir_remove", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "void", runtime_fn: "rt_dir_remove",
        doc: "Remove directory recursively"
    ))

    # --- File operations ---

    specs.push(InternFnSpec(
        name: "rt_file_copy", category: "file_io",
        params: [InternParamSpec(name: "src", value_type: "String"),
                 InternParamSpec(name: "dst", value_type: "String")],
        return_type: "void", runtime_fn: "rt_file_copy",
        doc: "Copy file from src to dst"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_rename", category: "file_io",
        params: [InternParamSpec(name: "src", value_type: "String"),
                 InternParamSpec(name: "dst", value_type: "String")],
        return_type: "void", runtime_fn: "rt_file_rename",
        doc: "Rename/move file"
    ))

    specs.push(InternFnSpec(
        name: "rt_file_delete", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "void", runtime_fn: "rt_file_delete",
        doc: "Delete file"
    ))

    # --- Path operations ---

    specs.push(InternFnSpec(
        name: "rt_path_join", category: "file_io",
        params: [InternParamSpec(name: "base", value_type: "String"),
                 InternParamSpec(name: "part", value_type: "String")],
        return_type: "String", runtime_fn: "rt_path_join",
        doc: "Join two path components"
    ))

    specs.push(InternFnSpec(
        name: "rt_path_parent", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "String", runtime_fn: "rt_path_parent",
        doc: "Get parent directory"
    ))

    specs.push(InternFnSpec(
        name: "rt_path_filename", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "String", runtime_fn: "rt_path_filename",
        doc: "Get filename component"
    ))

    specs.push(InternFnSpec(
        name: "rt_path_extension", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "String", runtime_fn: "rt_path_extension",
        doc: "Get file extension"
    ))

    specs.push(InternFnSpec(
        name: "rt_path_absolute", category: "file_io",
        params: [InternParamSpec(name: "path", value_type: "String")],
        return_type: "String", runtime_fn: "rt_path_absolute",
        doc: "Get absolute path"
    ))

    specs.push(InternFnSpec(
        name: "rt_cwd", category: "file_io",
        params: [],
        return_type: "String", runtime_fn: "rt_cwd",
        doc: "Get current working directory"
    ))

    specs
