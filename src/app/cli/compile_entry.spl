# Lightweight compile entry point for `simple compile`
#
# This file loads only the minimal imports needed to compile,
# avoiding the overhead of loading the full CLI with all its modules
# (build system, type checker, stats, etc.).
#
# Usage:
#   bin/release/simple src/app/cli/compile_entry.spl compile [options] <source.spl>
#
# Performance:
#   Full CLI (main.spl): ~460ms overhead
#   This entry (compile_entry.spl): ~220ms overhead

use app.io.mod (cli_get_args, cli_compile)

fn main() -> i64:
    val raw_args = cli_get_args()

    # raw_args: [binary_path, script_path, "compile", ...compile_args...]
    # Skip binary (args[0]) and script path (args[1])
    var compile_args = []
    var start = 2
    if raw_args.len() <= 2:
        start = raw_args.len()

    # Collect remaining args (including "compile" which cli_compile handles)
    var i = start
    while i < raw_args.len():
        compile_args.push(raw_args[i])
        i = i + 1

    cli_compile(compile_args)
