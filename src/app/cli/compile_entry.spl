# Lightweight compile entry point for `simple compile`
#
# This file loads only the minimal imports needed to compile,
# avoiding the overhead of loading the full CLI with all its modules
# (build system, type checker, stats, etc.).
#
# Usage:
#   bin/release/simple src/app/cli/compile_entry.spl compile [options] <source.spl>
#
# Performance:
#   Full CLI (main.spl): ~460ms overhead
#   This entry (compile_entry.spl): ~220ms overhead

use app.cli_util (get_cli_args)
use app.io.mod (cli_compile)

fn main() -> i64:
    val all_args = get_cli_args()

    # Strip script path from args
    # get_cli_args() returns: [script_path, "compile", ...compile_args...]
    var compile_args = []
    var start = 1
    if all_args.len() == 0:
        start = 0

    # Collect remaining args (including "compile" which cli_compile handles)
    for idx in start..all_args.len():
        compile_args.push(all_args[idx])

    cli_compile(compile_args)
