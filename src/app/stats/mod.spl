# Project statistics aggregation and reporting

use app.stats.types (ProjectStats)
use app.stats.file_scanner (scan_project_files)
use app.stats.line_counter (count_project_lines)
use app.stats.db_aggregator (collect_test_stats, collect_coverage_stats,
    collect_feature_stats, collect_bug_stats)
use app.stats.formatter (format_stats_table)

# Main entry point for stats command
fn run_stats(args: [text]):
    print "Collecting statistics..."
    print ""

    val file_stats = scan_project_files()
    val line_stats = count_project_lines()
    val test_stats = collect_test_stats()
    val coverage_stats = collect_coverage_stats()
    val feature_stats = collect_feature_stats()
    val bug_stats = collect_bug_stats()

    val stats = ProjectStats(
        file_stats: file_stats,
        line_stats: line_stats,
        test_stats: test_stats,
        coverage_stats: coverage_stats,
        feature_stats: feature_stats,
        bug_stats: bug_stats
    )

    print format_stats_table(stats)

export run_stats
