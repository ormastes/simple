# FFI - Foreign Function Interface
#
# Bridge to compiled code and built-in functions.

from bridge import {call_native, register_native, NativeFunction}
from builtins import {register_builtins, BUILTIN_FUNCTIONS}
from extern import {load_library, resolve_symbol, ExternLib}

# AST node accessor FFI (Phase 0: migration infrastructure)
from ast_ffi import {
    rt_ast_expr_tag, rt_ast_expr_int_value, rt_ast_expr_float_value,
    rt_ast_expr_string_value, rt_ast_expr_bool_value, rt_ast_expr_ident_name,
    rt_ast_expr_binary_op, rt_ast_expr_binary_left, rt_ast_expr_binary_right,
    rt_ast_expr_unary_op, rt_ast_expr_unary_operand,
    rt_ast_expr_call_callee, rt_ast_expr_call_arg_count, rt_ast_expr_call_arg,
    rt_ast_arg_value, rt_ast_arg_name,
    rt_ast_expr_method_receiver, rt_ast_expr_method_name,
    rt_ast_expr_method_arg_count, rt_ast_expr_method_arg,
    rt_ast_expr_field_receiver, rt_ast_expr_field_name,
    rt_ast_expr_array_len, rt_ast_expr_array_get,
    rt_ast_expr_free, rt_ast_node_free, rt_ast_arg_free,
    rt_ast_registry_clear, rt_ast_registry_count
}

# Environment/scope FFI
from env_ffi import {
    rt_env_new_handle, rt_env_push_scope, rt_env_pop_scope,
    rt_env_define_var, rt_env_get_var, rt_env_set_var, rt_env_has_var,
    rt_env_snapshot, rt_env_scope_depth, rt_env_free_handle,
    rt_env_var_count, rt_env_var_names
}

# Error creation FFI
from error_ffi import {
    rt_error_semantic, rt_error_type_mismatch, rt_error_undefined_var,
    rt_error_arg_count, rt_error_division_by_zero, rt_error_index_oob,
    rt_error_throw, rt_error_message, rt_error_free
}

export call_native, register_native, NativeFunction
export register_builtins, BUILTIN_FUNCTIONS
export load_library, resolve_symbol, ExternLib

# AST FFI exports
export rt_ast_expr_tag, rt_ast_expr_int_value, rt_ast_expr_float_value
export rt_ast_expr_string_value, rt_ast_expr_bool_value, rt_ast_expr_ident_name
export rt_ast_expr_binary_op, rt_ast_expr_binary_left, rt_ast_expr_binary_right
export rt_ast_expr_unary_op, rt_ast_expr_unary_operand
export rt_ast_expr_call_callee, rt_ast_expr_call_arg_count, rt_ast_expr_call_arg
export rt_ast_arg_value, rt_ast_arg_name
export rt_ast_expr_method_receiver, rt_ast_expr_method_name
export rt_ast_expr_method_arg_count, rt_ast_expr_method_arg
export rt_ast_expr_field_receiver, rt_ast_expr_field_name
export rt_ast_expr_array_len, rt_ast_expr_array_get
export rt_ast_expr_free, rt_ast_node_free, rt_ast_arg_free
export rt_ast_registry_clear, rt_ast_registry_count

# Env FFI exports
export rt_env_new_handle, rt_env_push_scope, rt_env_pop_scope
export rt_env_define_var, rt_env_get_var, rt_env_set_var, rt_env_has_var
export rt_env_snapshot, rt_env_scope_depth, rt_env_free_handle
export rt_env_var_count, rt_env_var_names

# Error FFI exports
export rt_error_semantic, rt_error_type_mismatch, rt_error_undefined_var
export rt_error_arg_count, rt_error_division_by_zero, rt_error_index_oob
export rt_error_throw, rt_error_message, rt_error_free

# Span interop FFI
from span_ffi import {
    rt_span_create, rt_span_start, rt_span_end,
    rt_span_line, rt_span_column, rt_span_free
}
export rt_span_create, rt_span_start, rt_span_end
export rt_span_line, rt_span_column, rt_span_free
