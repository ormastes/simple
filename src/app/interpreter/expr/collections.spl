# Collection Expressions
#
# Array, Dict, Tuple construction.

from ..core import {Interpreter, Value, InterpreterError}
from . import {evaluate}

export eval_array, eval_dict, eval_tuple

# Evaluate array literal
fn eval_array(interp: &Interpreter, elements: &Array<Expr>) -> Result<Value, InterpreterError>:
    val values: Array<Value> = []

    for elem in elements:
        val value = evaluate(interp, elem)?
        values.push(value)

    return Ok(Value.array(values))

# Evaluate dictionary literal
fn eval_dict(interp: &Interpreter, pairs: &Array<(Expr, Expr)>) -> Result<Value, InterpreterError>:
    val dict: Dict<Value, Value> = Dict.new()

    for (key_expr, val_expr) in pairs:
        val key = evaluate(interp, key_expr)?
        val value = evaluate(interp, val_expr)?
        dict.set(key, value)

    return Ok(Value.dict(dict))

# Evaluate tuple literal
fn eval_tuple(interp: &Interpreter, elements: &Array<Expr>) -> Result<Value, InterpreterError>:
    val values: Array<Value> = []

    for elem in elements:
        val value = evaluate(interp, elem)?
        values.push(value)

    return Ok(Value.tuple(values))
