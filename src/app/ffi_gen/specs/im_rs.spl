# SFFI Spec for im-rs: Persistent Immutable Data Structures
#
# Rust crate: im (https://docs.rs/im/)
# Version: 15.1+
#
# Provides persistent (immutable) data structures with structural sharing:
# - HashMap: Persistent hash map
# - Vector: Persistent vector (like Vec but immutable)
# - HashSet: Persistent hash set

# ============================================================================
# Persistent HashMap
# ============================================================================

fn im_hashmap_new() -> i64:
    """Create a new empty persistent HashMap.

    Returns: Opaque handle to HashMap instance
    """
    0  # NOTE: Implement Rust FFI

fn im_hashmap_insert(handle: i64, key: text, value: text) -> i64:
    """Insert a key-value pair, returning new HashMap.

    Args:
        handle: HashMap handle
        key: Key to insert
        value: Value to insert

    Returns: Handle to new HashMap with inserted entry
    """
    0  # NOTE: Implement Rust FFI

fn im_hashmap_get(handle: i64, key: text) -> text:
    """Get value for key.

    Args:
        handle: HashMap handle
        key: Key to look up

    Returns: Value if found, empty string if not found
    """
    ""  # NOTE: Implement Rust FFI

fn im_hashmap_remove(handle: i64, key: text) -> i64:
    """Remove a key, returning new HashMap.

    Args:
        handle: HashMap handle
        key: Key to remove

    Returns: Handle to new HashMap without the key
    """
    0  # NOTE: Implement Rust FFI

fn im_hashmap_contains_key(handle: i64, key: text) -> bool:
    """Check if key exists.

    Args:
        handle: HashMap handle
        key: Key to check

    Returns: true if key exists
    """
    false  # NOTE: Implement Rust FFI

fn im_hashmap_len(handle: i64) -> i64:
    """Get number of entries.

    Args:
        handle: HashMap handle

    Returns: Number of key-value pairs
    """
    0  # NOTE: Implement Rust FFI

fn im_hashmap_keys(handle: i64) -> [text]:
    """Get all keys.

    Args:
        handle: HashMap handle

    Returns: Array of all keys
    """
    []  # NOTE: Implement Rust FFI

fn im_hashmap_values(handle: i64) -> [text]:
    """Get all values.

    Args:
        handle: HashMap handle

    Returns: Array of all values
    """
    []  # NOTE: Implement Rust FFI

fn im_hashmap_drop(handle: i64):
    """Drop HashMap handle and free resources.

    Args:
        handle: HashMap handle to drop
    """
    ()  # NOTE: Implement Rust FFI

# ============================================================================
# Persistent Vector
# ============================================================================

fn im_vector_new() -> i64:
    """Create a new empty persistent Vector.

    Returns: Opaque handle to Vector instance
    """
    0  # NOTE: Implement Rust FFI

fn im_vector_push_back(handle: i64, value: text) -> i64:
    """Append value to end, returning new Vector.

    Args:
        handle: Vector handle
        value: Value to append

    Returns: Handle to new Vector with value appended
    """
    0  # NOTE: Implement Rust FFI

fn im_vector_push_front(handle: i64, value: text) -> i64:
    """Prepend value to start, returning new Vector.

    Args:
        handle: Vector handle
        value: Value to prepend

    Returns: Handle to new Vector with value prepended
    """
    0  # NOTE: Implement Rust FFI

fn im_vector_get(handle: i64, index: i64) -> text:
    """Get value at index.

    Args:
        handle: Vector handle
        index: Index to retrieve

    Returns: Value at index, empty string if out of bounds
    """
    ""  # NOTE: Implement Rust FFI

fn im_vector_set(handle: i64, index: i64, value: text) -> i64:
    """Set value at index, returning new Vector.

    Args:
        handle: Vector handle
        index: Index to set
        value: New value

    Returns: Handle to new Vector with updated value
    """
    0  # NOTE: Implement Rust FFI

fn im_vector_len(handle: i64) -> i64:
    """Get number of elements.

    Args:
        handle: Vector handle

    Returns: Number of elements
    """
    0  # NOTE: Implement Rust FFI

fn im_vector_pop_back(handle: i64) -> (i64, text, bool):
    """Remove last element, returning (new Vector, value, success).

    Args:
        handle: Vector handle

    Returns: (new handle, popped value, true if successful)
    """
    (0, "", false)  # NOTE: Implement Rust FFI

fn im_vector_pop_front(handle: i64) -> (i64, text, bool):
    """Remove first element, returning (new Vector, value, success).

    Args:
        handle: Vector handle

    Returns: (new handle, popped value, true if successful)
    """
    (0, "", false)  # NOTE: Implement Rust FFI

fn im_vector_drop(handle: i64):
    """Drop Vector handle and free resources.

    Args:
        handle: Vector handle to drop
    """
    ()  # NOTE: Implement Rust FFI

# ============================================================================
# Persistent HashSet
# ============================================================================

fn im_hashset_new() -> i64:
    """Create a new empty persistent HashSet.

    Returns: Opaque handle to HashSet instance
    """
    0  # NOTE: Implement Rust FFI

fn im_hashset_insert(handle: i64, value: text) -> i64:
    """Insert value, returning new HashSet.

    Args:
        handle: HashSet handle
        value: Value to insert

    Returns: Handle to new HashSet with value inserted
    """
    0  # NOTE: Implement Rust FFI

fn im_hashset_remove(handle: i64, value: text) -> i64:
    """Remove value, returning new HashSet.

    Args:
        handle: HashSet handle
        value: Value to remove

    Returns: Handle to new HashSet without value
    """
    0  # NOTE: Implement Rust FFI

fn im_hashset_contains(handle: i64, value: text) -> bool:
    """Check if value exists.

    Args:
        handle: HashSet handle
        value: Value to check

    Returns: true if value exists
    """
    false  # NOTE: Implement Rust FFI

fn im_hashset_len(handle: i64) -> i64:
    """Get number of elements.

    Args:
        handle: HashSet handle

    Returns: Number of elements
    """
    0  # NOTE: Implement Rust FFI

fn im_hashset_to_array(handle: i64) -> [text]:
    """Get all elements as array.

    Args:
        handle: HashSet handle

    Returns: Array of all elements
    """
    []  # NOTE: Implement Rust FFI

fn im_hashset_drop(handle: i64):
    """Drop HashSet handle and free resources.

    Args:
        handle: HashSet handle to drop
    """
    ()  # NOTE: Implement Rust FFI

# ============================================================================
# Exports
# ============================================================================

export im_hashmap_new
export im_hashmap_insert
export im_hashmap_get
export im_hashmap_remove
export im_hashmap_contains_key
export im_hashmap_len
export im_hashmap_keys
export im_hashmap_values
export im_hashmap_drop

export im_vector_new
export im_vector_push_back
export im_vector_push_front
export im_vector_get
export im_vector_set
export im_vector_len
export im_vector_pop_back
export im_vector_pop_front
export im_vector_drop

export im_hashset_new
export im_hashset_insert
export im_hashset_remove
export im_hashset_contains
export im_hashset_len
export im_hashset_to_array
export im_hashset_drop
