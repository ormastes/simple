# FFI - System Operations
# Centralized environment, process, and time FFI wrappers

# ============================================================================
# Environment Operations
# ============================================================================

extern fn rt_env_cwd() -> text

fn env_cwd() -> text:
    rt_env_cwd()

fn cwd() -> text:
    rt_env_cwd()

extern fn rt_env_home() -> text

fn env_home() -> text:
    rt_env_home()

fn home() -> text:
    rt_env_home()

extern fn rt_env_get(key: text) -> text

fn env_get(key: text) -> text:
    rt_env_get(key)

extern fn rt_env_set(key: text, value: text) -> bool

fn env_set(key: text, value: text) -> bool:
    rt_env_set(key, value)

extern fn rt_env_remove(key: text) -> bool

fn env_remove(key: text) -> bool:
    rt_env_remove(key)

extern fn rt_env_vars() -> [(text, text)]

fn env_vars() -> [(text, text)]:
    rt_env_vars()

# --- Program Arguments ---

extern fn rt_args_get() -> [text]

fn args_get() -> [text]:
    rt_args_get()

fn args() -> [text]:
    rt_args_get()

# ============================================================================
# Process Operations
# ============================================================================

# --- Process Execution ---

extern fn rt_process_run(cmd: text, args: [text]) -> (text, text, i64)

fn process_run(cmd: text, args: [text]) -> (text, text, i64):
    rt_process_run(cmd, args)

extern fn rt_process_run_timeout(cmd: text, args: [text], timeout_ms: i64) -> (text, text, i32)

fn process_run_timeout(cmd: text, args: [text], timeout_ms: i64) -> (text, text, i32):
    rt_process_run_timeout(cmd, args, timeout_ms)

extern fn rt_process_run_with_limits(cmd: text, args: [text], timeout_ms: i64, memory_mb: i64) -> (text, text, i32)

fn process_run_with_limits(cmd: text, args: [text], timeout_ms: i64, memory_mb: i64) -> (text, text, i32):
    rt_process_run_with_limits(cmd, args, timeout_ms, memory_mb)

extern fn rt_execute_native(binary_path: text, args: [text], timeout_ms: i64) -> (text, text, i32)

fn execute_native(binary_path: text, args: [text], timeout_ms: i64) -> (text, text, i32):
    rt_execute_native(binary_path, args, timeout_ms)

extern fn rt_process_output(cmd: text, args: [text]) -> text

fn process_output(cmd: text, args: [text]) -> text:
    rt_process_output(cmd, args)

extern fn rt_process_spawn(cmd: text, args: [text]) -> i64

fn process_spawn(cmd: text, args: [text]) -> i64:
    rt_process_spawn(cmd, args)

extern fn rt_process_wait(pid: i64) -> i64

fn process_wait(pid: i64) -> i64:
    rt_process_wait(pid)

extern fn rt_process_kill(pid: i64) -> bool

fn process_kill(pid: i64) -> bool:
    rt_process_kill(pid)

# --- Process Information ---

extern fn rt_getpid() -> i64

fn getpid() -> i64:
    rt_getpid()

extern fn rt_hostname() -> text

fn hostname() -> text:
    rt_hostname()

extern fn rt_cpu_count() -> i64

fn cpu_count() -> i64:
    rt_cpu_count()

extern fn rt_get_host_target_code() -> i64

fn get_host_target_code() -> i64:
    rt_get_host_target_code()

extern fn rt_uuid_v4() -> text

fn uuid_v4() -> text:
    rt_uuid_v4()

# --- Shell Execution ---

extern fn rt_shell(cmd: text) -> i64

fn shell(cmd: text) -> i64:
    rt_shell(cmd)

extern fn rt_shell_output(cmd: text) -> text

fn shell_output(cmd: text) -> text:
    rt_shell_output(cmd)

extern fn rt_exec(cmd: text) -> i32

fn exec(cmd: text) -> i32:
    rt_exec(cmd)

# ============================================================================
# Time Operations
# ============================================================================

# --- Current Time ---

extern fn rt_time_now() -> i64

fn time_now() -> i64:
    rt_time_now()

extern fn rt_time_now_unix_micros() -> i64

fn time_now_unix_micros() -> i64:
    rt_time_now_unix_micros()

extern fn rt_time_now_unix_millis() -> i64

fn time_now_unix_millis() -> i64:
    rt_time_now_unix_millis()

extern fn rt_time_now_iso() -> text

fn time_now_iso() -> text:
    rt_time_now_iso()

extern fn rt_time_millis() -> i64

fn time_millis() -> i64:
    rt_time_millis()

# --- Time Components ---

extern fn rt_time_year() -> i64

fn time_year() -> i64:
    rt_time_year()

extern fn rt_time_month() -> i64

fn time_month() -> i64:
    rt_time_month()

extern fn rt_time_day() -> i64

fn time_day() -> i64:
    rt_time_day()

extern fn rt_time_hour() -> i64

fn time_hour() -> i64:
    rt_time_hour()

extern fn rt_time_minute() -> i64

fn time_minute() -> i64:
    rt_time_minute()

extern fn rt_time_second() -> i64

fn time_second() -> i64:
    rt_time_second()

# --- Timestamp Operations ---

extern fn rt_timestamp_to_string(ts: i64) -> text

fn timestamp_to_string(ts: i64) -> text:
    rt_timestamp_to_string(ts)

extern fn rt_timestamp_to_iso(ts: i64) -> text

fn timestamp_to_iso(ts: i64) -> text:
    rt_timestamp_to_iso(ts)

extern fn rt_timestamp_from_iso(iso: text) -> i64

fn timestamp_from_iso(iso: text) -> i64:
    rt_timestamp_from_iso(iso)

extern fn rt_timestamp_parse(s: text) -> i64

fn timestamp_parse(s: text) -> i64:
    rt_timestamp_parse(s)

extern fn rt_timestamp_diff_seconds(a: i64, b: i64) -> i64

fn timestamp_diff_seconds(a: i64, b: i64) -> i64:
    rt_timestamp_diff_seconds(a, b)

# --- Sleep/Delay ---

extern fn rt_sleep_ms(milliseconds: i64)

fn sleep_ms(milliseconds: i64):
    rt_sleep_ms(milliseconds)

extern fn rt_sleep_secs(seconds: i64)

fn sleep_secs(seconds: i64):
    rt_sleep_secs(seconds)
