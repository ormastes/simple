[package]
name = "simple-compiler"
version.workspace = true
edition.workspace = true
license.workspace = true

# simple-context binary migrated to Simple app: src/app/context/main.spl

[lints]
workspace = true

[features]
default = []
# Enable LLVM backend for 32-bit and broader target support
llvm = ["inkwell"]
llvm-gpu = ["llvm"]
llvm-tests = []
# WebAssembly compilation support
wasm = ["llvm"]              # Enable WASM compilation via LLVM
wasm-wasi = ["wasm"]         # WASI support (file I/O, env, args)
wasm-browser = ["wasm"]      # Browser FFI bindings (future use)
# Vulkan GPU backend support
vulkan = ["ash", "gpu-allocator", "rspirv", "spirv"]
vulkan-validation = ["vulkan"]  # Enable Vulkan validation layers
vulkan-graphics = ["vulkan"]    # Enable graphics pipeline support

[dependencies]
simple-parser = { path = "../parser" }
simple-loader = { path = "../loader" }
simple-runtime = { path = "../runtime" }
simple-hir-core = { path = "../hir-core" }
simple-native-loader = { path = "../native_loader" }
simple-dependency-tracker = { path = "../dependency_tracker" }
simple-sdn = { path = "../sdn" }
simple-diagnostics = { path = "../diagnostics" }
simple_i18n = { path = "../../../src/i18n", default-features = false }
thiserror.workspace = true
toml = "0.8"
regex = "1.11"
# Enable all-arch for cross-compilation support (x86_64, aarch64, riscv64, s390x)
# Note: Cranelift does NOT support any 32-bit architectures
cranelift-codegen = { version = "0.116", default-features = false, features = ["std", "unwind", "all-arch"] }
cranelift-frontend = "0.116"
cranelift-module = "0.116"
cranelift-object = "0.116"
cranelift-jit = "0.116"
target-lexicon = "0.13"
tracing = "0.1"
ctrlc = "3.4"  # For Ctrl-C signal handling
simple-common = { path = "../common" }
simple-type = { path = "../type" }
lazy_static = "1.4"
ureq = "2.10"  # HTTP client for interpreter networking
serde.workspace = true
serde_json = "1.0"
uuid = { version = "1.0", features = ["v4", "serde"] }
serde_yaml = "0.9"
chrono = { version = "0.4", features = ["serde"] }
rand = "0.8"  # For shuffle() and sample() methods

# Infrastructure & Dependencies (#825-849)
# Threading & Concurrency (#828-832)
rayon.workspace = true           # Parallel compilation
dashmap.workspace = true         # Concurrent symbol tables
parking_lot.workspace = true     # Fast locks
crossbeam.workspace = true       # Advanced concurrency utilities

# Hashing (#836-839)
ahash.workspace = true           # Fast hashing for HashMaps

# Data Structures (#840-845)
typed-arena.workspace = true     # Arena allocation for HIR/MIR
smallvec.workspace = true        # Stack-local small vectors
indexmap.workspace = true        # Ordered hash maps

# String Interning (#813-814)
lasso.workspace = true           # Symbol interning for linker

# Temp files for native binary linking
tempfile = "3"

# Object file parsing for SMF generation (#9)
object = "0.36"

# LLVM backend (optional) - requires LLVM 18 toolchain
inkwell = { version = "0.5", optional = true, features = ["llvm18-0"] }

# Vulkan backend (optional) - cross-platform GPU support
ash = { version = "0.38", optional = true }
gpu-allocator = { version = "0.26", optional = true }
rspirv = { version = "0.12", optional = true }
spirv = { version = "0.3", optional = true }

[target.'cfg(unix)'.dependencies]
libc = "0.2"

[dev-dependencies]
tempfile = "3"
simple-loader = { path = "../loader" }
