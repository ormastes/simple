[package]
name = "simple-driver"
version = "0.3.0"
edition = "2021"
build = "build.rs"

[lints]
workspace = true

[lib]
name = "simple_driver"
path = "src/lib.rs"

[[bin]]
name = "simple_runtime"
path = "src/main.rs"

# Main entry point is now Simple: src/app/cli/main.spl
# Run via: simple_runtime src/app/cli/main.spl [args...]
# Or use the wrapper script: ./simple

# gen-sspec-docs was migrated to:
# 1. CLI command: simple sspec-docgen
# 2. Simple app: src/app/sspec_docgen/main.spl

[build-dependencies]
walkdir = "2"

[dependencies]
simple-loader = { path = "../loader" }
simple-native-loader = { path = "../native_loader" }
simple-term-io = { path = "../../../src/lib" }
simple-compiler = { path = "../compiler" }
simple-parser = { path = "../parser" }
simple-runtime = { path = "../runtime" }
simple-common = { path = "../common" }
simple-diagnostics = { path = "../diagnostics" }
simple-log = { path = "../../../log" }
simple-pkg = { path = "../pkg" }
simple-wasm-runtime = { path = "../wasm-runtime", optional = true }
simple-sdn = { path = "../sdn" }
simple_i18n = { path = "../../../src/i18n", default-features = false, features = ["simple-format"] }

# Workaround for Wasmer probestack linker issue
# https://github.com/wasmerio/wasmer/issues/3857
[target.'cfg(not(target_env = "msvc"))'.dependencies]
compiler_builtins = { version = "0.1", optional = true }

tempfile = "3"
walkdir = "2"
notify = "6"
serde.workspace = true
serde_json = "1"
tracing = "0.1"
rustyline = "14"
dirs-next = "2"
chrono = { version = "0.4", features = ["serde"] }
ctrlc = "3.4"  # For Ctrl-C signal handling
parking_lot.workspace = true  # For lazy init infrastructure (#1996)
paste = "1"  # For lazy_static! macro identifier concatenation
indexmap.workspace = true
regex = "1"  # For TODO comment parsing
rayon = "1.10"  # For parallel TODO scanning and parallel test execution
sysinfo = "0.32"  # For CPU monitoring in parallel test runner
sha2 = "0.10"  # For file hash caching (incremental scans) and qualified_ignore signatures
hostname = "0.4"  # For test run tracking (identify machine)
argon2 = "0.5"  # For password hashing (qualified_ignore authentication)
rpassword = "7.3"  # For secure password input (qualified_ignore)
reqwest = { version = "0.11", features = ["json", "blocking"] }  # For OAuth HTTP requests
jj-lib = { version = "0.36.0", optional = true }
jj-cli = { version = "0.36.0", optional = true }

# TUI stack (optional, enabled with 'tui' feature)
crossterm = { version = "0.28", optional = true }
ratatui = { version = "0.29", optional = true }

# Unix-specific dependencies
[target.'cfg(unix)'.dependencies]
libc = "0.2"

# Windows-specific dependencies
[target.'cfg(windows)'.dependencies]
winapi = { version = "0.3", features = ["memoryapi", "winnt", "handleapi", "processthreadsapi", "minwindef"] }

[dev-dependencies]
assert_cmd = "2"
predicates = "3"
simple-dependency-tracker = { path = "../dependency_tracker" }
ctor = "0.2"
portable-pty = "0.8"

[features]
jj-lib = ["dep:jj-lib"]
jj-cli = ["dep:jj-cli"]
wasm = ["dep:simple-wasm-runtime", "simple-wasm-runtime/wasm", "simple-compiler/wasm", "compiler_builtins"]
wasm-wasi = ["wasm", "simple-compiler/wasm-wasi"]
tui = ["dep:crossterm", "dep:ratatui"]
pytorch = ["simple-runtime/pytorch"]
web_tests = [] # Enable web framework integration tests
