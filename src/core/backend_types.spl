# Core Simple — Backend Type Definitions
#
# Unified enums for backend selection, codegen target, and optimization level.
# Single source of truth — compiler modules import from here.
# Seed-compatible: simple enums (no payloads).
#
# Compiled by seed (Core Simple subset).

# ===== Backend Kind =====
# Which code generation backend to use.

enum BackendKind:
    Cranelift
    Llvm
    Native
    Wasm
    Interpreter
    Cuda
    Vulkan
    Vhdl
    Lean

# ===== Codegen Target Architecture =====

enum CodegenTarget:
    X86_64
    AArch64
    Riscv64
    Wasm32
    Host
    Native
    AArch64_MacOS
    X86_64_MacOS

# ===== Optimization Level =====
# None_ and Debug_ use trailing underscore to avoid C++ keyword conflicts.

enum OptLevel:
    None_
    Debug_
    Standard
    Aggressive
    Size
    Speed

# ===== Output Format =====

enum OutputFormat:
    Executable
    SharedLib
    StaticLib
    ObjectFile
    Assembly
    Ir

# ===== Integer-based conversion for seed compat =====
# These provide integer tag conversions for contexts that need them.

val BACKEND_CRANELIFT = 0
val BACKEND_LLVM = 1
val BACKEND_NATIVE = 2
val BACKEND_WASM = 3
val BACKEND_INTERPRETER = 4
val BACKEND_CUDA = 5
val BACKEND_VULKAN = 6
val BACKEND_VHDL = 7
val BACKEND_LEAN = 8

val TARGET_X86_64 = 0
val TARGET_AARCH64 = 1
val TARGET_RISCV64 = 2
val TARGET_WASM32 = 3
val TARGET_HOST = 4
val TARGET_NATIVE = 5
val TARGET_AARCH64_MACOS = 6
val TARGET_X86_64_MACOS = 7

val OPT_NONE = 0
val OPT_DEBUG = 1
val OPT_STANDARD = 2
val OPT_AGGRESSIVE = 3
val OPT_SIZE = 4
val OPT_SPEED = 5

val OUTPUT_EXECUTABLE = 0
val OUTPUT_SHARED_LIB = 1
val OUTPUT_STATIC_LIB = 2
val OUTPUT_OBJECT_FILE = 3
val OUTPUT_ASSEMBLY = 4
val OUTPUT_IR = 5

fn backend_kind_name(kind: i64) -> text:
    if kind == BACKEND_CRANELIFT: return "cranelift"
    if kind == BACKEND_LLVM: return "llvm"
    if kind == BACKEND_NATIVE: return "native"
    if kind == BACKEND_WASM: return "wasm"
    if kind == BACKEND_INTERPRETER: return "interpreter"
    if kind == BACKEND_CUDA: return "cuda"
    if kind == BACKEND_VULKAN: return "vulkan"
    if kind == BACKEND_VHDL: return "vhdl"
    if kind == BACKEND_LEAN: return "lean"
    "unknown"

fn target_name(target: i64) -> text:
    if target == TARGET_X86_64: return "x86_64"
    if target == TARGET_AARCH64: return "aarch64"
    if target == TARGET_RISCV64: return "riscv64"
    if target == TARGET_WASM32: return "wasm32"
    if target == TARGET_HOST: return "host"
    if target == TARGET_NATIVE: return "native"
    if target == TARGET_AARCH64_MACOS: return "aarch64-apple-darwin"
    if target == TARGET_X86_64_MACOS: return "x86_64-apple-darwin"
    "unknown"

fn opt_level_name(level: i64) -> text:
    if level == OPT_NONE: return "none"
    if level == OPT_DEBUG: return "debug"
    if level == OPT_STANDARD: return "standard"
    if level == OPT_AGGRESSIVE: return "aggressive"
    if level == OPT_SIZE: return "size"
    if level == OPT_SPEED: return "speed"
    "unknown"

fn target_is_macos(target: i64) -> bool:
    if target == TARGET_AARCH64_MACOS: return true
    if target == TARGET_X86_64_MACOS: return true
    false

fn target_is_64bit(target: i64) -> bool:
    if target == TARGET_X86_64: return true
    if target == TARGET_AARCH64: return true
    if target == TARGET_RISCV64: return true
    if target == TARGET_HOST: return true
    if target == TARGET_NATIVE: return true
    if target == TARGET_AARCH64_MACOS: return true
    if target == TARGET_X86_64_MACOS: return true
    false

# Legacy aliases for backward compatibility with CoreXxx names
# (seed compiler uses these)
val CoreBackendKind = BackendKind
val CoreCodegenTarget = CodegenTarget
val CoreOptLevel = OptLevel
val CoreOutputFormat = OutputFormat

export BackendKind, CodegenTarget, OptLevel, OutputFormat
export CoreBackendKind, CoreCodegenTarget, CoreOptLevel, CoreOutputFormat
export BACKEND_CRANELIFT, BACKEND_LLVM, BACKEND_NATIVE, BACKEND_WASM
export BACKEND_INTERPRETER, BACKEND_CUDA, BACKEND_VULKAN, BACKEND_VHDL, BACKEND_LEAN
export TARGET_X86_64, TARGET_AARCH64, TARGET_RISCV64, TARGET_WASM32, TARGET_HOST
export TARGET_NATIVE, TARGET_AARCH64_MACOS, TARGET_X86_64_MACOS
export OPT_NONE, OPT_DEBUG, OPT_STANDARD, OPT_AGGRESSIVE, OPT_SIZE, OPT_SPEED
export OUTPUT_EXECUTABLE, OUTPUT_SHARED_LIB, OUTPUT_STATIC_LIB
export OUTPUT_OBJECT_FILE, OUTPUT_ASSEMBLY, OUTPUT_IR
export backend_kind_name, target_name, opt_level_name
export target_is_macos, target_is_64bit
