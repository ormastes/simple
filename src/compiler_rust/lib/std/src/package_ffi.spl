# Package FFI Bindings
# Exposes Rust FFI functions to Simple code

# Low-level FFI declarations
extern fn rt_package_sha256(file_path: text) -> text
extern fn rt_package_create_tarball(source_dir: text, output_path: text) -> i32
extern fn rt_package_extract_tarball(tarball_path: text, dest_dir: text) -> i32
extern fn rt_package_file_size(file_path: text) -> i64
extern fn rt_package_copy_file(src_path: text, dst_path: text) -> i32
extern fn rt_package_mkdir_all(dir_path: text) -> i32
extern fn rt_package_remove_dir_all(dir_path: text) -> i32
extern fn rt_package_create_symlink(target: text, link_path: text) -> i32
extern fn rt_package_chmod(file_path: text, mode: i32) -> i32
extern fn rt_package_exists(path: text) -> i32
extern fn rt_package_is_dir(path: text) -> i32
extern fn rt_package_free_string(ptr: text) -> ()

# High-level wrapper functions
fn calculate_checksum(file_path: text) -> text:
    rt_package_sha256(file_path)

fn create_tarball(source_dir: text, output_path: text) -> bool:
    rt_package_create_tarball(source_dir, output_path) == 0

fn extract_tarball(tarball_path: text, dest_dir: text) -> bool:
    rt_package_extract_tarball(tarball_path, dest_dir) == 0

fn get_file_size(file_path: text) -> i64:
    rt_package_file_size(file_path)

fn copy_file(src_path: text, dst_path: text) -> bool:
    rt_package_copy_file(src_path, dst_path) == 0

fn mkdir_all(dir_path: text) -> bool:
    rt_package_mkdir_all(dir_path) == 0

fn remove_dir_all(dir_path: text) -> bool:
    rt_package_remove_dir_all(dir_path) == 0

fn create_symlink(target: text, link_path: text) -> bool:
    rt_package_create_symlink(target, link_path) == 0

fn set_permissions(file_path: text, mode: i32) -> bool:
    rt_package_chmod(file_path, mode) == 0

fn path_exists(path: text) -> bool:
    rt_package_exists(path) == 1

fn is_directory(path: text) -> bool:
    rt_package_is_dir(path) == 1
