# glTF Types - Data structures (JSON representation)
use core.*
use graphics.math.*
use graphics.scene.*

use core.*
use graphics.math.*
use graphics.scene.*

# =============================================================================
# glTF Data Structures (JSON representation)
# =============================================================================

pub struct GltfFile:
    asset: GltfAsset
    scenes: Array<GltfScene>
    nodes: Array<GltfNode>
    meshes: Array<GltfMesh>
    materials: Array<GltfMaterial>
    textures: Array<GltfTexture>
    images: Array<GltfImage>
    buffers: Array<GltfBuffer>
    buffer_views: Array<GltfBufferView>
    accessors: Array<GltfAccessor>
    default_scene: i32

pub struct GltfAsset:
    version: text           # "2.0"
    generator: text         # Optional
    copyright: text         # Optional

pub struct GltfScene:
    name: text
    nodes: Array<i32>         # Indices into nodes array

pub struct GltfNode:
    name: text
    mesh: i32                 # Index into meshes array (-1 = none)
    children: Array<i32>      # Child node indices
    translation: Vec3         # Default: (0, 0, 0)
    rotation: Quat            # Default: (0, 0, 0, 1)
    scale: Vec3               # Default: (1, 1, 1)
    matrix: Option<Mat4>      # Alternative to TRS

pub struct GltfMesh:
    name: text
    primitives: Array<GltfPrimitive>

pub struct GltfPrimitive:
    attributes: GltfAttributes
    indices: i32              # Accessor index (-1 = none)
    material: i32             # Material index (-1 = default)
    mode: i32                 # 4 = TRIANGLES (default)

pub struct GltfAttributes:
    position: i32             # Accessor index (-1 = required)
    normal: i32               # Accessor index (-1 = generate)
    tangent: i32              # Accessor index (-1 = generate)
    texcoord_0: i32           # Accessor index (-1 = none)
    color_0: i32              # Accessor index (-1 = white)

pub struct GltfMaterial:
    name: text
    pbr_metallic_roughness: Option<GltfPbrMetallicRoughness>
    normal_texture: Option<GltfTextureInfo>
    occlusion_texture: Option<GltfTextureInfo>
    emissive_texture: Option<GltfTextureInfo>
    emissive_factor: Vec3     # Default: (0, 0, 0)
    alpha_mode: text        # "OPAQUE", "MASK", "BLEND"
    alpha_cutoff: f32         # Default: 0.5
    double_sided: bool        # Default: false

pub struct GltfPbrMetallicRoughness:
    base_color_factor: Vec4        # Default: (1, 1, 1, 1)
    base_color_texture: Option<GltfTextureInfo>
    metallic_factor: f32           # Default: 1.0
    roughness_factor: f32          # Default: 1.0
    metallic_roughness_texture: Option<GltfTextureInfo>

pub struct GltfTextureInfo:
    index: i32                # Texture index
    tex_coord: i32            # UV set (0 = TEXCOORD_0)

pub struct GltfTexture:
    source: i32               # Image index
    sampler: i32              # Sampler index (-1 = default)

pub struct GltfImage:
    uri: text               # File path or data URI
    mime_type: text         # "image/png", "image/jpeg"
    buffer_view: i32          # BufferView index (-1 = use uri)

pub struct GltfBuffer:
    uri: text               # File path or data URI (empty = GLB binary chunk)
    byte_length: i32
    data: Array<u8>           # Loaded binary data

pub struct GltfBufferView:
    buffer: i32               # Buffer index
    byte_offset: i32          # Default: 0
    byte_length: i32
    byte_stride: i32          # Default: 0 (tightly packed)
    target: i32               # 34962 = ARRAY_BUFFER, 34963 = ELEMENT_ARRAY_BUFFER

pub struct GltfAccessor:
    buffer_view: i32          # BufferView index
    byte_offset: i32          # Default: 0
    component_type: i32       # 5126 = FLOAT, 5123 = UNSIGNED_SHORT, etc.
    count: i32                # Number of elements
    type_name: text         # "SCALAR", "VEC2", "VEC3", "VEC4", "MAT4"
    min: Array<f32>           # Bounding box min (optional)
    max: Array<f32>           # Bounding box max (optional)

