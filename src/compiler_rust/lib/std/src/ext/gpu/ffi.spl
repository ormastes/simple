# Ext FFI: GPU - GPU compute and Vulkan operations
#
# Runtime functions for GPU kernel execution.

# --- Device management ---
extern fn rt_gpu_device_count() -> i64
extern fn rt_gpu_device_name(idx: i64) -> text
extern fn rt_gpu_device_select(idx: i64) -> bool

# --- Buffer operations ---
extern fn rt_gpu_buffer_create(size: i64) -> i64
extern fn rt_gpu_buffer_upload(buf: i64, data: i64, size: i64)
extern fn rt_gpu_buffer_download(buf: i64, data: i64, size: i64)
extern fn rt_gpu_buffer_free(buf: i64)

# --- Kernel execution ---
extern fn rt_gpu_kernel_compile(source: text) -> i64
extern fn rt_gpu_kernel_launch(kernel: i64, grid_x: i64, grid_y: i64, grid_z: i64, block_x: i64, block_y: i64, block_z: i64) -> bool
extern fn rt_gpu_kernel_set_arg(kernel: i64, idx: i64, buf: i64)
extern fn rt_gpu_synchronize()

# --- Vulkan interop ---
extern fn rt_vk_instance_create() -> i64
extern fn rt_vk_device_create(instance: i64) -> i64
extern fn rt_vk_command_buffer_begin(device: i64) -> i64
extern fn rt_vk_command_buffer_end(cmd: i64)
extern fn rt_vk_queue_submit(device: i64, cmd: i64)
