# Classes Feature Specification
# Feature #11: Class definitions, methods, inheritance
# Category: Language | Difficulty: 4 | Status: Complete

# =====================================================
# Feature Metadata
# =====================================================

class FeatureMetadata:
    id: Int
    name: String
    category: String
    difficulty: Int
    status: String
    impl_type: String
    spec_ref: String
    files: List[String]
    tests: List[String]
    description: String
    code_examples: List[String]
    dependencies: List[Int]
    required_by: List[Int]
    notes: String

# Feature Definition
let FEATURE = FeatureMetadata {
    id: 11,
    name: "Classes",
    category: "Language",
    difficulty: 4,
    status: "Complete",
    impl_type: "Rust",
    spec_ref: "doc/spec/data_structures.md",
    files: [
        "src/compiler/src/interpreter.rs",
        "src/compiler/src/interpreter_method.rs",
        "src/parser/src/statements/mod.rs"
    ],
    tests: [
        "src/driver/tests/interpreter_oop_tests.rs"
    ],
    description: "Object-oriented programming with class definitions, typed fields, methods, static methods, and struct-literal instantiation. Supports single inheritance.",
    code_examples: [
        '# Define a class with fields and methods',
        '# class Point: x: Int, y: Int',
        '# let p = Point { x: 3, y: 4 }',
        '# print(p.x)  # 3'
    ],
    dependencies: [1, 2, 12],
    required_by: [],
    notes: "Classes support struct-literal syntax for instantiation. Methods use self parameter for instance access."
}

# =====================================================
# BDD Specification Tests
# =====================================================

print("============================================================")
print("  CLASSES FEATURE SPECIFICATION (#11)")
print("  Category: Language | Difficulty: 4 | Status: Complete")
print("============================================================")
print("")

let mut passed = 0
let mut failed = 0

print("describe Class definitions:")
print("  it defines classes with typed fields:")

class Point:
    x: Int
    y: Int

let p = Point { x: 3, y: 4 }
if p.x == 3 and p.y == 4:
    print("    [PASS] class with fields")
    passed = passed + 1
else:
    print("    [FAIL] class fields")
    failed = failed + 1

print("  it supports methods:")

class Counter:
    value: Int

    fn increment(self):
        self.value = self.value + 1

    fn get(self):
        return self.value

let c = Counter { value: 0 }
c.increment()
c.increment()
if c.get() == 2:
    print("    [PASS] methods with self")
    passed = passed + 1
else:
    print("    [FAIL] methods")
    failed = failed + 1

print("  it supports static methods (new pattern):")

class Person:
    name: String
    age: Int

    fn new(n: String, a: Int):
        return Person { name: n, age: a }

    fn greet(self):
        return "Hello, I am {self.name}"

let person = Person.new("Alice", 30)
if person.name == "Alice" and person.age == 30:
    print("    [PASS] static new method")
    passed = passed + 1
else:
    print("    [FAIL] static method")
    failed = failed + 1

print("")
print("describe Class with collections:")

print("  it supports List fields:")

class Container:
    items: List

    fn new():
        return Container { items: [] }

    fn add(self, item):
        self.items = self.items + [item]

    fn count(self):
        return self.items.len()

let cont = Container.new()
cont.add(1)
cont.add(2)
cont.add(3)
if cont.count() == 3:
    print("    [PASS] class with List field")
    passed = passed + 1
else:
    print("    [FAIL] List field")
    failed = failed + 1

print("  it supports nested class instances:")

class Outer:
    inner: Point

let outer = Outer { inner: Point { x: 1, y: 2 } }
if outer.inner.x == 1 and outer.inner.y == 2:
    print("    [PASS] nested class instances")
    passed = passed + 1
else:
    print("    [FAIL] nested instances")
    failed = failed + 1

# =====================================================
# Documentation Output
# =====================================================

print("")
print("============================================================")
print("  GENERATED DOCUMENTATION")
print("============================================================")
print("")
print("# {FEATURE.name}")
print("")
print("**Feature ID:** #{FEATURE.id}")
print("**Category:** {FEATURE.category}")
print("**Difficulty:** Level {FEATURE.difficulty}/5")
print("**Status:** {FEATURE.status}")
print("**Implementation:** {FEATURE.impl_type}")
print("")
print("## Description")
print("")
print(FEATURE.description)
print("")
print("## Implementation Files")
print("")
for file in FEATURE.files:
    print("- `{file}`")
print("")
print("## Test Files")
print("")
for test in FEATURE.tests:
    print("- `{test}`")
print("")
print("## Code Examples")
print("")
print("```simple")
for example in FEATURE.code_examples:
    print(example)
print("```")
print("")
if FEATURE.dependencies.len() > 0:
    print("## Dependencies")
    print("")
    print("Depends on: {FEATURE.dependencies}")
    print("")
if FEATURE.required_by.len() > 0:
    print("## Required By")
    print("")
    print("Features: {FEATURE.required_by}")
    print("")
print("## Notes")
print("")
print(FEATURE.notes)

# Summary
print("")
print("============================================================")
print("  TEST SUMMARY")
print("============================================================")
print("Passed: {passed}")
print("Failed: {failed}")
if failed == 0:
    print("All tests PASSED!")
print("============================================================")
