# Test pure Simple evaluator with simple arithmetic
# Inline version - no module imports

use std.pure.ast (Expr, BinOp, Literal)
use std.pure.evaluator (eval_expr, Value, Environment, EvalError)

fn main():
    print "Testing Pure Simple Evaluator"
    print "=============================="
    print ""

    test_addition()
    test_subtraction()
    test_multiplication()

fn test_addition():
    print "Test: 2 + 3"

    # Create AST manually: Expr.Binary(BinOp.Add, Literal(Int(2)), Literal(Int(3)))
    val left = Expr.Literal(Literal.Int(2))
    val right = Expr.Literal(Literal.Int(3))
    val expr = Expr.Binary(BinOp.Add, left, right)

    # Evaluate
    var env = Environment.empty()
    match eval_expr(expr, env):
        case Ok(Value.Int(n)):
            print "  Result: {n}"
            if n == 5:
                print "  ✓ PASS"
            else:
                print "  ✗ FAIL: expected 5, got {n}"
        case Ok(_):
            print "  ✗ FAIL: wrong value type"
        case Err(e):
            print "  ✗ ERROR: {e.message}"

    print ""

fn test_subtraction():
    print "Test: 10 - 4"

    val left = Expr.Literal(Literal.Int(10))
    val right = Expr.Literal(Literal.Int(4))
    val expr = Expr.Binary(BinOp.Sub, left, right)

    var env = Environment.empty()
    match eval_expr(expr, env):
        case Ok(Value.Int(n)):
            print "  Result: {n}"
            if n == 6:
                print "  ✓ PASS"
            else:
                print "  ✗ FAIL: expected 6, got {n}"
        case Ok(_):
            print "  ✗ FAIL: wrong value type"
        case Err(e):
            print "  ✗ ERROR: {e.message}"

    print ""

fn test_multiplication():
    print "Test: 5 * 6"

    val left = Expr.Literal(Literal.Int(5))
    val right = Expr.Literal(Literal.Int(6))
    val expr = Expr.Binary(BinOp.Mul, left, right)

    var env = Environment.empty()
    match eval_expr(expr, env):
        case Ok(Value.Int(n)):
            print "  Result: {n}"
            if n == 30:
                print "  ✓ PASS"
            else:
                print "  ✗ FAIL: expected 30, got {n}"
        case Ok(_):
            print "  ✗ FAIL: wrong value type"
        case Err(e):
            print "  ✗ ERROR: {e.message}"

    print ""

main()
