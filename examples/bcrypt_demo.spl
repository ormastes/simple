# bcrypt Password Hashing Demo
# Demonstrates basic bcrypt functionality

use std.bcrypt.core.{bcrypt_hash, bcrypt_verify, bcrypt_hash_default, bcrypt_hash_secure, get_cost_from_hash, is_bcrypt_hash}

fn main():
    print "=== bcrypt Password Hashing Demo ==="
    print ""

    # Example 1: Hash with default cost (10)
    print "Example 1: Hash with default cost"
    val password = "my_secret_password"
    val hash = bcrypt_hash_default(password)
    print "Password: {password}"
    print "Hash: {hash}"
    print "Hash length: {hash.len()}"
    print "Valid format: {is_bcrypt_hash(hash)}"
    print ""

    # Example 2: Verify correct password
    print "Example 2: Verify password"
    val is_valid = bcrypt_verify(password, hash)
    print "Correct password valid: {is_valid}"

    val wrong_password = "wrong_password"
    val is_invalid = bcrypt_verify(wrong_password, hash)
    print "Wrong password valid: {is_invalid}"
    print ""

    # Example 3: Hash with custom cost
    print "Example 3: Custom cost factor"
    val hash_low = bcrypt_hash(password, 4)
    val hash_high = bcrypt_hash(password, 12)
    print "Low cost (4): {hash_low}"
    print "High cost (12): {hash_high}"
    print "Cost extracted from low: {get_cost_from_hash(hash_low)}"
    print "Cost extracted from high: {get_cost_from_hash(hash_high)}"
    print ""

    # Example 4: Hash with high security
    print "Example 4: High security hashing"
    val secure_hash = bcrypt_hash_secure(password)
    print "Secure hash (cost 12): {secure_hash}"
    val secure_valid = bcrypt_verify(password, secure_hash)
    print "Verification: {secure_valid}"
    print ""

    print "=== Demo Complete ==="

main()
