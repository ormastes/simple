# Standard I/O - Basic stdin/stdout operations
# Provides simple functions for reading from stdin and writing to stdout

# Extern declarations for stdin/stdout FFI
extern fn rt_read_stdin_line() -> Option<String>

# Read a line from stdin (including newline)
pub fn read_line() -> Result<String, String>:
    match rt_read_stdin_line():
        case Some(line):
            Ok(line)
        case None:
            Err("Failed to read from stdin")

# Read exactly n bytes from stdin
pub fn read_exact(n: Int) -> Result<String, String>:
    # Read characters one by one until we have n bytes
    let mut result = ""
    for _ in 0..n:
        match rt_read_stdin_line():
            case Some(line):
                result = result + line
                if result.len() >= n:
                    return Ok(result.substring(0, n))
            case None:
                if result.len() > 0:
                    return Ok(result)
                else:
                    return Err("Failed to read from stdin")
    Ok(result)

# Write string to stdout
pub fn write(s: String) -> Result<Int, String>:
    print(s)
    Ok(s.len())

# Flush stdout buffer
pub fn flush() -> Result<(), String>:
    # Stdout is auto-flushed by print in most cases
    # No explicit FFI needed for now
    Ok(())
