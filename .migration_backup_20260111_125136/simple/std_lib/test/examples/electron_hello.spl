# Hello Electron App - Simple System Tray Example
# Demonstrates basic Electron tray app functionality

import electron.app
import electron.tray
import electron.notification

# State
let tray: Option<Tray> = none
let click_count: i32 = 0

# Main entry point
fn main():
    print("Starting Hello Electron App...")

    # Setup app lifecycle
    app.when_ready(on_ready)
    app.prevent_quit()  # Keep running as tray app

fn on_ready():
    print("App ready, creating tray...")

    # Create system tray
    tray = Tray.new("Hello Electron")
    tray!.set_icon("icon.png")
    tray!.set_tooltip("Hello from Simple!")

    # Setup menu
    update_menu()

    # Show welcome notification
    notification.show_info(
        "Hello Electron",
        "Simple Electron app is running!"
    )

fn update_menu():
    """Update tray context menu."""
    if tray == none:
        return

    let menu = [
        MenuItem.new("Hello from Simple!", none).set_enabled(false),
        MenuItem.new("Clicks: {click_count}", none).set_enabled(false),
        MenuSeparator.new(),
        MenuItem.new("Say Hello", on_hello),
        MenuItem.new("About", on_about),
        MenuSeparator.new(),
        MenuItem.new("Quit", on_quit)
    ]

    tray!.set_context_menu(menu)

# Event handlers

fn on_hello():
    """Handle hello menu item click."""
    click_count = click_count + 1
    print("Hello button clicked! Count: {click_count}")

    notification.show_info(
        "Hello!",
        "You clicked hello {click_count} times!"
    )

    update_menu()

fn on_about():
    """Handle about menu item click."""
    print("Showing about...")

    notification.show_info(
        "About Hello Electron",
        "A Simple language Electron app example.\nVersion: 1.0.0"
    )

fn on_quit():
    """Handle quit menu item click."""
    print("Quitting...")

    notification.show_info(
        "Goodbye!",
        "Hello Electron is closing..."
    )

    app.quit()
