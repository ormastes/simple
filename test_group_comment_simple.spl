# Simple test for group comment detection

use app.doc_coverage.analysis.group_comment_detection.{
    detect_variable_groups,
    suggest_group_comment,
    VariableGroup
}

fn main():
    print "=== Testing Variable Group Detection ==="

    # Test 1: Basic detection
    val source1 = "var count = 0\nvar total = 0\nvar sum = 0"
    val groups1 = detect_variable_groups("test.spl", source1)
    print "Test 1 - Groups found: {groups1.len()}"
    if groups1.len() > 0:
        val g = groups1[0]
        print "  Variables: {g.var_count}"
        print "  Names: {g.var_names[0]}, {g.var_names[1]}, {g.var_names[2]}"

    # Test 2: With comment
    val source2 = "# Counter variables\nvar count = 0\nvar total = 0"
    val groups2 = detect_variable_groups("test.spl", source2)
    print "\nTest 2 - Groups with comment:"
    if groups2.len() > 0:
        val g = groups2[0]
        print "  Has comment: {g.has_group_comment}"

    # Test 3: Constants suggestion
    val group_const = VariableGroup(
        file_path: "test.spl",
        start_line: 1,
        end_line: 3,
        var_names: ["MAX_SIZE", "MIN_SIZE", "DEFAULT_SIZE"],
        var_count: 3,
        has_group_comment: false,
        suggested_comment: ""
    )
    val suggestion1 = suggest_group_comment(group_const)
    print "\nTest 3 - Constants suggestion: {suggestion1}"

    # Test 4: Prefix suggestion
    val group_prefix = VariableGroup(
        file_path: "test.spl",
        start_line: 1,
        end_line: 3,
        var_names: ["config_name", "config_port", "config_host"],
        var_count: 3,
        has_group_comment: false,
        suggested_comment: ""
    )
    val suggestion2 = suggest_group_comment(group_prefix)
    print "Test 4 - Prefix suggestion: {suggestion2}"

    print "\n=== All tests completed ==="

main()
