# MCP Type Definitions

# Block mark types for MCP output
pub enum BlockMark:
    ClassCollapsed
    ClassExpanded
    FunctionCollapsed
    FunctionExpanded
    TraitCollapsed
    TraitExpanded
    PointcutCollapsed
    PointcutExpanded
    VirtualInfo

# Convert block mark to string representation
pub fn block_mark_to_string(mark: BlockMark) -> String:
    if mark == BlockMark.ClassCollapsed:
        return "C>"
    elif mark == BlockMark.ClassExpanded:
        return "C▼"
    elif mark == BlockMark.FunctionCollapsed:
        return "F>"
    elif mark == BlockMark.FunctionExpanded:
        return "F▼"
    elif mark == BlockMark.TraitCollapsed:
        return "T>"
    elif mark == BlockMark.TraitExpanded:
        return "T▼"
    elif mark == BlockMark.PointcutCollapsed:
        return "P>"
    elif mark == BlockMark.PointcutExpanded:
        return "P▼"
    elif mark == BlockMark.VirtualInfo:
        return "V•"
    else:
        return "??"

# Symbol visibility
pub enum Visibility:
    Public
    Private

# Symbol types
pub enum SymbolKind:
    Class
    Struct
    Function
    Method
    Trait
    Pointcut
    Variable

# Symbol information extracted from source
pub class Symbol:
    pub kind: SymbolKind
    pub name: String
    pub visibility: Visibility
    pub signature: String
    pub body: String
    pub line_start: i64
    pub line_end: i64
    pub is_collapsed: bool

    pub fn new(kind: SymbolKind, name: String, vis: Visibility) -> Symbol:
        return Symbol:
            kind: kind
            name: name
            visibility: vis
            signature: ""
            body: ""
            line_start: 0
            line_end: 0
            is_collapsed: true

# MCP output metadata
pub class McpMetadata:
    pub mode: String
    pub line_numbers: String
    pub show_coverage: bool
    pub show_block_guides: bool

    pub fn default() -> McpMetadata:
        return McpMetadata:
            mode: "mcp"
            line_numbers: "plain"
            show_coverage: false
            show_block_guides: false

# MCP output format
pub class McpOutput:
    pub text: String
    pub meta: Option<McpMetadata>

    pub fn new(text: String) -> McpOutput:
        return McpOutput:
            text: text
            meta: None

    pub fn with_metadata(text: String, meta: McpMetadata) -> McpOutput:
        return McpOutput:
            text: text
            meta: Some(meta)

# File context for MCP
pub class FileContext:
    pub path: String
    pub source: String
    pub symbols: List<Symbol>

    pub fn new(path: String, source: String) -> FileContext:
        return FileContext:
            path: path
            source: source
            symbols: []
