# GUI Theme Tests
#
# Tests for theme system: palettes, typography, spacing, border radius

use spec.*
use ui.gui.theme.*
use ui.attrs.*

describe "ThemePalette":
    describe "light()":
        it "creates light theme with correct primary color":
            val palette = ThemePalette::light()
            # Primary blue: 0x1976D2
            expect(palette.primary.to_rgba() & 0xFFFFFF).to_equal(0x1976D2)

        it "has white surface color":
            val palette = ThemePalette::light()
            # White: 0xFFFFFF
            expect(palette.surface.to_rgba() & 0xFFFFFF).to_equal(0xFFFFFF)

        it "has dark text for readability":
            val palette = ThemePalette::light()
            # Dark text: 0x212121
            expect(palette.text_primary.to_rgba() & 0xFFFFFF).to_equal(0x212121)

    describe "dark()":
        it "creates dark theme with lighter primary color":
            val palette = ThemePalette::dark()
            # Light blue for dark theme: 0x90CAF9
            expect(palette.primary.to_rgba() & 0xFFFFFF).to_equal(0x90CAF9)

        it "has dark surface color":
            val palette = ThemePalette::dark()
            # Dark surface: 0x1E1E1E
            expect(palette.surface.to_rgba() & 0xFFFFFF).to_equal(0x1E1E1E)

        it "has white text for contrast":
            val palette = ThemePalette::dark()
            # White text: 0xFFFFFF
            expect(palette.text_primary.to_rgba() & 0xFFFFFF).to_equal(0xFFFFFF)

    describe "high_contrast()":
        it "uses pure colors for accessibility":
            val palette = ThemePalette::high_contrast()
            # Pure blue: 0x0000FF
            expect(palette.primary.to_rgba() & 0xFFFFFF).to_equal(0x0000FF)
            # Pure black background
            expect(palette.background.to_rgba() & 0xFFFFFF).to_equal(0x000000)
            # Pure white text
            expect(palette.text_primary.to_rgba() & 0xFFFFFF).to_equal(0xFFFFFF)

describe "Typography":
    describe "default()":
        it "uses system font family":
            val typo = Typography::default()
            expect(typo.font_family).to_contain("system-ui")

        it "has base font size of 16px":
            val typo = Typography::default()
            expect(typo.font_size_base).to_equal(16)

        it "has normal line height of 1.5":
            val typo = Typography::default()
            expect(typo.line_height_normal).to_equal(1.5)

describe "Spacing":
    describe "default()":
        it "follows 4px base scale":
            val spacing = Spacing::default()
            expect(spacing.xs).to_equal(4)   # 1x
            expect(spacing.sm).to_equal(8)   # 2x
            expect(spacing.md).to_equal(16)  # 4x
            expect(spacing.lg).to_equal(24)  # 6x
            expect(spacing.xl).to_equal(32)  # 8x

describe "BorderRadius":
    describe "default()":
        it "provides range of radius values":
            val radius = BorderRadius::default()
            expect(radius.none).to_equal(0)
            expect(radius.sm).to_equal(2)
            expect(radius.md).to_equal(4)
            expect(radius.lg).to_equal(8)

        it "has full radius for circular elements":
            val radius = BorderRadius::default()
            expect(radius.full).to_equal(9999)

describe "Theme":
    describe "light()":
        it "creates complete light theme":
            val theme = Theme::light()
            expect(theme.name).to_equal("Light")

    describe "dark()":
        it "creates complete dark theme":
            val theme = Theme::dark()
            expect(theme.name).to_equal("Dark")

    describe "to_css_variables()":
        it "generates valid CSS custom properties":
            val theme = Theme::light()
            val css = theme.to_css_variables()
            expect(css).to_contain(":root")
            expect(css).to_contain("--color-primary")
            expect(css).to_contain("--font-family")
            expect(css).to_contain("--spacing-md")

describe "Shadow":
    describe "none()":
        it "creates zero shadow":
            val shadow = Shadow::none()
            expect(shadow.blur).to_equal(0)
            expect(shadow.spread).to_equal(0)

    describe "elevation levels":
        it "increases blur with elevation":
            val sm = Shadow::sm()
            val md = Shadow::md()
            val lg = Shadow::lg()
            expect(sm.blur < md.blur).to_be_true()
            expect(md.blur < lg.blur).to_be_true()
