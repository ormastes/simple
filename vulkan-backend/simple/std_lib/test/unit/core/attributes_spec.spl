# Attribute Tests
# Tests for compiler attributes: #[inline], #[derive], #[cfg], etc.

use spec.*

describe "#[inline] attribute":
    it "can be applied to functions":
        #[inline]
        fn fast_add(x: i64, y: i64) -> i64:
            return x + y

        result = fast_add(10, 20)
        expect(result).to_equal(30)

    it "can be applied to methods":
        class Calculator:
            #[inline]
            fn add(self, x: i64, y: i64) -> i64:
                return x + y

        calc = Calculator()
        result = calc.add(5, 7)
        expect(result).to_equal(12)

    it "works with small helper functions":
        #[inline]
        fn square(x: i64) -> i64:
            return x * x

        #[inline]
        fn double(x: i64) -> i64:
            return x * 2

        # These should be inlined by optimizer
        result = square(5) + double(10)
        expect(result).to_equal(45)


describe "#[cfg] attribute":
    it "supports conditional compilation":
        #[cfg(test)]
        fn test_only_function() -> i64:
            return 42

        # This function should exist in test builds
        result = test_only_function()
        expect(result).to_equal(42)


describe "#[allow] and #[deny] attributes":
    it "controls lint warnings":
        #[allow(unused_variable)]
        fn with_unused_var():
            unused = 42
            return 0

        result = with_unused_var()
        expect(result).to_equal(0)


describe "#[test] attribute":
    it "marks test functions":
        #[test]
        fn sample_test():
            expect(1 + 1).to_equal(2)

        # The test attribute marks this for test discovery
        sample_test()
