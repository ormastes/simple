# Quick test of doc coverage scanner
use app.io.{cwd, file_write}
use app.doc_coverage.scanner.{scan_file_for_docs, discover_source_files, filter_public_only}
use std.string.{NL}

fn main() -> i64:
    print "Testing doc coverage scanner..."

    # Test 1: Create a sample file
    val test_file = "{cwd()}/test_sample_doc.spl"
    val sample_code = "# This is a comment{NL}fn test_function(x: i64) -> i64:{NL}    x * 2{NL}{NL}# Another comment{NL}struct Point:{NL}    x: i64{NL}    y: i64{NL}"
    file_write(test_file, sample_code)

    # Test 2: Scan the file
    val items = scan_file_for_docs(test_file)
    print "Found {items.len()} doc items"

    for item in items:
        print "  {item.kind} '{item.name}' at line {item.line}, has_comment={item.has_comment}"

    # Test 3: Discover source files
    val root = cwd()
    val patterns: [text] = []
    val files = discover_source_files(root, patterns)
    print "Found {files.len()} total source files"

    # Test 4: Filter to public API only
    val public_files = filter_public_only(files)
    print "Found {public_files.len()} public API files"

    print "Scanner tests complete!"
    0
