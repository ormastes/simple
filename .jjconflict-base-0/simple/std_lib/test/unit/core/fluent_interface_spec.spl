# Fluent Interface (Functional Update Operator ->) Tests
# Tests for #1068 - Fluent interface support with method chaining

use spec.*

describe "Fluent Interface Support":
    it "concatenates arrays with ->":
        let mut arr = [1, 2]
        arr->concat([3, 4])
        expect arr.len() == 4
        expect arr[0] == 1
        expect arr[3] == 4

    it "maps array elements with ->":
        let mut arr = [1, 2, 3]
        arr->map(\x: x * 2)
        expect arr[0] == 2
        expect arr[1] == 4
        expect arr[2] == 6

    it "filters array elements with ->":
        let mut arr = [1, 2, 3, 4, 5]
        arr->filter(\x: x > 2)
        expect arr.len() == 3
        expect arr[0] == 3
        expect arr[1] == 4
        expect arr[2] == 5

    it "chains multiple operations":
        let mut arr = [1, 2, 3]
        arr->map(\x: x + 1)
        arr->filter(\x: x > 2)
        expect arr.len() == 2
        expect arr[0] == 3
        expect arr[1] == 4

    it "works with single chained expression":
        let mut arr = [1, 2, 3, 4, 5]
        arr->filter(\x: x > 2)->map(\x: x * 2)
        expect arr.len() == 3
        expect arr[0] == 6
        expect arr[1] == 8
        expect arr[2] == 10
