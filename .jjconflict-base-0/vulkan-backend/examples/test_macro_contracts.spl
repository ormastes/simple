# Test macro contract processing (#1303)
# This demonstrates macro-introduced symbols with automatic registration

# Test 1: Macro with intro contract for function introduction
macro gen_greeting(NAME: Str const) -> (
    intro greet:
        enclosing.module.fn "greet_{NAME}"() -> Nil
):
    const_eval:
        pass
    emit greet:
        fn "greet_{NAME}"():
            print "Hello, {NAME}!"

# Invoke the macro - this should register greet_World as a function
gen_greeting!("World")

# Call the macro-introduced function
# This verifies symbol registration works!
greet_World()

# Test 2: Macro with const-time unrolling
macro gen_axes(BASE: Str const, N: Int const) -> (
    intro axes:
        for i in 0..N:
            enclosing.module.fn "{BASE}{i}"(idx: Int) -> Int
):
    const_eval:
        pass
    emit axes:
        for i in 0..N:
            fn "{BASE}{i}"(idx: Int) -> Int:
                return idx + i

# Generate axis0, axis1, axis2 functions
gen_axes!("axis", 3)

# Call the generated functions
print axis0(10)  # Should print 10
print axis1(10)  # Should print 11
print axis2(10)  # Should print 12

print "Macro contract tests completed!"
