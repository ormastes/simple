# 60_memory_gc_unique_shared_weak_handle.spl - Pointer kinds

# Pointer kinds are explicit: T (GC), &T unique, *T shared, -T weak, +T handle

class Player:
    name: str
    hp: i32

# GC-managed (default)
let p: Player = Player(name: "Hero", hp: 100)
print "gc player hp={p.hp}"

# Unique owner
let u: &Player = new(&) Player(name: "Solo", hp: 50)
let v = move u
print "unique player hp={v.hp}"
# print u.hp  # should be compile error: moved

# Shared owner
let s1: *Player = new* Player(name: "Shared", hp: 75)
let s2 = s1  # refcount +1
print "shared player hp={s1.hp}"

# Weak pointer
let w: -Player = weak_of(s1)
let maybe_strong = w.upgrade()
match maybe_strong:
    case Some(sp):
        print "upgraded hp={sp.hp}"
    case None:
        print "expired"

# Handle pointer (resource-like; runtime-managed pool)
let h: +Player = new+ Player(name: "HandleGuy", hp: 1)
with handle_get(h) as view:
    print "handle view hp={view.hp}"

main = p.hp
