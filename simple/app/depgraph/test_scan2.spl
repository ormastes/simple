print("testing scanner")

extern fn native_fs_read_dir(path: String) -> Any
extern fn native_fs_exists(path: String) -> Bool

fn is_source_file(name: String) -> Bool:
    if not name.ends_with(".spl"):
        print("  {name} - not .spl")
        return false
    if name.starts_with("."):
        print("  {name} - starts with dot")
        return false
    if name == "__init__.spl":
        print("  {name} - is init")
        return false
    print("  {name} - IS SOURCE")
    return true

let r = native_fs_read_dir("simple/app/depgraph")
match r:
    case Err(e):
        print("Error: {e}")
    case Ok(dir_result):
        print("Success! Checking files:")
        for entry in dir_result.entries:
            let name = entry.name
            let check = is_source_file(name)
            print("Checked {name}: {check}")
print("done")
