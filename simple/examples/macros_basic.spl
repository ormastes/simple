# Basic Macro Examples - Verified Working
# Demonstrates core macro features that are currently implemented

# ==============================================================================
# BUILT-IN MACROS
# ==============================================================================

fn test_builtin():
    println!("Testing built-in macros")

    # Create array with vec!
    let numbers = vec!(1, 2, 3, 4, 5)

    # Assertions
    assert!(numbers.len() == 5)
    assert_eq!(numbers[0], 1)

    # Format string
    let msg = format!("Count: ", numbers.len())
    println!(msg)


# ==============================================================================
# USER-DEFINED MACROS
# ==============================================================================

# Simple macro
macro answer() -> (returns result: Int):
    emit result:
        42

# Macro with parameter
macro double(x: Int) -> (returns result: Int):
    emit result:
        x + x

# Macro with const parameter and template
macro greet(name: Str const) -> (returns result: Str):
    emit result:
        "Hello, {name}!"

# Const eval example
macro square(n: Int const) -> (returns result: Int):
    const_eval:
        const result = n * n

    emit result:
        result


fn test_user_macros():
    println!("Testing user-defined macros")

    let a = answer!()
    println!("answer! = ", a)
    assert_eq!(a, 42)

    let b = double!(21)
    println!("double!(21) = ", b)
    assert_eq!(b, 42)

    let c = greet!("World")
    println!("greet!(World) = ", c)

    let d = square!(5)
    println!("square!(5) = ", d)
    assert_eq!(d, 25)


# Main
fn main():
    println!("=== Macro System - Basic Examples ===\n")

    test_builtin()
    println!()

    test_user_macros()
    println!()

    println!("âœ… All tests passed!")
