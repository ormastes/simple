# Training Engine Example

import ml.engine

print("=" * 70)
print("ENGINE EXAMPLE")
print("=" * 70)

# Define a simple train step function
fn train_step(engine: any, batch: any) -> any:
    # Simulate training on a batch
    print(f"  Processing batch: {batch}")
    return {"loss": 0.5}

# Create engine
let trainer = engine.Engine(train_step)
print("\nEngine created successfully!")

# Create state
let state = engine.State()
print(f"\nState created!")
print(f"  Initial epoch: {state.epoch}")
print(f"  Initial iteration: {state.iteration}")

# Create metrics
let loss_metric = engine.Loss()
print(f"\nLoss metric created!")

let acc_metric = engine.Accuracy()
print(f"Accuracy metric created!")

print("\nNote: Full training loop requires FFI support (range, for loops)")
print("Engine module demonstrates class structure and initialization.")

print("\n" + "=" * 70)
print("Example completed!")
print("=" * 70)
