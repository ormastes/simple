# Experiment Tracking Example

import ml.tracking

print("=" * 70)
print("TRACKING EXAMPLE")
print("=" * 70)

# Set offline mode
tracking.set_mode("offline")
print("\nTracking mode: offline")

# Create a run
let my_run = tracking.run(
    project="mnist-example",
    name="baseline-run",
    config={"lr": 0.001, "batch_size": 64},
    tags=["baseline"]
)

print(f"\nRun created:")
print(f"  ID: {my_run.id}")
print(f"  Name: {my_run.name}")
print(f"  Project: {my_run.project}")

# Log some metrics
print("\nLogging metrics...")
let mut step = 0
while step < 5:
    let fake_loss = 2.0 - (step * 0.3)
    let fake_acc = 0.2 + (step * 0.15)

    my_run.log({"loss": fake_loss, "acc": fake_acc}, step)
    print(f"  Step {step}: loss={fake_loss}, acc={fake_acc}")
    step += 1

# Finish the run
my_run.finish()
print("\nRun finished!")

print("\n" + "=" * 70)
print("Example completed!")
print("=" * 70)
