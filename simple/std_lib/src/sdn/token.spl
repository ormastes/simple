///
Module: sdn.token

SDN token types for lexical analysis.

Provides:
- TokenKind: Token type enumeration
- Token: Token with kind, span, and lexeme
///

import error.Span

# Public exports
export TokenKind, Token

/// SDN token kinds
enum TokenKind:
    # Literals
    Integer(Int)
    Float(Float)
    String(String)
    Bool(Bool)
    Null

    # Identifiers
    Identifier(String)

    # Keywords
    Table

    # Operators and punctuation
    Colon        # :
    Equals       # =
    Pipe         # |
    Comma        # ,
    LBrace       # {
    RBrace       # }
    LBracket     # [
    RBracket     # ]
    LParen       # (
    RParen       # )

    # Whitespace-significant
    Newline
    Indent
    Dedent

    # End of file
    Eof

impl TokenKind:
    fn name(self) -> String:
        """Get the display name of this token kind"""
        match self:
            case Integer(_):
                return "integer"
            case Float(_):
                return "float"
            case String(_):
                return "string"
            case Bool(_):
                return "bool"
            case Null:
                return "null"
            case Identifier(_):
                return "identifier"
            case Table:
                return "table"
            case Colon:
                return ":"
            case Equals:
                return "="
            case Pipe:
                return "|"
            case Comma:
                return ","
            case LBrace:
                return "{"
            case RBrace:
                return "}"
            case LBracket:
                return "["
            case RBracket:
                return "]"
            case LParen:
                return "("
            case RParen:
                return ")"
            case Newline:
                return "newline"
            case Indent:
                return "INDENT"
            case Dedent:
                return "DEDENT"
            case Eof:
                return "EOF"

    fn to_string(self) -> String:
        return self.name()

/// SDN token with kind and source location
struct Token:
    kind: TokenKind
    span: Span
    lexeme: String

    fn new(kind: TokenKind, span: Span, lexeme: String) -> Token:
        return Token(
            kind: kind,
            span: span,
            lexeme: lexeme
        )

    fn to_string(self) -> String:
        return "${self.kind.name()} at ${self.span.to_string()}"
