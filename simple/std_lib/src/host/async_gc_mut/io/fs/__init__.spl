# File System API - Async file operations (GC Mutable Variant - DEFAULT)
#
# Comprehensive file I/O with mmap support and mold-inspired staging.
#
# This is the DEFAULT async GC variant - automatic memory management!
#
# Features:
# - Memory-mapped file I/O (zero-copy)
# - Async file handles with background loading
# - File staging for parallel processing
# - Context manager support (with...as syntax)
# - Semantic types (FilePath, DirPath, ByteCount)
# - GC-managed buffers (no manual cleanup needed!)
#
# Quick Start:
#   use host.async_gc_mut.io.fs as fs
#   # OR via top-level API:
#   use io.fs as fs  # Automatically gets this GC version
#
#   # Simple mmap (zero-copy read)
#   async with await fs.open_mmap("data.txt"_filepath) as mmap:
#       val content = mmap.as_str()?
#       # GC handles cleanup automatically!

# Import common types and FFI
use host.common.io.*

# Import from submodules
from mmap import {
    MmapRegion,
    open_mmap, open_mmap_with, open_mmap_sync, open_mmap_sync_with
}

from file import {
    File
}

from ops import {
    read, read_text, write, write_text, append, append_text,
    create_dir, create_dir_all, remove, remove_dir, remove_dir_all,
    rename, copy, copy_zero,
    exists, metadata, read_dir,
    read_sync, read_text_sync, write_sync, write_text_sync,
    exists_sync, metadata_sync
}

from process import {
    spawn_worker_with_staging, spawn_workers_with_staging, stage
}

from traits import {
    impl_file_traits
}

# Re-export common types
export MmapMode, MmapAdvice, StageMode, StagingStatus, StageState
export ProcessHandle, DirEntries
export ContextManager, AsyncContextManager, Exception

# Re-export module types
export MmapRegion
export open_mmap, open_mmap_with, open_mmap_sync, open_mmap_sync_with
export File
export read, read_text, write, write_text, append, append_text
export create_dir, create_dir_all, remove, remove_dir, remove_dir_all
export rename, copy, copy_zero
export exists, metadata, read_dir
export read_sync, read_text_sync, write_sync, write_text_sync
export exists_sync, metadata_sync
export spawn_worker_with_staging, spawn_workers_with_staging, stage
