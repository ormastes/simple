# Training Utilities (Simplified)
#
# Classes for tracking training progress and preventing overfitting.

export ParameterStats, ParameterTracker, EarlyStopping

class ParameterStats:
    """Statistics for a parameter."""
    name: str
    mean: f64
    std: f64
    norm: f64

    fn __init__(name: str, mean: f64, std: f64, norm: f64):
        self.name = name
        self.mean = mean
        self.std = std
        self.norm = norm


class ParameterTracker:
    """Track parameter and gradient statistics during training."""
    stats: any

    fn __init__():
        self.stats = []

    me add_stat(stat: ParameterStats):
        """Add a parameter stat."""
        self.stats = self.stats + [stat]

    fn print_summary():
        """Print summary of all tracked parameters."""
        for stat in self.stats:
            print("{stat.name}: mean={stat.mean:.4f}, std={stat.std:.4f}, norm={stat.norm:.4f}")


class EarlyStopping:
    """Early stopping to prevent overfitting."""
    patience: i64
    best_loss: f64
    counter: i64
    should_stop: bool

    fn __init__(patience: i64 = 5):
        self.patience = patience
        self.best_loss = 1e10
        self.counter = 0
        self.should_stop = false

    me check(loss: f64) -> bool:
        """Check if training should stop.

        Returns true if training should continue, false to stop.
        """
        if loss < self.best_loss:
            self.best_loss = loss
            self.counter = 0
            return true

        self.counter = self.counter + 1
        if self.counter >= self.patience:
            self.should_stop = true
            return false

        return true
