# Device Management for PyTorch
#
# Device enumeration and CUDA availability functions.

export Device, device_code
# Temporary: Commented out cuda functions while debugging
# export cuda_available, cuda_device_count


# ============================================================================
# Device Enum
# ============================================================================

enum Device:
    CPU
    CUDA(i32)

# Device helper functions
fn device_code(device: Device) -> i32:
    """Convert device to FFI device code.

    Args:
        device: Device enum instance

    Returns:
        Device code (0=CPU, 1=CUDA:0, 2=CUDA:1, ...)
    """
    match device:
        Device::CPU -> 0
        Device::CUDA(id) -> id + 1


# ============================================================================
# CUDA Functions
# ============================================================================

# fn cuda_available() -> bool:
#     """Check if CUDA is available.
#
#     Returns:
#         True if CUDA is available, False otherwise
#     """
#     let result = @rt_torch_cuda_available()
#     return result != 0


# fn cuda_device_count() -> i32:
#     """Get number of CUDA devices.
#
#     Returns:
#         Number of CUDA devices (0 if CUDA not available)
#     """
#     return @rt_torch_cuda_device_count()


# ============================================================================
# External FFI Functions
# ============================================================================

# Temporary: Commented out while debugging
# extern fn rt_torch_cuda_available() -> i32
# extern fn rt_torch_cuda_device_count() -> i32
