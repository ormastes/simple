# File System API - Top-level module with variant selection
#
# This is the main file system API that users import.
# It automatically selects the right variant based on module context.
#
# DEFAULT: Async GC variant (host.async_gc_mut.io.fs)
#
# Quick Start:
#   use io.fs as fs
#
#   # Simple mmap (zero-copy read)
#   async with await fs.open_mmap("data.txt"_filepath) as mmap:
#       let content = mmap.as_str()?
#
#   # Full file operations
#   let content = await fs.read_text("config.toml"_filepath)?
#   await fs.write_text("output.txt"_filepath, "Hello!"_text)?
#
#   # Context manager (with...as syntax sugar)
#   async with await File::open_read("data.bin"_filepath) as file:
#       let buffer = Bytes::with_capacity(4096)
#       let n = await file.read(&mut buffer)?
#
# Variant Selection:
#   The fs module uses #[variant(...)] to select the implementation:
#   - Default/GC: host.async_gc_mut.io.fs (automatic memory)
#   - NoGC (#[no_gc]): host.async_nogc_mut.io.fs (manual memory)
#   - Bare metal: bare.io.minimal (embedded systems)

# Variant selection - automatically picks based on module context
#[variant(default: "host.async_gc_mut.io.fs")]
#[variant(nogc: "host.async_nogc_mut.io.fs")]
#[variant(bare: "bare.io.minimal")]
pub use variant::*

# Re-export all public APIs from selected variant
pub use {
    # Memory-mapped file types
    MmapRegion, MmapMode, MmapAdvice,

    # Simple mmap convenience functions
    open_mmap, open_mmap_with,
    open_mmap_sync, open_mmap_sync_with,

    # File operations
    read, read_text,
    write, write_text,
    append, append_text,

    # Directory operations
    create_dir, create_dir_all,
    remove, remove_dir, remove_dir_all,
    rename, copy, copy_zero,

    # Metadata
    exists, metadata,
    read_dir, DirEntries,

    # File staging (mold-inspired)
    stage,
    spawn_worker_with_staging,
    spawn_workers_with_staging,

    # File handle
    File, StageMode, StagingStatus, StageState,
    ProcessHandle,

    # Context manager support
    ContextManager, AsyncContextManager,
    Exception,

    # Types (from units and common)
    # Note: These are re-exported from the variant modules
}

# Note: Context manager implementations are provided by the variant modules
# Usage:
#   with open_mmap_sync("data.txt"_filepath) as mmap:
#   async with await open_mmap("data.txt"_filepath) as mmap:
#   async with await File::open_read("data.bin"_filepath) as file:
