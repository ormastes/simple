# Godot GDExtension FFI Declarations
#
# Low-level FFI bindings to Godot's C API
# These are the raw C function declarations that will be
# implemented in the Rust runtime
#
# Reference: extension_api.json from Godot 4.3+

# Opaque pointer types for Godot objects
pub type GDExtensionObjectPtr = u64
pub type GDExtensionClassInstancePtr = u64
pub type GDExtensionMethodBindPtr = u64
pub type GDExtensionScriptInstancePtr = u64

# Variant type (Godot's universal value type)
pub type GDExtensionVariantPtr = u64

# text types
pub type GDExtensionStringPtr = u64
pub type GDExtensionStringNamePtr = u64

# GDExtension initialization
extern "C" fn godot_gdextension_init(
    p_get_proc_address: u64,
    p_library: u64,
    r_initialization: u64
) -> u8

# Variant operations
extern "C" fn godot_variant_new_copy(dst: GDExtensionVariantPtr, src: GDExtensionVariantPtr)
extern "C" fn godot_variant_new_nil(dst: GDExtensionVariantPtr)
extern "C" fn godot_variant_destroy(ptr: GDExtensionVariantPtr)

# Variant type conversions
extern "C" fn godot_variant_new_bool(dst: GDExtensionVariantPtr, value: bool)
extern "C" fn godot_variant_new_int(dst: GDExtensionVariantPtr, value: i64)
extern "C" fn godot_variant_new_float(dst: GDExtensionVariantPtr, value: f64)
extern "C" fn godot_variant_new_string(dst: GDExtensionVariantPtr, value: GDExtensionStringPtr)
extern "C" fn godot_variant_new_object(dst: GDExtensionVariantPtr, value: GDExtensionObjectPtr)

extern "C" fn godot_variant_as_bool(ptr: GDExtensionVariantPtr) -> bool
extern "C" fn godot_variant_as_int(ptr: GDExtensionVariantPtr) -> i64
extern "C" fn godot_variant_as_float(ptr: GDExtensionVariantPtr) -> f64
extern "C" fn godot_variant_as_string(ptr: GDExtensionVariantPtr) -> GDExtensionStringPtr
extern "C" fn godot_variant_as_object(ptr: GDExtensionVariantPtr) -> GDExtensionObjectPtr

# text operations
extern "C" fn godot_string_new(dst: GDExtensionStringPtr)
extern "C" fn godot_string_new_with_utf8_chars(dst: GDExtensionStringPtr, contents: *const u8, size: i64)
extern "C" fn godot_string_to_utf8_chars(ptr: GDExtensionStringPtr, r_text: *mut u8, max_len: i64) -> i64
extern "C" fn godot_string_destroy(ptr: GDExtensionStringPtr)

# StringName operations
extern "C" fn godot_string_name_new_with_utf8_chars(dst: GDExtensionStringNamePtr, contents: *const u8, size: i64)
extern "C" fn godot_string_name_destroy(ptr: GDExtensionStringNamePtr)

# Object operations
extern "C" fn godot_object_method_bind_call(
    method_bind: GDExtensionMethodBindPtr,
    instance: GDExtensionObjectPtr,
    args: *const GDExtensionVariantPtr,
    arg_count: i64,
    ret: GDExtensionVariantPtr,
    error: *mut i32
)

extern "C" fn godot_object_get_instance_binding(
    object: GDExtensionObjectPtr,
    token: u64,
    callbacks: u64
) -> u64

extern "C" fn godot_object_set_instance_binding(
    object: GDExtensionObjectPtr,
    token: u64,
    binding: u64,
    callbacks: u64
)

extern "C" fn godot_object_destroy(ptr: GDExtensionObjectPtr)

# Method binding
extern "C" fn godot_classdb_get_method_bind(
    class_name: GDExtensionStringNamePtr,
    method_name: GDExtensionStringNamePtr,
    hash: i64
) -> GDExtensionMethodBindPtr

# Class registration
extern "C" fn godot_classdb_register_extension_class(
    library: u64,
    class_name: GDExtensionStringNamePtr,
    parent_class_name: GDExtensionStringNamePtr,
    extension_funcs: u64
) -> bool

extern "C" fn godot_classdb_register_extension_class_method(
    library: u64,
    class_name: GDExtensionStringNamePtr,
    method_info: u64
)

extern "C" fn godot_classdb_register_extension_class_property(
    library: u64,
    class_name: GDExtensionStringNamePtr,
    property_info: u64,
    setter: GDExtensionStringNamePtr,
    getter: GDExtensionStringNamePtr
)

# Signal operations
extern "C" fn godot_object_emit_signal(
    instance: GDExtensionObjectPtr,
    signal_name: GDExtensionStringNamePtr,
    args: *const GDExtensionVariantPtr,
    arg_count: i64
)

extern "C" fn godot_signal_connect(
    instance: GDExtensionObjectPtr,
    signal_name: GDExtensionStringNamePtr,
    target: GDExtensionObjectPtr,
    method_name: GDExtensionStringNamePtr,
    flags: i32
) -> i32

extern "C" fn godot_signal_disconnect(
    instance: GDExtensionObjectPtr,
    signal_name: GDExtensionStringNamePtr,
    target: GDExtensionObjectPtr,
    method_name: GDExtensionStringNamePtr
)

# Utility functions
extern "C" fn godot_get_class_constructor(class_name: GDExtensionStringNamePtr) -> u64
extern "C" fn godot_print_warning(message: *const u8, function: *const u8, file: *const u8, line: i32)
extern "C" fn godot_print_error(message: *const u8, function: *const u8, file: *const u8, line: i32)

# Vector2/Vector3 operations (for position/rotation)
extern "C" fn godot_variant_new_vector2(dst: GDExtensionVariantPtr, x: f64, y: f64)
extern "C" fn godot_variant_new_vector3(dst: GDExtensionVariantPtr, x: f64, y: f64, z: f64)
extern "C" fn godot_variant_as_vector2(ptr: GDExtensionVariantPtr, out_x: *mut f64, out_y: *mut f64)
extern "C" fn godot_variant_as_vector3(ptr: GDExtensionVariantPtr, out_x: *mut f64, out_y: *mut f64, out_z: *mut f64)

# Color operations
extern "C" fn godot_variant_new_color(dst: GDExtensionVariantPtr, r: f32, g: f32, b: f32, a: f32)

# Array/Dictionary operations
extern "C" fn godot_variant_new_array(dst: GDExtensionVariantPtr)
extern "C" fn godot_variant_new_dictionary(dst: GDExtensionVariantPtr)

# Vector2i operations (integer vectors)
extern "C" fn godot_variant_new_vector2i(dst: GDExtensionVariantPtr, x: i32, y: i32)
extern "C" fn godot_variant_as_vector2i(ptr: GDExtensionVariantPtr, out_x: *mut i32, out_y: *mut i32)

# RID operations
extern "C" fn godot_variant_as_rid(ptr: GDExtensionVariantPtr) -> u64

# Packed array operations
extern "C" fn godot_variant_as_packed_int32_array(ptr: GDExtensionVariantPtr, out_length: *mut i32) -> *const i32
extern "C" fn godot_variant_as_packed_string_array(ptr: GDExtensionVariantPtr, out_length: *mut i32) -> *const GDExtensionStringPtr
