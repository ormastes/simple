# PTY (Pseudo-Terminal) System Library
#
# Provides low-level PTY operations for terminal I/O testing.

# FFI declarations
extern fn native_pty_openpty()
extern fn native_pty_write(fd: int, data: str) -> bool
extern fn native_pty_read(fd: int, timeout_ms: int) -> str
extern fn native_pty_close(fd: int) -> bool

def openpty():
    """
    Open a new pseudo-terminal pair.

    Returns:
        (master_fd, slave_fd) - File descriptors for master and slave ends
    """
    return native_pty_openpty()

def write(fd: int, data: str) -> bool:
    """
    Write data to a PTY file descriptor.

    Args:
        fd: File descriptor
        data: Data to write

    Returns:
        True on success, False on failure
    """
    return native_pty_write(fd, data)

def read(fd: int, timeout_ms: int = 1000) -> str:
    """
    Read data from a PTY file descriptor with timeout.

    Args:
        fd: File descriptor
        timeout_ms: Timeout in milliseconds (default: 1000)

    Returns:
        String of data read, or empty string on timeout
    """
    return native_pty_read(fd, timeout_ms)

def close(fd: int) -> bool:
    """
    Close a PTY file descriptor.

    Args:
        fd: File descriptor to close

    Returns:
        True on success, False on failure
    """
    return native_pty_close(fd)
