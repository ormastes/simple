# ============================================================================
# Typed Tensor Dimension Inference - Examples
# ============================================================================
#
# Demonstrates compile-time dimension tracking and shape inference for tensors.
# Shows practical usage patterns for neural network development.
#
# Features:
# - Exact dimension specifications
# - Named dimensions with range constraints
# - Automatic shape inference through operations
# - Memory estimation
# - Runtime verification
#
# ============================================================================

import ml.torch.typed_tensor.{TypedTensor, DimSpec}
import ml.torch.dtype.{DType}
import ml.torch.device.{Device}

# ============================================================================
# Example 1: Basic Dimension Tracking
# ============================================================================

fn example_basic_dimensions():
    print("============================================================")
    print("Example 1: Basic Dimension Tracking")
    print("============================================================")

    # Create a tensor with exact dimensions
    val input = TypedTensor.randn([
        DimSpec.exact(32),   # Batch size
        DimSpec.exact(784)   # Input features (28x28 flattened)
    ], DType.Float32, Device.CPU)

    val shape = input.shape()
    val ndim = input.ndim()
    print(f"Input shape: {shape}")
    print(f"Number of dimensions: {ndim}")
    print("Tensor created successfully!")
    print("")

# ============================================================================
# Example 2: Named Dimensions with Ranges
# ============================================================================

fn example_named_dimensions():
    print("============================================================")
    print("Example 2: Named Dimensions with Ranges")
    print("============================================================")

    # Create tensor with named batch dimension that can vary
    val batch_input = TypedTensor.randn([
        DimSpec.ranged("batch", 16, 1, 64),  # Batch: 16, range [1, 64]
        DimSpec.exact(128)                    # Feature dimension
    ], DType.Float32, Device.CPU)

    val batch_shape = batch_input.shape()
    print(f"Batch input shape: {batch_shape}")
    print("Batch dimension info: ranged 'batch' = 16, allowed [1, 64]")
    print("")

# ============================================================================
# Main Entry Point
# ============================================================================

fn main():
    print("")
    print("TypedTensor Dimension Inference Examples")
    print("============================================================")
    print("")

    # Run examples
    example_basic_dimensions()
    example_named_dimensions()

    print("============================================================")
    print("Examples completed!")
    print("")

main()
