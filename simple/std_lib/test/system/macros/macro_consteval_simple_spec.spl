# Test for const-eval engine - simplified working version

# Arithmetic in const-eval
macro compute(a: Int const, b: Int const) -> (returns result: Int):
    const_eval:
        let sum = a + b
        let product = a * b
        let combined = sum + product
    emit result:
        combined

# Conditionals - using if/else with initial value
macro max_value(a: Int const, b: Int const) -> (returns result: Int):
    const_eval:
        let max_val = a
        if b > a:
            max_val = b
    emit result:
        max_val

# Loops
macro sum_range(n: Int const) -> (returns result: Int):
    const_eval:
        let total = 0
        for i in 0..n:
            total = total + i
    emit result:
        total

# String operations
macro concat(a: Str const, b: Str const) -> (returns result: Str):
    const_eval:
        let combined = a + " " + b
    emit result:
        "{combined}"

describe "Const-Eval Engine":
    describe "Arithmetic":
        it "evaluates expressions":
            expect compute!(3, 4) == 19
            expect compute!(0, 5) == 5

    describe "Conditionals":
        it "evaluates max":
            expect max_value!(10, 5) == 10
            expect max_value!(3, 7) == 7

    describe "Loops":
        it "sums ranges":
            expect sum_range!(0) == 0
            expect sum_range!(5) == 10

    describe "Strings":
        it "concatenates":
            expect concat!("Hello", "World") == "Hello World"
