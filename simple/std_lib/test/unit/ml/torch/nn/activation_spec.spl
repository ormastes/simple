# ML Neural Network Activation Functions Tests

import ml.torch as torch
import ml.torch.nn as nn

describe "Neural Network Activations":
    describe "ReLU":
        it "applies ReLU activation":
            let x = torch.randn([10, 10])
            let out = nn.relu(x)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "GELU":
        it "applies GELU activation":
            let x = torch.randn([10, 10])
            let out = nn.gelu(x)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "SiLU":
        it "applies SiLU activation":
            let x = torch.randn([10, 10])
            let out = nn.silu(x)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "Mish":
        it "applies Mish activation":
            let x = torch.randn([10, 10])
            let out = nn.mish(x)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "ELU":
        it "applies ELU activation":
            let x = torch.randn([10, 10])
            let out = nn.elu(x, alpha=1.0)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "Softplus":
        it "applies Softplus activation":
            let x = torch.randn([10, 10])
            let out = nn.softplus(x, beta=1.0, threshold=20.0)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "LeakyReLU":
        it "applies LeakyReLU activation":
            let x = torch.randn([10, 10])
            let out = nn.leaky_relu(x, negative_slope=0.01)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "Tanh":
        it "applies Tanh activation":
            let x = torch.randn([10, 10])
            let out = nn.tanh(x)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10

    describe "Sigmoid":
        it "applies Sigmoid activation":
            let x = torch.randn([10, 10])
            let out = nn.sigmoid(x)
            let shape = out.shape()
            expect shape[0] == 10
            expect shape[1] == 10
