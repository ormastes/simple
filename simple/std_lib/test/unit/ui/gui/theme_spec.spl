# GUI Theme Tests
#
# Tests for theme system: palettes, typography, spacing, border radius

use spec.*
use ui.gui.theme.*
use ui.attrs.*

describe "ThemePalette":
    describe "light()":
        it "creates light theme with correct primary color":
            let palette = ThemePalette::light()
            # Primary blue: 0x1976D2
            expect(palette.primary.to_rgba() & 0xFFFFFF).to(equal(0x1976D2))

        it "has white surface color":
            let palette = ThemePalette::light()
            # White: 0xFFFFFF
            expect(palette.surface.to_rgba() & 0xFFFFFF).to(equal(0xFFFFFF))

        it "has dark text for readability":
            let palette = ThemePalette::light()
            # Dark text: 0x212121
            expect(palette.text_primary.to_rgba() & 0xFFFFFF).to(equal(0x212121))

    describe "dark()":
        it "creates dark theme with lighter primary color":
            let palette = ThemePalette::dark()
            # Light blue for dark theme: 0x90CAF9
            expect(palette.primary.to_rgba() & 0xFFFFFF).to(equal(0x90CAF9))

        it "has dark surface color":
            let palette = ThemePalette::dark()
            # Dark surface: 0x1E1E1E
            expect(palette.surface.to_rgba() & 0xFFFFFF).to(equal(0x1E1E1E))

        it "has white text for contrast":
            let palette = ThemePalette::dark()
            # White text: 0xFFFFFF
            expect(palette.text_primary.to_rgba() & 0xFFFFFF).to(equal(0xFFFFFF))

    describe "high_contrast()":
        it "uses pure colors for accessibility":
            let palette = ThemePalette::high_contrast()
            # Pure blue: 0x0000FF
            expect(palette.primary.to_rgba() & 0xFFFFFF).to(equal(0x0000FF))
            # Pure black background
            expect(palette.background.to_rgba() & 0xFFFFFF).to(equal(0x000000))
            # Pure white text
            expect(palette.text_primary.to_rgba() & 0xFFFFFF).to(equal(0xFFFFFF))

describe "Typography":
    describe "default()":
        it "uses system font family":
            let typo = Typography::default()
            expect(typo.font_family).to_contain("system-ui")

        it "has base font size of 16px":
            let typo = Typography::default()
            expect(typo.font_size_base).to(equal(16))

        it "has normal line height of 1.5":
            let typo = Typography::default()
            expect(typo.line_height_normal).to(equal(1.5))

describe "Spacing":
    describe "default()":
        it "follows 4px base scale":
            let spacing = Spacing::default()
            expect(spacing.xs).to(equal(4)   # 1x)
            expect(spacing.sm).to(equal(8)   # 2x)
            expect(spacing.md).to(equal(16)  # 4x)
            expect(spacing.lg).to(equal(24)  # 6x)
            expect(spacing.xl).to(equal(32)  # 8x)

describe "BorderRadius":
    describe "default()":
        it "provides range of radius values":
            let radius = BorderRadius::default()
            expect(radius.none).to(equal(0))
            expect(radius.sm).to(equal(2))
            expect(radius.md).to(equal(4))
            expect(radius.lg).to(equal(8))

        it "has full radius for circular elements":
            let radius = BorderRadius::default()
            expect(radius.full).to(equal(9999))

describe "Theme":
    describe "light()":
        it "creates complete light theme":
            let theme = Theme::light()
            expect(theme.name).to(equal("Light"))

    describe "dark()":
        it "creates complete dark theme":
            let theme = Theme::dark()
            expect(theme.name).to(equal("Dark"))

    describe "to_css_variables()":
        it "generates valid CSS custom properties":
            let theme = Theme::light()
            let css = theme.to_css_variables()
            expect(css).to_contain(":root")
            expect(css).to_contain("--color-primary")
            expect(css).to_contain("--font-family")
            expect(css).to_contain("--spacing-md")

describe "Shadow":
    describe "none()":
        it "creates zero shadow":
            let shadow = Shadow::none()
            expect(shadow.blur).to(equal(0))
            expect(shadow.spread).to(equal(0))

    describe "elevation levels":
        it "increases blur with elevation":
            let sm = Shadow::sm()
            let md = Shadow::md()
            let lg = Shadow::lg()
            expect(sm.blur < md.blur).to_be_true()
            expect(md.blur < lg.blur).to_be_true()
