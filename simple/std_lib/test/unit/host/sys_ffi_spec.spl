# System FFI Specification
# Tests for system operations using FFI functions

import spec.{describe, context, it, expect}
import host.async_nogc_mut.sys.{Args, stdout}

describe("System FFI Functions"):
    context("command line arguments"):
        it("should get arguments list"):
            let args = Args.get_args()

            # Should at least have the program name
            expect(args.len()).to_be_greater_than_or_equal(1)

            # First argument should be program name
            let program = args[0]
            expect(program).to_not_equal("")

    context("standard output"):
        it("should write to stdout"):
            match stdout.write("Test output\n"):
                case Ok(count):
                    # Should write some bytes
                    expect(count).to_be_greater_than(0)
                case Err(e):
                    fail("Expected Ok, got Err: {e}")

        it("should flush stdout"):
            match stdout.flush():
                case Ok(_):
                    pass  # Success
                case Err(e):
                    fail("Expected Ok, got Err: {e}")
