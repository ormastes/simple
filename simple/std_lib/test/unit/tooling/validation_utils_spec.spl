# Tests for validation utilities

use tooling.validation_utils.*

# =====================================
# Email Validation Tests
# =====================================

fn test_valid_emails():
    assert(is_valid_email("user@example.com"))
    assert(is_valid_email("john.doe@company.co.uk"))
    assert(is_valid_email("test+tag@gmail.com"))
    assert(is_valid_email("name_123@domain.org"))

fn test_invalid_emails():
    assert(not is_valid_email(""))
    assert(not is_valid_email("no-at-sign"))
    assert(not is_valid_email("@no-local.com"))
    assert(not is_valid_email("no-domain@"))
    assert(not is_valid_email("double@@domain.com"))
    assert(not is_valid_email("spaces in@email.com"))

# =====================================
# URL Validation Tests
# =====================================

fn test_valid_urls():
    assert(is_valid_url("http://example.com"))
    assert(is_valid_url("https://www.google.com"))
    assert(is_valid_url("https://example.com/path/to/page"))
    assert(is_valid_url("http://localhost:8080"))

fn test_invalid_urls():
    assert(not is_valid_url(""))
    assert(not is_valid_url("not a url"))
    assert(not is_valid_url("ftp://example.com"))  # Not http/https
    assert(not is_valid_url("http://"))
    assert(not is_valid_url("https://"))

# =====================================
# UUID Validation Tests
# =====================================

fn test_valid_uuids():
    assert(is_uuid("550e8400-e29b-41d4-a716-446655440000"))
    assert(is_uuid("6ba7b810-9dad-11d1-80b4-00c04fd430c8"))
    assert(is_uuid("00000000-0000-0000-0000-000000000000"))

fn test_invalid_uuids():
    assert(not is_uuid(""))
    assert(not is_uuid("not-a-uuid"))
    assert(not is_uuid("550e8400-e29b-41d4-a716"))  # Too short
    assert(not is_uuid("550e8400-e29b-41d4-a716-446655440000-extra"))  # Too long
    assert(not is_uuid("550e8400e29b41d4a716446655440000"))  # No dashes

# =====================================
# IPv4 Validation Tests
# =====================================

fn test_valid_ipv4():
    assert(is_ipv4("127.0.0.1"))
    assert(is_ipv4("192.168.1.1"))
    assert(is_ipv4("10.0.0.0"))
    assert(is_ipv4("255.255.255.255"))

fn test_invalid_ipv4():
    assert(not is_ipv4(""))
    assert(not is_ipv4("256.1.1.1"))  # Out of range
    assert(not is_ipv4("1.1.1"))  # Too few octets
    assert(not is_ipv4("1.1.1.1.1"))  # Too many octets
    assert(not is_ipv4("abc.def.ghi.jkl"))  # Not numbers

# =====================================
# Integer/Float Validation Tests
# =====================================

fn test_is_integer():
    assert(is_integer("123"))
    assert(is_integer("-456"))
    assert(is_integer("0"))
    assert(not is_integer(""))
    assert(not is_integer("12.34"))
    assert(not is_integer("abc"))
    assert(not is_integer("12a"))

fn test_is_float():
    assert(is_float("123.456"))
    assert(is_float("-78.9"))
    assert(is_float("0.0"))
    assert(is_float("123"))  # Integers are valid floats
    assert(not is_float(""))
    assert(not is_float("abc"))
    assert(not is_float("12.34.56"))

# =====================================
# Hex Validation Tests
# =====================================

fn test_is_hex():
    assert(is_hex("0123456789"))
    assert(is_hex("abcdef"))
    assert(is_hex("ABCDEF"))
    assert(is_hex("0xDEADBEEF"))
    assert(not is_hex(""))
    assert(not is_hex("xyz"))
    assert(not is_hex("12gh"))

# =====================================
# Identifier Validation Tests
# =====================================

fn test_is_identifier():
    assert(is_identifier("variable_name"))
    assert(is_identifier("CamelCase"))
    assert(is_identifier("snake_case_123"))
    assert(is_identifier("_private"))
    assert(not is_identifier(""))
    assert(not is_identifier("123start"))  # Can't start with digit
    assert(not is_identifier("has-dash"))
    assert(not is_identifier("has space"))

# =====================================
# Alpha/Alphanumeric Tests
# =====================================

fn test_is_alpha():
    assert(is_alpha("abc"))
    assert(is_alpha("XYZ"))
    assert(is_alpha("aBcDeF"))
    assert(not is_alpha(""))
    assert(not is_alpha("abc123"))
    assert(not is_alpha("123"))
    assert(not is_alpha("abc def"))

fn test_is_alphanumeric():
    assert(is_alphanumeric("abc123"))
    assert(is_alphanumeric("XYZ789"))
    assert(is_alphanumeric("Test123"))
    assert(not is_alphanumeric(""))
    assert(not is_alphanumeric("abc-123"))
    assert(not is_alphanumeric("test test"))

# =====================================
# Length Validation Tests
# =====================================

fn test_has_min_length():
    assert(has_min_length("hello", 3))
    assert(has_min_length("hello", 5))
    assert(not has_min_length("hi", 5))

fn test_has_max_length():
    assert(has_max_length("hello", 10))
    assert(has_max_length("hello", 5))
    assert(not has_max_length("hello", 3))

fn test_has_length_between():
    assert(has_length_between("hello", 3, 10))
    assert(has_length_between("hello", 5, 5))
    assert(not has_length_between("hi", 5, 10))
    assert(not has_length_between("very long string", 3, 10))

# =====================================
# Content Validation Tests
# =====================================

fn test_starts_with():
    assert(starts_with("hello world", "hello"))
    assert(starts_with("test", "t"))
    assert(not starts_with("hello", "world"))

fn test_ends_with():
    assert(ends_with("hello world", "world"))
    assert(ends_with("test", "t"))
    assert(not ends_with("hello", "test"))

fn test_contains_substring():
    assert(contains_substring("hello world", "lo wo"))
    assert(contains_substring("test", "es"))
    assert(not contains_substring("hello", "xyz"))

# =====================================
# Wildcard Matching Tests
# =====================================

fn test_simple_match():
    assert(simple_match("hello", "hello"))
    assert(simple_match("hello world", "hello*"))
    assert(simple_match("test.txt", "*.txt"))
    assert(simple_match("file.test.txt", "*test*"))
    assert(not simple_match("hello", "world"))
    assert(not simple_match("file.pdf", "*.txt"))

# =====================================
# Path Validation Tests
# =====================================

fn test_is_absolute_path():
    # Unix paths
    assert(is_absolute_path("/home/user/file.txt"))
    assert(is_absolute_path("/"))
    # Windows paths
    assert(is_absolute_path("C:\\Users\\user\\file.txt"))
    assert(is_absolute_path("D:\\"))

    assert(not is_absolute_path(""))
    assert(not is_absolute_path("relative/path"))
    assert(not is_absolute_path("file.txt"))

fn test_is_relative_path():
    assert(is_relative_path("relative/path"))
    assert(is_relative_path("file.txt"))
    assert(is_relative_path("./current"))
    assert(is_relative_path("../parent"))

    assert(not is_relative_path(""))
    assert(not is_relative_path("/absolute/path"))
    assert(not is_relative_path("C:\\Windows\\Path"))
