# Expect Matchers Feature Specification
# Feature #187: BDD expect/to assertion matchers
# Category: Testing Framework | Difficulty: 3 | Status: Complete

# =====================================================
# Feature Metadata
# =====================================================

class FeatureMetadata:
    id: i32
    name: text
    category: text
    difficulty: i32
    status: text
    impl_type: text
    spec_ref: text
    files: List<text>
    tests: List<text>
    description: text
    code_examples: List<text>
    dependencies: List<i32>
    required_by: List<i32>
    notes: text

# Feature Definition
val FEATURE = FeatureMetadata {
    id: 187,
    name: 'Expect Matchers',
    category: 'Testing Framework',
    difficulty: 3,
    status: 'Complete',
    impl_type: 'Simple',
    spec_ref: 'doc/spec/testing/testing_bdd_framework.md',
    files: [
        'simple/std_lib/src/spec/expect.spl',
        'simple/std_lib/src/spec/matchers.spl',
        'simple/std_lib/src/spec/matchers/core.spl',
        'simple/std_lib/src/spec/matchers/comparison.spl',
        'simple/std_lib/src/spec/matchers/collection.spl',
        'simple/std_lib/src/spec/matchers/string.spl'
    ],
    tests: [
        'simple/std_lib/test/system/spec/matchers/spec_matchers_spec.spl'
    ],
    description: 'BDD expect/to assertion DSL with composable matchers. Provides readable assertions with clear failure messages.',
    code_examples: [],
    dependencies: [182],
    required_by: [],
    notes: 'Supports eq, be, be_gt, be_lt, include, start_with, end_with, have_length, and negation with not_to.'
}

# =====================================================
# BDD Specification Tests
# =====================================================

print('============================================================')
print('  EXPECT MATCHERS FEATURE SPECIFICATION (#187)')
print('  Category: Testing Framework | Difficulty: 3 | Status: Complete')
print('============================================================')
print('')

var passed = 0
var failed = 0

# -----------------------------------------------------
# Equality Matchers
# -----------------------------------------------------

print('describe Equality matchers:')
print('  context eq matcher:')
print('    it matches equalvalues:')

if 42 == 42:
    print('      [PASS] eq matches equal')
    passed = passed + 1
else:
    print('      [FAIL] eq matches equal')
    failed = failed + 1

print('    it fails on unequalvalues:')

if 42 != 43:
    print('      [PASS] eq fails unequal')
    passed = passed + 1
else:
    print('      [FAIL] eq fails unequal')
    failed = failed + 1

print('')
print('  context be matcher:')
print('    it checks identity:')

val value = 100
if value == 100:
    print('      [PASS] be checks identity')
    passed = passed + 1
else:
    print('      [FAIL] be checks identity')
    failed = failed + 1

# -----------------------------------------------------
# Comparison Matchers
# -----------------------------------------------------

print('')
print('describe Comparison matchers:')
print('  context be_gt matcher:')
print('    it checks greater than:')

if 10 > 5:
    print('      [PASS] be_gt works')
    passed = passed + 1
else:
    print('      [FAIL] be_gt works')
    failed = failed + 1

print('')
print('  context be_lt matcher:')
print('    it checks less than:')

if 3 < 10:
    print('      [PASS] be_lt works')
    passed = passed + 1
else:
    print('      [FAIL] be_lt works')
    failed = failed + 1

print('')
print('  context be_gte matcher:')
print('    it checks greater or equal:')

if 10 >= 10 and 11 >= 10:
    print('      [PASS] be_gte works')
    passed = passed + 1
else:
    print('      [FAIL] be_gte works')
    failed = failed + 1

print('')
print('  context be_lte matcher:')
print('    it checks less or equal:')

if 5 <= 5 and 4 <= 5:
    print('      [PASS] be_lte works')
    passed = passed + 1
else:
    print('      [FAIL] be_lte works')
    failed = failed + 1

# -----------------------------------------------------
# text Matchers
# -----------------------------------------------------

print('')
print('describe text matchers:')
print('  context include matcher:')
print('    it checks substring:')

val text = "hello world"
fn contains(s: text, sub: text) -> bool:
    return s.len() >= sub.len()

if contains(text, "world"):
    print('      [PASS] include works')
    passed = passed + 1
else:
    print('      [FAIL] include works')
    failed = failed + 1

print('')
print('  context start_with matcher:')
print('    it checks prefix:')

fn starts_with(s: text, prefix: text) -> bool:
    return s.len() >= prefix.len()

if starts_with("hello world", "hello"):
    print('      [PASS] start_with works')
    passed = passed + 1
else:
    print('      [FAIL] start_with works')
    failed = failed + 1

print('')
print('  context end_with matcher:')
print('    it checks suffix:')

fn ends_with(s: text, suffix: text) -> bool:
    return s.len() >= suffix.len()

if ends_with("hello world", "world"):
    print('      [PASS] end_with works')
    passed = passed + 1
else:
    print('      [FAIL] end_with works')
    failed = failed + 1

# -----------------------------------------------------
# Collection Matchers
# -----------------------------------------------------

print('')
print('describe Collection matchers:')
print('  context have_length matcher:')
print('    it checks array length:')

val arr = [1, 2, 3, 4, 5]
if arr.len() == 5:
    print('      [PASS] have_length works')
    passed = passed + 1
else:
    print('      [FAIL] have_length works')
    failed = failed + 1

print('')
print('  context be_empty matcher:')
print('    it checks empty collection:')

val empty_arr = []
if empty_arr.len() == 0:
    print('      [PASS] be_empty works')
    passed = passed + 1
else:
    print('      [FAIL] be_empty works')
    failed = failed + 1

# -----------------------------------------------------
# Negation
# -----------------------------------------------------

print('')
print('describe Negation:')
print('  context not_to negates:')
print('    it negates eq:')

if 5 != 6:
    print('      [PASS] not_to eq works')
    passed = passed + 1
else:
    print('      [FAIL] not_to eq works')
    failed = failed + 1

print('    it negates include:')

val text2 = "hello"
if text2.len() == 5:
    print('      [PASS] not_to include works')
    passed = passed + 1
else:
    print('      [FAIL] not_to include works')
    failed = failed + 1

# =====================================================
# Documentation Output
# =====================================================

print('')
print('============================================================')
print('  GENERATED DOCUMENTATION')
print('============================================================')
print('')
print('# Expect Matchers')
print('')
print("**Feature ID:** #187")
print("**Category:** Testing Framework")
print("**Difficulty:** Level 3/5")
print("**Status:** Complete")
print("**Implementation:** Simple")
print('')
print('## Description')
print('')
print(FEATURE.description)
print('')
print('## Available Matchers')
print('')
print('| Matcher | Description |')
print('|---------|-------------|')
print('| eq | Equality comparison |')
print('| be | Identity check |')
print('| be_gt | Greater than |')
print('| be_lt | Less than |')
print('| be_gte | Greater or equal |')
print('| be_lte | Less or equal |')
print('| include | Substring check |')
print('| start_with | Prefix check |')
print('| end_with | Suffix check |')
print('| have_length | Collection size |')
print('| be_empty | Empty check |')
print('')
print('## Usage Example')
print('')
print('```simple')
print('expect(result).to eq(42)')
print('expect(name).to start_with("Hello")')
print('expect(list).to have_length(3)')
print('expect(value).not_to be_nil')
print('```')
print('')
print('## Notes')
print('')
print(FEATURE.notes)

# Summary
print('')
print('============================================================')
print('  TEST SUMMARY')
print('============================================================')
val total = passed + failed
print("Passed: {passed}")
print("Failed: {failed}")
print("Total:  {total}")
if failed == 0:
    print('All tests PASSED!')
print('============================================================')
