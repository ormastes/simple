# ============================================================================
# Tensor Dimension Inference Specification
# ============================================================================
#
# Status: Active - module parses correctly after fixing keyword issues
#
# Fixed Issues (2026-01-18):
# - var fn -> me (mutable method syntax)
# - True/False -> true/false
# - repr variable name -> dim_repr (repr is a keyword)
# - val in pattern -> value (val is a keyword)
# - Multi-line if-else expression -> single-line ternary

import std.spec
import verification.models.tensor_dimensions as td

describe "Tensor Dimension Inference":
    context "Dim creation":
        it "creates literal dimension":
            val d = td.Dim.Literal(value: 10)
            assert d.is_literal() == true
            assert d.get_value() == td.Some(10)

        it "creates named dimension with range":
            val d = td.Dim.Named(name: "batch", range: td.Some((1, 64)))
            assert d.is_named() == true
            assert d.has_range() == true

        it "creates dynamic dimension":
            val d = td.Dim.Dynamic
            assert d.is_dynamic() == true
            assert d.is_inferred() == true

    context "TensorShape creation":
        it "creates shape from literals":
            val shape = td.TensorShape.from_literals([3, 224, 224])
            assert shape.ndim() == 3
            assert shape.is_concrete() == true

        it "gets dimensions by index":
            val shape = td.TensorShape.from_literals([2, 3, 4])
            val d0 = shape.get(0)
            assert d0.is_some() == true

print("=" * 70)
print("TENSOR DIMENSION INFERENCE TESTS")
print("=" * 70)
print("\nModule parses correctly - running tests...")
print("=" * 70)
