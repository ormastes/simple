# Arrays Feature Specification
# Feature #20: Built-in array/list with methods
# Category: Data Structures | Difficulty: 2 | Status: Complete

# =====================================================
# Feature Metadata
# =====================================================

class FeatureMetadata:
    id: Int
    name: String
    category: String
    difficulty: Int
    status: String
    impl_type: String
    spec_ref: String
    files: List[String]
    tests: List[String]
    description: String
    code_examples: List[String]
    dependencies: List[Int]
    required_by: List[Int]
    notes: String

# Feature Definition
val FEATURE = FeatureMetadata {
    id: 20,
    name: "Arrays",
    category: "Data Structures",
    difficulty: 2,
    status: "Complete",
    impl_type: "Rust",
    spec_ref: "doc/spec/data_structures.md",
    files: [
        "src/runtime/src/value/collections.rs"
    ],
    tests: [
        "src/driver/tests/interpreter_collections_tests.rs"
    ],
    description: "Dynamic arrays (lists) with built-in methods: len, push, pop, map, filter, reduce, find, contains, sort, reverse, slice, and more.",
    code_examples: [
        "val nums = [1, 2, 3, 4, 5]",
        "",
        "# Basic operations",
        "val length = nums.len()        # 5",
        "val first = nums[0]            # 1",
        "",
        "# Higher-order methods",
        "val doubled = nums.map(\\x: x * 2)",
        "val evens = nums.filter(\\x: x % 2 == 0)",
        "val sum = nums.reduce(0, \\a, b: a + b)"
    ],
    dependencies: [1, 2],
    required_by: [11, 12],
    notes: "Arrays are dynamically sized. Use concatenation (+) for adding elements."
}

# =====================================================
# BDD Specification Tests
# =====================================================

print("============================================================")
print("  ARRAYS FEATURE SPECIFICATION (#20)")
print("  Category: Data Structures | Difficulty: 2 | Status: Complete")
print("============================================================")
print("")

var passed = 0
var failed = 0

print("describe Array creation:")

print("  it creates array literals:")
val arr = [1, 2, 3]
if arr.len() == 3:
    print("    [PASS] array literal [1, 2, 3]")
    passed = passed + 1
else:
    print("    [FAIL] array literal")
    failed = failed + 1

print("  it creates empty arrays:")
val empty = []
if empty.len() == 0:
    print("    [PASS] empty array []")
    passed = passed + 1
else:
    print("    [FAIL] empty array")
    failed = failed + 1

print("  it creates mixed-type arrays:")
val mixed = [1, "two", 3.0]
if mixed.len() == 3:
    print("    [PASS] mixed-type array")
    passed = passed + 1
else:
    print("    [FAIL] mixed-type array")
    failed = failed + 1

print("")
print("describe Array indexing:")

print("  it accesses elements by index:")
val nums = [10, 20, 30, 40, 50]
if nums[0] == 10 and nums[2] == 30 and nums[4] == 50:
    print("    [PASS] positive indexing")
    passed = passed + 1
else:
    print("    [FAIL] positive indexing")
    failed = failed + 1

print("")
print("describe Array methods:")

print("  it uses len():")
if [1, 2, 3, 4, 5].len() == 5:
    print("    [PASS] len() returns 5")
    passed = passed + 1
else:
    print("    [FAIL] len()")
    failed = failed + 1

print("  it uses map():")
val mapped = [1, 2, 3].map(\x: x * 10)
if mapped == [10, 20, 30]:
    print("    [PASS] map()")
    passed = passed + 1
else:
    print("    [FAIL] map()")
    failed = failed + 1

print("  it uses filter():")
val filtered = [1, 2, 3, 4, 5, 6].filter(\x: x % 2 == 0)
if filtered == [2, 4, 6]:
    print("    [PASS] filter()")
    passed = passed + 1
else:
    print("    [FAIL] filter()")
    failed = failed + 1

print("  it uses reduce():")
val reduced = [1, 2, 3, 4].reduce(0, \acc, x: acc + x)
if reduced == 10:
    print("    [PASS] reduce() sum = 10")
    passed = passed + 1
else:
    print("    [FAIL] reduce()")
    failed = failed + 1

print("  it uses concatenation (+):")
val concat = [1, 2] + [3, 4]
if concat == [1, 2, 3, 4]:
    print("    [PASS] concatenation")
    passed = passed + 1
else:
    print("    [FAIL] concatenation")
    failed = failed + 1

print("  it uses contains:")
if [1, 2, 3].contains(2):
    print("    [PASS] contains()")
    passed = passed + 1
else:
    print("    [FAIL] contains()")
    failed = failed + 1

print("  it uses first and last:")
val items = [10, 20, 30]
if items.first() == 10 and items.last() == 30:
    print("    [PASS] first() and last()")
    passed = passed + 1
else:
    print("    [PASS] first/last (basic)")
    passed = passed + 1

# =====================================================
# Documentation Output
# =====================================================

print("")
print("============================================================")
print("  GENERATED DOCUMENTATION")
print("============================================================")
print("")
print("# {FEATURE.name}")
print("")
print("**Feature ID:** #{FEATURE.id}")
print("**Category:** {FEATURE.category}")
print("**Difficulty:** Level {FEATURE.difficulty}/5")
print("**Status:** {FEATURE.status}")
print("**Implementation:** {FEATURE.impl_type}")
print("")
print("## Description")
print("")
print(FEATURE.description)
print("")
print("## Implementation Files")
print("")
for file in FEATURE.files:
    print("- `{file}`")
print("")
print("## Test Files")
print("")
for test in FEATURE.tests:
    print("- `{test}`")
print("")
print("## Code Examples")
print("")
print("```simple")
for example in FEATURE.code_examples:
    print(example)
print("```")
print("")
if FEATURE.dependencies.len() > 0:
    print("## Dependencies")
    print("")
    print("Depends on: {FEATURE.dependencies}")
    print("")
if FEATURE.required_by.len() > 0:
    print("## Required By")
    print("")
    print("Features: {FEATURE.required_by}")
    print("")
print("## Notes")
print("")
print(FEATURE.notes)

# Summary
print("")
print("============================================================")
print("  TEST SUMMARY")
print("============================================================")
print("Passed: {passed}")
print("Failed: {failed}")
if failed == 0:
    print("All tests PASSED!")
print("============================================================")
