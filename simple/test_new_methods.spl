import ml.torch.factory.{from_data, select, zeros_like}
import ml.torch.tensor_class.{Tensor}

fn main():
    # Test from_data
    let a = from_data([[1.0, 2.0], [3.0, 4.0]])
    print("Created tensor a")
    
    # Test gt
    let b = from_data([[2.0]])
    let gt_result = a.gt(b)
    print("GT comparison worked")
    
    # Test allclose
    let c = from_data([[1.0, 2.0], [3.0, 4.0]])
    let close = a.allclose(c)
    print("Allclose worked: ", close)
    
    # Test select
    let cond = from_data([[1.0, 0.0]])
    let x = from_data([[10.0, 20.0]])
    let y = from_data([[1.0, 2.0]])
    let result = select(cond, x, y)
    print("Select worked")
    
    # Test zeros_like
    let zeros = zeros_like(a)
    print("Zeros_like worked")
    
    # Test one_hot
    let indices = from_data([0.0, 1.0, 2.0])
    let encoded = indices.one_hot(3)
    print("One_hot worked")
    
    print("All methods work!")
