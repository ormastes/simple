# Built-in Block Definitions
#
# This module contains the built-in block definitions that come with Simple:
# - m{} - Math block
# - loss{} - Loss block with auto-backward
# - nograd{} - No-gradient block for inference

use blocks.builtin.math.{MathBlockDef}
use blocks.builtin.loss.{LossBlockDef}
use blocks.builtin.nograd.{NogradBlockDef}

# ============================================================================
# Re-exports
# ============================================================================

export MathBlockDef, LossBlockDef, NogradBlockDef

# ============================================================================
# All Built-in Blocks
# ============================================================================

fn all_builtin_blocks() -> [BlockDefinition]:
    """Return all built-in block definitions."""
    [
        MathBlockDef(),
        LossBlockDef(),
        NogradBlockDef()
    ]

fn builtin_block_kinds() -> [text]:
    """Return the keywords for all built-in blocks."""
    ["m", "loss", "nograd"]

export all_builtin_blocks, builtin_block_kinds

# ============================================================================
# Documentation
# ============================================================================

# ## Built-in Blocks
#
# ### m{} - Math Block
#
# The math block enables mathematical notation:
# - `^` for power (instead of `**`)
# - `'` for transpose (postfix)
# - Implicit multiplication (`2x` means `2*x`)
# - Broadcast operators (`.+`, `.-`, `.*`, `./`, `.^`)
# - Matrix multiplication (`@`)
#
# Example:
# ```simple
# val y = m{ x^2 + 2*x + 1 }
# val z = m{ A' @ x }  # A^T * x
# ```
#
# ### loss{} - Loss Block
#
# The loss block inherits math features and adds:
# - Automatic gradient tracking
# - Automatic `.backward()` call on result
#
# Example:
# ```simple
# val l = loss{
#     pred = model(x)
#     cross_entropy(pred, y)
# }
# # Gradients computed automatically
# ```
#
# ### nograd{} - No-Gradient Block
#
# The nograd block inherits math features and adds:
# - Gradient tracking disabled (faster, less memory)
#
# Example:
# ```simple
# val predictions = nograd{
#     model(test_data)
# }
# # No gradients - faster inference
# ```
