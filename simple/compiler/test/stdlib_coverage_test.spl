# Stdlib Branch Coverage Tests
#
# Tests core stdlib functions to improve branch coverage
# without depending on compiler modules.

use std.spec.*

describe "String operations branch coverage":
    it "tests empty string":
        val s = ""
        expect s.len() == 0
        expect s.is_empty() == true

    it "tests non-empty string":
        val s = "hello"
        expect s.len() == 5
        expect s.is_empty() == false

    it "tests string contains":
        val s = "hello world"
        expect s.contains("world") == true
        expect s.contains("xyz") == false

describe "List operations branch coverage":
    it "tests empty list":
        val lst: List<i32> = List.new()
        expect lst.len() == 0
        expect lst.is_empty() == true

    it "tests non-empty list":
        var lst: List<i32> = List.new()
        lst.push(1)
        lst.push(2)
        lst.push(3)
        expect lst.len() == 3
        expect lst.is_empty() == false

    it "tests list contains":
        var lst: List<i32> = List.new()
        lst.push(10)
        lst.push(20)
        expect lst.contains(&10) == true
        expect lst.contains(&99) == false

describe "Option branch coverage":
    it "tests Some variant":
        val opt: Option<i32> = Some(42)
        expect opt.is_some() == true
        expect opt.is_none() == false
        expect opt.unwrap() == 42

    it "tests None variant":
        val opt: Option<i32> = nil
        expect opt.is_some() == false
        expect opt.is_none() == true

    it "tests unwrap_or with Some":
        val opt: Option<i32> = Some(42)
        expect opt.unwrap_or(99) == 42

    it "tests unwrap_or with None":
        val opt: Option<i32> = nil
        expect opt.unwrap_or(99) == 99

describe "Result branch coverage":
    it "tests Ok variant":
        val res: Result<i32, text> = Ok(42)
        expect res.is_ok() == true
        expect res.is_err() == false

    it "tests Err variant":
        val res: Result<i32, text> = Err("error")
        expect res.is_ok() == false
        expect res.is_err() == true

    it "tests unwrap_or with Ok":
        val res: Result<i32, text> = Ok(42)
        expect res.unwrap_or(99) == 42

    it "tests unwrap_or with Err":
        val res: Result<i32, text> = Err("error")
        expect res.unwrap_or(99) == 99
