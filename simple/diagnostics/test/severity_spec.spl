# SSpec Tests for Severity Type
#
# Tests all severity level operations: names, colors, priorities, predicates.

use sspec.{describe, it, expect}
use diagnostics.Severity

describe "Severity Enum":
    it "has Error variant":
        val sev = Severity.Error
        expect sev == Severity.Error

    it "has Warning variant":
        val sev = Severity.Warning
        expect sev == Severity.Warning

    it "has Note variant":
        val sev = Severity.Note
        expect sev == Severity.Note

    it "has Help variant":
        val sev = Severity.Help
        expect sev == Severity.Help

    it "has Info variant":
        val sev = Severity.Info
        expect sev == Severity.Info

describe "Severity Names":
    it "returns correct name for Error":
        expect Severity.Error.name() == "error"

    it "returns correct name for Warning":
        expect Severity.Warning.name() == "warning"

    it "returns correct name for Note":
        expect Severity.Note.name() == "note"

    it "returns correct name for Help":
        expect Severity.Help.name() == "help"

    it "returns correct name for Info":
        expect Severity.Info.name() == "info"

describe "Severity Colors":
    it "returns ANSI color for Error":
        val color = Severity.Error.color()
        expect not color.is_empty()
        expect color.contains("[")  # ANSI escape sequence

    it "returns ANSI color for Warning":
        val color = Severity.Warning.color()
        expect not color.is_empty()
        expect color.contains("[")

    it "returns ANSI color for Note":
        val color = Severity.Note.color()
        expect not color.is_empty()
        expect color.contains("[")

    it "returns ANSI color for Help":
        val color = Severity.Help.color()
        expect not color.is_empty()
        expect color.contains("[")

    it "returns ANSI color for Info":
        val color = Severity.Info.color()
        expect not color.is_empty()
        expect color.contains("[")

describe "Severity Priorities":
    it "Error has highest priority":
        expect Severity.Error.priority() == 0

    it "Warning has second priority":
        expect Severity.Warning.priority() == 1

    it "Note has third priority":
        expect Severity.Note.priority() == 2

    it "Help has fourth priority":
        expect Severity.Help.priority() == 3

    it "Info has lowest priority":
        expect Severity.Info.priority() == 4

    it "Error priority < Warning priority":
        expect Severity.Error.priority() < Severity.Warning.priority()

    it "Warning priority < Note priority":
        expect Severity.Warning.priority() < Severity.Note.priority()

describe "Severity Predicates":
    it "is_error returns true for Error":
        expect Severity.Error.is_error()

    it "is_error returns false for Warning":
        expect not Severity.Warning.is_error()

    it "is_warning returns true for Warning":
        expect Severity.Warning.is_warning()

    it "is_warning returns false for Error":
        expect not Severity.Error.is_warning()

describe "Severity to_string":
    it "converts Error to string":
        expect Severity.Error.to_string() == "error"

    it "converts Warning to string":
        expect Severity.Warning.to_string() == "warning"

    it "converts Note to string":
        expect Severity.Note.to_string() == "note"

    it "converts Help to string":
        expect Severity.Help.to_string() == "help"

    it "converts Info to string":
        expect Severity.Info.to_string() == "info"
