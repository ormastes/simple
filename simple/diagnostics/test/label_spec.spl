# SSpec Tests for Label Type
#
# Tests labeled span messages for diagnostics.

use sspec.{describe, it, expect}
use diagnostics.{Label, Span}

describe "Label Construction":
    it "creates label with span and message":
        val span = Span.new(10, 20, 5, 3)
        val label = Label.new(span, "expected identifier")

        expect label.span == span
        expect label.message == "expected identifier"

    it "creates label with short message":
        val span = Span.new(0, 5, 1, 1)
        val label = Label.new(span, "error")

        expect label.message == "error"

    it "creates label with long message":
        val span = Span.new(10, 15, 2, 5)
        val msg = "this is a very long error message that describes the problem in detail"
        val label = Label.new(span, msg)

        expect label.message == msg

describe "Label Factory Method":
    it "creates label using new()":
        val span = Span.new(5, 10, 2, 1)
        val label = Label.new(span, "test message")

        expect label.span.start == 5
        expect label.span.end == 10
        expect label.message == "test message"

describe "Label Formatting":
    it "formats label as string":
        val span = Span.new(10, 20, 5, 3)
        val label = Label.new(span, "unexpected token")

        val formatted = label.to_string()

        expect formatted.contains("unexpected token")
        expect formatted.contains("5:3")

    it "includes span information in format":
        val span = Span.new(0, 5, 1, 1)
        val label = Label.new(span, "error here")

        val formatted = label.to_string()

        expect formatted.contains("1:1")
