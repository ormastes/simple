# Test TypedTensor import from public API
import ml.torch.{TypedTensor, TensorType, DimSpec, Device, DType}

print("Testing TypedTensor public API...")

# Test 1: Create a typed tensor with exact dimensions
print("\nTest 1: Exact dimensions")
let tensor_type1 = TensorType(
    dims: [DimSpec.Exact(value: 4), DimSpec.Exact(value: 8)],
    dtype: DType.Float32,
    device: Device.CPU
)
print(f"Created TensorType: {tensor_type1.dims.len()} dimensions")

# Test 2: Create a typed tensor with named dimensions
print("\nTest 2: Named dimensions")
let tensor_type2 = TensorType(
    dims: [
        DimSpec.Named(name: "batch", lo: 1, hi: 64),
        DimSpec.Exact(value: 784)
    ],
    dtype: DType.Float32,
    device: Device.CPU
)
print(f"Created TensorType with named dimension: batch:1..64")

# Test 3: Dynamic dimensions
print("\nTest 3: Dynamic dimensions")
let tensor_type3 = TensorType(
    dims: [DimSpec.Dynamic, DimSpec.Exact(value: 10)],
    dtype: DType.Float32,
    device: Device.CPU
)
print(f"Created TensorType with dynamic dimension")

print("\nâœ… All public API imports working correctly!")
