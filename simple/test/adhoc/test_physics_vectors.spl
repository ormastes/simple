#!/usr/bin/env simple
# Standalone Physics Vector Test Program
# Tests vector operations without spec DSL

import physics.core as core

fn test_vector3_creation():
    print("Testing Vector3 creation...")

    # Test basic creation
    val v = core.Vector3(1.0, 2.0, 3.0)
    assert v.x == 1.0, "Vector3 x component should be 1.0"
    assert v.y == 2.0, "Vector3 y component should be 2.0"
    assert v.z == 3.0, "Vector3 z component should be 3.0"
    print("  ✓ Basic creation works")

    # Test zero vector
    val zero = core.Vector3::zero()
    assert zero.x == 0.0, "Zero vector x should be 0.0"
    assert zero.y == 0.0, "Zero vector y should be 0.0"
    assert zero.z == 0.0, "Zero vector z should be 0.0"
    print("  ✓ Zero vector works")

    # Test unit vectors
    val up = core.Vector3::up()
    val right = core.Vector3::right()
    val forward = core.Vector3::forward()
    assert up.y == 1.0, "Up vector should have y=1.0"
    assert right.x == 1.0, "Right vector should have x=1.0"
    assert forward.z == 1.0, "Forward vector should have z=1.0"
    print("  ✓ Unit vectors work")

fn test_vector3_arithmetic():
    print("Testing Vector3 arithmetic...")

    # Addition
    val v1 = core.Vector3(1.0, 2.0, 3.0)
    val v2 = core.Vector3(4.0, 5.0, 6.0)
    val sum = v1.add(v2)
    assert sum.x == 5.0, "Addition x component should be 5.0"
    assert sum.y == 7.0, "Addition y component should be 7.0"
    assert sum.z == 9.0, "Addition z component should be 9.0"
    print("  ✓ Addition works")

    # Subtraction
    val diff = v2.sub(v1)
    assert diff.x == 3.0, "Subtraction x component should be 3.0"
    assert diff.y == 3.0, "Subtraction y component should be 3.0"
    assert diff.z == 3.0, "Subtraction z component should be 3.0"
    print("  ✓ Subtraction works")

    # Scaling
    val scaled = v1.scale(2.0)
    assert scaled.x == 2.0, "Scaled x component should be 2.0"
    assert scaled.y == 4.0, "Scaled y component should be 4.0"
    assert scaled.z == 6.0, "Scaled z component should be 6.0"
    print("  ✓ Scaling works")

fn test_vector3_dot_cross():
    print("Testing Vector3 dot and cross products...")

    # Dot product
    val v1 = core.Vector3(1.0, 0.0, 0.0)
    val v2 = core.Vector3(1.0, 0.0, 0.0)
    val dot = v1.dot(v2)
    assert dot == 1.0, "Dot product should be 1.0"
    print("  ✓ Dot product works")

    # Cross product
    val v3 = core.Vector3(1.0, 0.0, 0.0)
    val v4 = core.Vector3(0.0, 1.0, 0.0)
    val cross = v3.cross(v4)
    assert cross.x == 0.0, "Cross product x should be 0.0"
    assert cross.y == 0.0, "Cross product y should be 0.0"
    assert cross.z == 1.0, "Cross product z should be 1.0"
    print("  ✓ Cross product works")

fn test_vector3_magnitude():
    print("Testing Vector3 magnitude and normalization...")

    # Magnitude (3-4-5 triangle)
    val v = core.Vector3(3.0, 4.0, 0.0)
    val mag = v.magnitude()
    assert mag == 5.0, "Magnitude should be 5.0"
    print("  ✓ Magnitude calculation works")

    # Normalization
    val normalized = v.normalize()
    val norm_mag = normalized.magnitude()
    assert norm_mag >= 0.99, "Normalized magnitude should be ~1.0"
    assert norm_mag <= 1.01, "Normalized magnitude should be ~1.0"
    print("  ✓ Normalization works")

    # Distance
    val v1 = core.Vector3::zero()
    val v2 = core.Vector3(3.0, 4.0, 0.0)
    val dist = v1.distance(v2)
    assert dist == 5.0, "Distance should be 5.0"
    print("  ✓ Distance calculation works")

fn main():
    print("=== Physics Vector Test Suite ===\n")

    test_vector3_creation()
    test_vector3_arithmetic()
    test_vector3_dot_cross()
    test_vector3_magnitude()

    print("\n✅ All physics vector tests passed!")
    return 0
