import ml.torch.factory.{from_data, select, zeros_like}
import ml.torch.tensor_class.{Tensor}

fn main():
    # Test from_data
    val a = from_data([[1.0, 2.0], [3.0, 4.0]])
    print("Created tensor a")
    
    # Test gt
    val b = from_data([[2.0]])
    val gt_result = a.gt(b)
    print("GT comparison worked")
    
    # Test allclose
    val c = from_data([[1.0, 2.0], [3.0, 4.0]])
    val close = a.allclose(c)
    print("Allclose worked: ", close)
    
    # Test select
    val cond = from_data([[1.0, 0.0]])
    val x = from_data([[10.0, 20.0]])
    val y = from_data([[1.0, 2.0]])
    val result = select(cond, x, y)
    print("Select worked")
    
    # Test zeros_like
    val zeros = zeros_like(a)
    print("Zeros_like worked")
    
    # Test one_hot
    val indices = from_data([0.0, 1.0, 2.0])
    val encoded = indices.one_hot(3)
    print("One_hot worked")
    
    print("All methods work!")
