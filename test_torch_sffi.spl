#!/usr/bin/env simple
# Test PyTorch SFFI Integration

use lib.torch.{torch_available, torch_version, TorchTensorWrapper}

fn main():
    print "=== PyTorch SFFI Integration Test ==="
    print ""

    # Test 1: Backend detection
    print "Test 1: Backend Detection"
    val available = torch_available()
    print "  torch_available() = {available}"

    val version = torch_version()
    print "  torch_version() = {version}"
    print ""

    # Test 2: Tensor creation (zeros)
    print "Test 2: Tensor Creation (zeros)"
    val t1 = TorchTensorWrapper.tensor_zeros([2, 3])
    print "  Created tensor with shape [2, 3]"
    val dims1 = t1.ndim()
    print "  ndim() = {dims1}"
    val numel1 = t1.numel()
    print "  numel() = {numel1}"
    print ""

    # Summary
    print "=== Summary ==="
    if available:
        print "✓ PyTorch FFI is available and working!"
    else:
        print "⚠ Running in stub mode (PyTorch not installed)"
        print "  All functions work but return default values"

    print ""
    print "✓ SFFI test complete!"

export main
