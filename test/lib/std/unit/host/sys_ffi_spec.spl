# @skip
"""
System FFI Specification
Feature: System FFI Functions
Category: Host, FFI
Status: Complete

Tests for system operations using FFI functions including command-line
arguments access and standard output operations.
"""

use host.async_nogc_mut.sys.{Args, stdout}

describe "System FFI Functions":
    """
    Tests for system FFI functions for args and stdout operations.
    """
    context "command line arguments":
        it "should get arguments list":
            val args = Args.get_args()

            # Should at least have the program name
            expect(args.len() >= 1)

            # First argument should be program name
            val program = args[0]
            expect(program != "")

    context "standard output":
        it "should write to stdout":
            match stdout().write("Test output\n"):
                case Ok(count):
                    # Should write some bytes
                    expect(count > 0)
                case Err(e):
                    fail("Expected Ok, got Err: {e}")

        it "should flush stdout":
            match stdout().flush():
                case Ok(_):
                    pass  # Success
                case Err(e):
                    fail("Expected Ok, got Err: {e}")
