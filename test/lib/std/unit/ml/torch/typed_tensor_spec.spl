# @pending
# @skip - Uses unsupported keyword: with
"""
Typed Tensor Specification Tests
Feature: ML Compile-time Dimension Inference
Category: ML, Type System
Status: Complete

Tests for compile-time dimension inference and typed arrays
with dimension tracking and data type specification.
"""


class TypedArray:
    dimensions: [i64]
    dtype: text

    fn new(dimensions: [i64], dtype: text = "f32") -> TypedArray:
        TypedArray(dimensions, dtype)

    fn rank() -> i64:
        self.dimensions.len()

    fn get_dimension(index: i64) -> i64:
        return self.dimensions[index]

    fn type_string() -> text:
        return self.dtype

describe "Typed Tensor":
    """
    Tests for typed tensors with dimension tracking.
    """
    context "dimension tracking":
        it "creates typed array with dimensions":
            val arr = TypedArray.new([2, 3, 4])
            expect arr.type_string() == "f32"

        it "supports custom data types":
            val arr_f32 = TypedArray.new([10, 10], dtype="f32")
            val arr_i64 = TypedArray.new([10, 10], dtype="i64")
            expect arr_f32.type_string() == "f32"
            expect arr_i64.type_string() == "i64"
