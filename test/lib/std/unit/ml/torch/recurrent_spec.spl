# PyTorch Recurrent Layer Tests
# Tests for ml.torch.nn recurrent modules

import std.spec
import ml.torch as torch
import ml.torch.nn.recurrent as rnn
import ml.torch.ffi_helpers as helpers
import ml.torch.device.Device
import ml.torch.dtype.DType

describe "RNN Layers":
    context "RNN":
        it "creates RNN layer":
            val rnn_layer = rnn.RNN(input_size=10, hidden_size=20, num_layers=1)
            expect rnn_layer.input_size == 10
            expect rnn_layer.hidden_size == 20

    context "LSTM":
        it "creates LSTM layer":
            val lstm_layer = rnn.LSTM(input_size=10, hidden_size=20, num_layers=1)
            expect lstm_layer.input_size == 10
            expect lstm_layer.hidden_size == 20

    context "GRU":
        it "creates GRU layer":
            val gru_layer = rnn.GRU(input_size=10, hidden_size=20, num_layers=1)
            expect gru_layer.input_size == 10
            expect gru_layer.hidden_size == 20

    context "sequence processing":
        it "processes sequences with LSTM":
            val lstm = rnn.LSTM(input_size=5, hidden_size=10, num_layers=1)
            expect lstm.hidden_size == 10

    context "advanced":
        skip "handles packed sequences":
            pass
