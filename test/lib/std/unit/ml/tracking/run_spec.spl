# Experiment Tracking Unit Tests

import ml.tracking


# ============================================================================
# Test: Run Creation and Logging
# ============================================================================


var passed = 0
var failed = 0


# Test 1: Create run
tracking.set_mode("offline")
val test_run = tracking.run(project: "test-project", name: "test-run", config: {"lr": 0.001}, tags: ["test"])

if test_run.project == "test-project":
    passed += 1
else:
    failed += 1

if test_run.name == "test-run":
    passed += 1
else:
    failed += 1

if test_run.id != nil and test_run.id.len() > 0:
    passed += 1
else:
    failed += 1


# Test 2: Log metrics
test_run.log({"loss": 0.5, "acc": 0.9}, step=0)
test_run.log({"loss": 0.3, "acc": 0.95}, step=1)

passed += 1


# Test 3: Create artifact
val artifact = tracking.Artifact("test-model", "model", "Test model artifact", {})

if artifact.name == "test-model":
    passed += 1
else:
    failed += 1

if artifact.type == "model":
    passed += 1
else:
    failed += 1


# Test 4: Finish run
test_run.finish()

if test_run.end_time != nil:
    passed += 1
else:
    failed += 1


# Summary

if failed == 0:
else:

