# @pending
# Config Module Tests
#
# Tests for configuration loading and management.

# @skip
describe "LogConfig":
    describe "default()":
        it "has INFO level":
            val config = LogConfig.default()
            expect config.global_level == 4

        it "has empty scopes":
            val config = LogConfig.default()
            expect config.scopes.len() == 0

        it "has timestamps enabled":
            val config = LogConfig.default()
            expect config.timestamps == true

        it "has text format":
            val config = LogConfig.default()
            expect config.format == "text"

    describe "testing()":
        it "has DEBUG level":
            val config = LogConfig.testing()
            expect config.global_level == 5

        it "has timestamps disabled":
            val config = LogConfig.testing()
            expect config.timestamps == false

    describe "production()":
        it "has WARN level":
            val config = LogConfig.production()
            expect config.global_level == 3

        it "has JSON format":
            val config = LogConfig.production()
            expect config.format == "json"

    describe "sdn()":
        it "has ERROR level":
            val config = LogConfig.sdn()
            expect config.global_level == 2

describe "DiConfig":
    describe "default()":
        it "has dev profile":
            val config = DiConfig.default()
            expect config.profile == "dev"

        it "has empty bindings":
            val config = DiConfig.default()
            expect config.bindings.len() == 0

    describe "with_profile()":
        it "sets profile correctly":
            val config = DiConfig.with_profile("test")
            expect config.profile == "test"

describe "ParserConfig":
    describe "default()":
        it "has full mode":
            val config = ParserConfig.default()
            expect config.mode == "full"

        it "has error recovery enabled":
            val config = ParserConfig.default()
            expect config.error_recovery == true

        it "has 100 max errors":
            val config = ParserConfig.default()
            expect config.max_errors == 100

    describe "outline()":
        it "has outline mode":
            val config = ParserConfig.outline()
            expect config.mode == "outline"

        it "has 1000 max errors":
            val config = ParserConfig.outline()
            expect config.max_errors == 1000

describe "ExecutionConfig":
    describe "interpret()":
        it "has interpret mode":
            val config = ExecutionConfig.interpret()
            expect config.mode == "interpret"

        it "has debug enabled":
            val config = ExecutionConfig.interpret()
            expect config.debug == true

        it "has no optimization":
            val config = ExecutionConfig.interpret()
            expect config.optimize == 0

    describe "jit()":
        it "has jit mode":
            val config = ExecutionConfig.jit()
            expect config.mode == "jit"

        it "has level 2 optimization":
            val config = ExecutionConfig.jit()
            expect config.optimize == 2

    describe "aot()":
        it "has aot mode":
            val config = ExecutionConfig.aot()
            expect config.mode == "aot"

        it "has level 3 optimization":
            val config = ExecutionConfig.aot()
            expect config.optimize == 3

describe "AppConfig":
    describe "for_interpreter()":
        it "has development log config":
            val config = AppConfig.for_interpreter()
            expect config.log.global_level == 5

        it "has interpret execution mode":
            val config = AppConfig.for_interpreter()
            expect config.execution.mode == "interpret"

    describe "for_compiler()":
        it "has production log config":
            val config = AppConfig.for_compiler()
            expect config.log.global_level == 3

        it "has AOT execution mode":
            val config = AppConfig.for_compiler()
            expect config.execution.mode == "aot"

    describe "for_sdn()":
        it "has SDN log config":
            val config = AppConfig.for_sdn()
            expect config.log.global_level == 2

        it "has no execution mode":
            val config = AppConfig.for_sdn()
            expect config.execution.mode == "none"

        it "has outline parser mode":
            val config = AppConfig.for_sdn()
            expect config.parser.mode == "outline"

    describe "for_testing()":
        it "has testing log config":
            val config = AppConfig.for_testing()
            expect config.log.global_level == 5

        it "has test DI profile":
            val config = AppConfig.for_testing()
            expect config.di.profile == "test"
