# @pending
# Material Abstraction Tests
# Feature: Game Engine Material Parameter System
# Category: Game Engine, Graphics
# Status: Complete
#
# Tests for the material parameter abstraction including float, vector,
# color, and boolean parameters with type checking and value extraction.

# @skip - Uses unsupported keyword: with
use game_engine.material.MaterialParameter.*

describe "MaterialParameter":
    """
    Tests for MaterialParameter enum variants and value operations.
    """
    context "type checking":
        it "identifies float parameter":
            val p = MaterialParameter.f32(1.5)
            expect p.is_float()
            expect not p.is_vec2()
            expect not p.is_color()

        it "identifies Vec2 parameter":
            val p = MaterialParameter.Vec2(1.0, 2.0)
            expect p.is_vec2()
            expect p.is_vector()
            expect not p.is_float()

        it "identifies Vec3 parameter":
            val p = MaterialParameter.Vec3(1.0, 2.0, 3.0)
            expect p.is_vec3()
            expect p.is_vector()

        it "identifies Vec4 parameter":
            val p = MaterialParameter.Vec4(1.0, 2.0, 3.0, 4.0)
            expect p.is_vec4()
            expect p.is_vector()

        it "identifies Color parameter":
            val p = MaterialParameter.Color(1.0, 0.0, 0.0, 1.0)
            expect p.is_color()
            expect not p.is_vector()

        it "identifies bool parameter":
            val p = MaterialParameter.bool(true)
            expect p.is_bool()

    context "value extraction":
        it "extracts float value":
            val p = MaterialParameter.f32(3.14)
            expect p.as_float() == 3.14

        it "extracts Vec3 value":
            val p = MaterialParameter.Vec3(1.0, 2.0, 3.0)
            val (x, y, z) = p.as_vec3()
            expect x == 1.0
            expect y == 2.0
            expect z == 3.0

        it "extracts Color value":
            val p = MaterialParameter.Color(1.0, 0.5, 0.0, 1.0)
            val (r, g, b, a) = p.as_color()
            expect r == 1.0
            expect g == 0.5
            expect a == 1.0

    context "string conversion":
        it "converts to string":
            val p = MaterialParameter.f32(1.0)
            expect "f32" in p.to_string()

        it "provides descriptions":
            val p = MaterialParameter.Color(1.0, 0.0, 0.0, 1.0)
            expect "color" in p.description().to_lower()
