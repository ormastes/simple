# SceneNode Abstraction Tests
# Mock implementation for testing scene node functionality

use std.spec.*

# Mock Transform for position, rotation, scale
class Transform:
    x: f64
    y: f64
    z: f64
    rx: f64
    ry: f64
    rz: f64
    sx: f64
    sy: f64
    sz: f64

impl Transform:
    static fn new(x: f64, y: f64, z: f64) -> Transform:
        Transform(x: x, y: y, z: z, rx: 0.0, ry: 0.0, rz: 0.0, sx: 1.0, sy: 1.0, sz: 1.0)

    me set_position(nx: f64, ny: f64, nz: f64):
        self.x = nx
        self.y = ny
        self.z = nz

    me set_rotation(rx: f64, ry: f64, rz: f64):
        self.rx = rx
        self.ry = ry
        self.rz = rz

    me set_scale(sx: f64, sy: f64, sz: f64):
        self.sx = sx
        self.sy = sy
        self.sz = sz

# Mock SceneNode
class SceneNode:
    name: text
    transform: Transform
    visible: bool
    parent: Option<SceneNode>
    children: List<SceneNode>

impl SceneNode:
    static fn new(name: text) -> SceneNode:
        SceneNode(name: name, transform: Transform.new(0.0, 0.0, 0.0), visible: true, parent: None, children: [])

    me add_child(child: SceneNode):
        self.children.push(child)

    fn get_children() -> List<SceneNode>:
        self.children

    me set_visible(v: bool):
        self.visible = v

    fn is_visible() -> bool:
        self.visible

    fn get_transform() -> Transform:
        self.transform

describe "SceneNode":
    it "creates nodes":
        val node = SceneNode.new("test_node")
        assert node.name == "test_node"
        assert node.visible == true

    it "handles parent-child relationships":
        val parent = SceneNode.new("parent")
        val child = SceneNode.new("child")
        parent.add_child(child)
        assert parent.get_children().len() == 1

    it "handles transforms":
        val node = SceneNode.new("node_with_transform")
        val transform = node.get_transform()
        assert transform.x == 0.0
        assert transform.y == 0.0
        assert transform.z == 0.0

    it "handles visibility":
        val node = SceneNode.new("visible_node")
        assert node.is_visible() == true
        node.set_visible(false)
        assert node.is_visible() == false

    it "traverses scene graph":
        val root = SceneNode.new("root")
        val child1 = SceneNode.new("child1")
        val child2 = SceneNode.new("child2")
        root.add_child(child1)
        root.add_child(child2)
        val children = root.get_children()
        assert children.len() == 2
