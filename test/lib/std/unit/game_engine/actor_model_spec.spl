"""
Actor Model Game Logic Tests
Feature: Game Engine Actor Model System
Category: Game Engine, Concurrency
Status: Complete

Tests for the actor model system enabling concurrent game entities,
including message types for Update, Spawn, Despawn, and state changes.
"""

import std.spec
import game_engine.actor_model.GameMessage

describe "GameMessage":
    """
    Tests for GameMessage enum variants and their type identification.
    """
    it "creates Update message with delta time":
        val msg = GameMessage::Update(0.016)
        expect msg.is_update()
        expect msg.get_delta() == 0.016

    it "creates Spawn message with position":
        val msg = GameMessage::Spawn((1.0, 2.0, 3.0))
        expect msg.is_spawn()

    it "creates Despawn message":
        val msg = GameMessage::Despawn
        expect msg.is_despawn()

    it "creates SetPosition message":
        val msg = GameMessage::SetPosition((5.0, 10.0, 15.0))
        expect msg.is_set_position()

    it "creates GetPosition message":
        val msg = GameMessage::GetPosition
        expect msg.is_get_position()

    it "creates Damage message":
        val msg = GameMessage::Damage(50)
        expect msg.is_damage()

    it "creates Heal message":
        val msg = GameMessage::Heal(25)
        expect msg.is_heal()

    it "converts to string":
        val msg = GameMessage::Update(0.016)
        val str = msg.to_string()
        expect "Update" in str

    it "provides description":
        val msg = GameMessage::Spawn((0.0, 0.0, 0.0))
        val desc = msg.description()
        expect "Spawn" in desc or "entity" in desc

    it "identifies message types correctly":
        expect not GameMessage::Update(0.0).is_spawn()
        expect not GameMessage::Spawn((0.0, 0.0, 0.0)).is_update()
        expect not GameMessage::Despawn.is_damage()
