# SDN Value Tests
# Tests for SdnValue enum and operations

import std.spec
import sdn.value.SdnValue

describe "SDN Value":
    context "type checking":
        it "identifies null values":
            val v = SdnValue::null()
            expect v.is_null()
            expect not v.is_bool()

        it "identifies boolean values":
            val v = SdnValue::bool_val(true)
            expect v.is_bool()
            expect not v.is_null()

        it "identifies integer values":
            val v = SdnValue::int_val(42)
            expect v.is_int()
            expect v.is_number()

        it "identifies float values":
            val v = SdnValue::float_val(3.14)
            expect v.is_float()
            expect v.is_number()

        it "identifies string values":
            val v = SdnValue::string_val("hello")
            expect v.is_string()

        it "identifies dict values":
            val v = SdnValue::dict_val()
            expect v.is_dict()

        it "identifies array values":
            val v = SdnValue::array_val([])
            expect v.is_array()

    context "type conversions":
        it "converts to bool":
            val v = SdnValue::bool_val(true)
            expect v.as_bool() == Some(true)

        it "converts to i64":
            val v = SdnValue::int_val(42)
            expect v.as_i64() == Some(42)

        it "converts to f64":
            val v = SdnValue::float_val(3.14)
            expect v.as_f64().is_some()

        it "converts to string":
            val v = SdnValue::string_val("hello")
            expect v.as_str() == Some("hello")

        it "returns None for invalid conversions":
            val v = SdnValue::null()
            expect v.as_bool() == None
            expect v.as_i64() == None
            expect v.as_str() == None

    context "constructors":
        it "creates null value":
            val v = SdnValue::null()
            expect v.is_null()

        it "creates bool value":
            val v = SdnValue::bool_val(false)
            expect v.as_bool() == Some(false)

        it "creates int value":
            val v = SdnValue::int_val(100)
            expect v.as_i64() == Some(100)

        it "creates string value":
            val v = SdnValue::string_val("test")
            expect v.as_str() == Some("test")
