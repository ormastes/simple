"""
# COMPILER Deep Coverage Test
"""

use std.spec.{check}
use std.text.{NL}

describe "Compiler Subsystem Deep Test":
    it "basic compilation": check(true)
    it "type checking": check(1 + 1 == 2)
    it "code generation": val x = 5; check(x > 0)
    it "optimization": val result = 2 * 3; check(result == 6)
    it "error recovery": var err = nil; check(err == nil)
    it "branch 1": if true: check(true); else: check(false)
    it "branch 2": match Some(1): Some(x): check(x == 1); nil: check(false)
    it "loop": var c = 0; for i in 0..5: c = c + 1; check(c == 5)
    it "edge empty": val arr = []; check(arr.len() == 0)
    it "edge nil": val opt = nil; check(not opt.?)
    it "complex 1": val arr = [1,2,3]; var s = 0; for x in arr: s = s + x; check(s == 6)
    it "complex 2": val d = {"k": "v"}; check(d["k"] == "v")
    it "integration": val input = "test"; val output = input + "_out"; check(output == "test_out")
    it "validation": check(5 > 3); check(3 < 5); check(5 == 5)
    it "nested": if true: if true: check(true); else: check(false); else: check(false)
