"""
# Advanced Indexing and Slicing Specification


use std.text.{NL}
**Feature IDs:** #1015, #1016, #1017
**Category:** Language, Collections
**Status:** Complete

Tests for advanced indexing features including:
- Negative indexing (Python-style -1, -2, etc.)
- Slice operations with start:end:step syntax
- String slicing
- Multi-dimensional indexing
"""

describe "Advanced Indexing":
    """
    Tests for negative indexing and advanced array/string access patterns.
    """

    context "negative indexing":
        """
        ### Scenario: Negative Indexing

        Python-style negative indexing where -1 is the last element,
        -2 is second-to-last, etc.
        """

        it "accesses last element with -1":
            val arr = [10, 20, 30, 40, 50]
            expect arr[-1] == 50

        it "accesses second-to-last with -2":
            val arr = [10, 20, 30, 40, 50]
            expect arr[-2] == 40

        it "accesses first element with negative index":
            val arr = [10, 20, 30]
            expect arr[-3] == 10

        it "works with strings":
            val s = "Hello"
            expect s[-1] == "o"
            expect s[-5] == "H"

        it "negative indexing with single element":
            val arr = [42]
            expect arr[-1] == 42

    context "slicing operations":
        """
        ### Scenario: Array Slicing

        Tests slice syntax arr[start:end:step] with various combinations.
        """

        it "slices with start and end":
            val arr = [10, 20, 30, 40, 50]
            expect arr[1:4] == [20, 30, 40]

        it "slices from beginning":
            val arr = [10, 20, 30, 40, 50]
            expect arr[:3] == [10, 20, 30]

        it "slices to end":
            val arr = [10, 20, 30, 40, 50]
            expect arr[2:] == [30, 40, 50]

        it "slices with step":
            val arr = [10, 20, 30, 40, 50]
            expect arr[::2] == [10, 30, 50]

        it "reverses with negative step":
            val arr = [10, 20, 30, 40, 50]
            expect arr[::-1] == [50, 40, 30, 20, 10]

        it "slices with start:end:step":
            val arr = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
            expect arr[2:8:2] == [2, 4, 6]

        it "empty slice":
            val arr = [10, 20, 30]
            expect arr[5:10] == []

    context "string slicing":
        """
        ### Scenario: String Slicing

        Slicing operations on strings (UTF-8 aware).
        """

        it "slices substring":
            val s = "Hello World"
            expect s[0:5] == "Hello"

        it "slices from end":
            val s = "Hello World"
            expect s[-5:] == "World"

        it "slices middle":
            val s = "abcdefgh"
            expect s[2:6] == "cdef"

        it "reverses string":
            val s = "Hello"
            expect s[::-1] == "olleH"

        it "handles UTF-8 characters":
            val s = "Hello üåç World"
            expect s[6:7] == "üåç"

    context "combined operations":
        """
        ### Scenario: Combining Negative Index and Slicing

        Using negative indices in slice expressions.
        """

        it "slices with negative start":
            val arr = [10, 20, 30, 40, 50]
            expect arr[-3:] == [30, 40, 50]

        it "slices with negative end":
            val arr = [10, 20, 30, 40, 50]
            expect arr[:-2] == [10, 20, 30]

        it "slices with both negative":
            val arr = [10, 20, 30, 40, 50]
            expect arr[-4:-1] == [20, 30, 40]

        it "negative indices in string slice":
            val s = "Hello World"
            expect s[-5:-1] == "Worl"
