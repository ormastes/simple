"""
# Function Alias (Deprecated Delegation)

**Feature ID:** #FWD-001
**Category:** Syntax
**Status:** Active

## Overview

Tests the deprecated `fn name = target` function alias syntax that the desugar
pipeline transforms into explicit delegation. Validates basic alias calling,
return value preservation for text and integer types, alias chaining (alias of
alias), and that original functions remain callable alongside their aliases.

## Syntax

```simple
fn sum(a: i64, b: i64) -> i64:
    add(a, b)
val result = sum(3, 4)  # calls add(3, 4) via delegation
```
"""
# Function Alias Specification
#
# Feature IDs: #FWD-001
# Category: Syntax
# Difficulty: 2/5
# Status: DEPRECATED - use explicit delegation instead
#
# The `fn name = target` syntax is deprecated. The desugar pipeline
# transforms it into explicit delegation: `fn name(params): target(params)`.
# This test verifies the delegation pattern works correctly.
#
# Example (deprecated):  fn println = print
# Preferred:             fn println(msg: text): print(msg)

# ============================================================================
# Helper functions (module level, before describe blocks)
# ============================================================================

fn add(a: i64, b: i64) -> i64:
    a + b

fn greet(name: text) -> text:
    "Hello, " + name

fn double(x: i64) -> i64:
    x * 2

fn noop():
    val x = 0

fn identity(x: i64) -> i64:
    x

# ============================================================================
# Delegation aliases (what desugar generates from `fn name = target`)
# ============================================================================

# DEPRECATED: fn sum = add -> generates:
fn sum(a: i64, b: i64) -> i64:
    add(a, b)

# DEPRECATED: fn say_hello = greet -> generates:
fn say_hello(name: text) -> text:
    greet(name)

# DEPRECATED: fn multiply_by_two = double -> generates:
fn multiply_by_two(x: i64) -> i64:
    double(x)

# Chain: fn times_two = multiply_by_two -> generates:
fn times_two(x: i64) -> i64:
    multiply_by_two(x)

# DEPRECATED: fn do_nothing = noop -> generates:
fn do_nothing():
    noop()

# DEPRECATED: fn same = identity -> generates:
fn same(x: i64) -> i64:
    identity(x)

# ============================================================================
# Tests
# ============================================================================

describe "function alias (deprecated delegation)":

    context "basic alias":

        it "calls target function":
            val result = sum(3, 4)
            expect(result).to_equal(7)

        it "works with zero arguments":
            val result = sum(0, 0)
            expect(result).to_equal(0)

        it "works with negative arguments":
            val result = sum(-1, -2)
            expect(result).to_equal(-3)

    context "alias preserves behavior":

        it "preserves return value for text":
            val msg = say_hello("World")
            expect(msg).to_equal("Hello, World")

        it "preserves return value for integer":
            val result = same(42)
            expect(result).to_equal(42)

    context "alias chain":

        it "alias of alias works":
            val result = times_two(5)
            expect(result).to_equal(10)

        it "intermediate alias also works":
            val result = multiply_by_two(7)
            expect(result).to_equal(14)

    context "original function":

        it "original still works":
            val result = add(1, 2)
            expect(result).to_equal(3)

        it "alias and original return same result":
            val r1 = add(10, 20)
            val r2 = sum(10, 20)
            expect(r1).to_equal(r2)

    context "void alias":

        it "void alias is callable":
            do_nothing()
            expect(true).to_equal(true)
