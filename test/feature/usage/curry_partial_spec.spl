# Curry and Partial Application
#
# **Feature ID:** #FUNC-010
# **Category:** Functional Programming
# **Status:** Active
#
# Standard library functions for currying and partial application.
# `curry2(f)` converts a 2-arg function into nested single-arg lambdas.
# `partial1(f, a)` fixes the first argument of a 2-arg function.

use std.common.functions.{curry2, curry3, partial1, partial2}

fn add(a: i64, b: i64) -> i64:
    a + b

fn mul(a: i64, b: i64) -> i64:
    a * b

fn triple_add(a: i64, b: i64, c: i64) -> i64:
    a + b + c

describe "Curry and Partial Application":

    context "curry2":
        it "curries a two-argument function":
            val curried = curry2(add)
            val add5 = curried(5)
            expect add5(3) == 8

        it "curries multiply":
            val curried = curry2(mul)
            val double = curried(2)
            expect double(7) == 14

        it "applies both arguments":
            val curried = curry2(add)
            expect curried(10)(20) == 30

    context "curry3":
        it "curries a three-argument function":
            val curried = curry3(triple_add)
            expect curried(1)(2)(3) == 6

        it "partial application of curry3":
            val curried = curry3(triple_add)
            val add1 = curried(1)
            val add1_2 = add1(2)
            expect add1_2(10) == 13

    context "partial1":
        it "fixes first argument":
            val add10 = partial1(add, 10)
            expect add10(5) == 15

        it "creates increment function":
            val inc = partial1(add, 1)
            expect inc(99) == 100

        it "works with map":
            val add100 = partial1(add, 100)
            val data = [1, 2, 3]
            val result = data.map(add100)
            expect result == [101, 102, 103]

    context "partial2":
        it "fixes first two arguments":
            val add1_2 = partial2(triple_add, 1, 2)
            expect add1_2(3) == 6

        it "fixes different values":
            val add10_20 = partial2(triple_add, 10, 20)
            expect add10_20(30) == 60
