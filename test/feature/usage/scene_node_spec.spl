"""
# Game Engine SceneNode Specification

**Feature IDs:** #GE-002
**Category:** Stdlib
**Difficulty:** 2/5
**Status:** Implemented

## Overview
SceneNode trait using math.Transformd for transform hierarchy.

## Key Concepts
| Concept | Description |
|---------|-------------|
| SceneNode | Trait for scene graph nodes |
| Transformd | f64 transform (position, rotation, scale) |

## Behavior
- SceneNode trait defines transform, hierarchy, naming, visibility
- Uses math.Transformd instead of tuple-based Transform3D
- Trait-only design (no FFI adapters)
"""

import std.spec
use math

# ============================================================================
# Transform Integration
# ============================================================================

describe "SceneNode Transform Integration":
    it "Transformd works as scene node transform":
        val t = math.Transformd.identity()
        expect t.position.is_zero() == true
        expect t.rotation.w == 1.0
        expect t.scale.x == 1.0

    it "Transformd supports position, rotation, scale":
        val pos = math.Vec3d(10.0, 20.0, 30.0)
        val rot = math.Quatd.identity()
        val scl = math.Vec3d(2.0, 2.0, 2.0)
        val t = math.Transformd(position: pos, rotation: rot, scale: scl)
        expect t.position.x == 10.0
        expect t.scale.x == 2.0

    it "Transformd converts to matrix for rendering":
        val t = math.Transformd(
            position: math.Vec3d(5.0, 0.0, 0.0),
            rotation: math.Quatd.identity(),
            scale: math.Vec3d.one()
        )
        val m = t.to_mat4()
        # Translation in column 3
        expect m.data[12] == 5.0
