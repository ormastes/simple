"""
Call-Site Labels Specification

Category: Syntax
Status: Implemented
"""

describe "Call-site labels":

    context "basic label usage":
        it "allows to label":
            fn copy_item(src to, dst):
                dst
            val result = copy_item("a" to, "b")
            expect result == "b"

        it "allows from label":
            fn fetch(url, origin from):
                origin
            val result = fetch("http://example.com", "localhost" from)
            expect result == "localhost"

        it "allows by label":
            fn scale(value, factor by):
                value * factor
            val result = scale(10, 3 by)
            expect result == 30

        it "allows into label":
            fn convert(data, fmt into):
                fmt
            val result = convert("raw", "json" into)
            expect result == "json"

        it "allows onto label":
            fn place(item, target onto):
                target
            val result = place("widget", "canvas" onto)
            expect result == "canvas"

        it "allows with label":
            fn open_file(path, mode with):
                mode
            val result = open_file("/tmp/f", "rw" with)
            expect result == "rw"

    context "no label cases":
        it "works without labels":
            fn add(a, b):
                a + b
            val result = add(3, 4)
            expect result == 7

        it "works with label on param but no label on arg":
            fn copy_item2(src to, dst):
                dst
            val result = copy_item2("a", "b")
            expect result == "b"

    context "multiple labels":
        it "supports from and to labels together":
            fn transfer(amount, src from, dst to):
                amount
            val result = transfer(100, "checking" from, "savings" to)
            expect result == 100
