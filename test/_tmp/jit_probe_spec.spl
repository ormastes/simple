use compiler.core.interpreter.jit.*

describe "probe":
    it "init":
        jit_init(10,1)
        print("E={jit_is_enabled()}")
        expect(jit_is_enabled()).to_equal(true)
        jit_cleanup()

    it "counts":
        jit_init(3,1)
        jit_record_call("x")
        jit_record_call("x")
        print("C={jit_get_call_count('x')}")
        expect(jit_get_call_count("x")).to_equal(2)
        print("S={jit_should_compile('x')}")
        expect(jit_should_compile("x")).to_equal(false)
        jit_record_call("x")
        print("S2={jit_should_compile('x')}")
        expect(jit_should_compile("x")).to_equal(true)
        jit_cleanup()
