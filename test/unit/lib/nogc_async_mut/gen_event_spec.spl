describe "Gen Event":
    it "skipped":
        skip("pre-existing test failures - functions/imports not available")

# # GenEvent spec
# #
# # Tests for src/lib/gen_event.spl
# 
# use std.gen_event.{
#     GenEventManager,
#     gen_event_manager_new, gen_event_start, gen_event_stop,
#     gen_event_is_running, gen_event_add_handler, gen_event_remove_handler,
#     gen_event_handler_count, gen_event_notify, gen_event_call
# }
# 
# describe "GenEvent stdlib":
#     describe "gen_event_manager_new":
#         it "creates manager with name and empty handlers":
#             val mgr = gen_event_manager_new("test_events")
#             expect(mgr.name).to_equal("test_events")
#             expect(mgr.count).to_equal(0)
#             expect(mgr.running).to_equal(false)
# 
#     describe "lifecycle":
#         it "starts the manager":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_start(mgr)
#             expect(gen_event_is_running(mgr)).to_equal(true)
# 
#         it "stops the manager":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_start(mgr)
#             gen_event_stop(mgr)
#             expect(gen_event_is_running(mgr)).to_equal(false)
# 
#         it "not running initially":
#             val mgr = gen_event_manager_new("mgr")
#             expect(gen_event_is_running(mgr)).to_equal(false)
# 
#     describe "gen_event_add_handler":
#         it "increments handler count":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "logger")
#             expect(gen_event_handler_count(mgr)).to_equal(1)
# 
#         it "adds multiple handlers":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "logger")
#             gen_event_add_handler(mgr, "metrics")
#             expect(gen_event_handler_count(mgr)).to_equal(2)
# 
#     describe "gen_event_remove_handler":
#         it "decrements handler count":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "logger")
#             gen_event_add_handler(mgr, "metrics")
#             gen_event_remove_handler(mgr, "logger")
#             expect(gen_event_handler_count(mgr)).to_equal(1)
# 
#         it "removing nonexistent handler leaves count unchanged":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "logger")
#             gen_event_remove_handler(mgr, "unknown")
#             expect(gen_event_handler_count(mgr)).to_equal(1)
# 
#     describe "gen_event_notify":
#         it "calls dispatch fn for each handler":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "h1")
#             gen_event_add_handler(mgr, "h2")
#             var called = 0
#             gen_event_notify(mgr, "ping", fn(handler_id, event):
#                 called = called + 1
#             )
#             expect(called).to_equal(2)
# 
#         it "passes event to dispatch fn":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "h1")
#             var last_event = ""
#             gen_event_notify(mgr, "user_login", fn(handler_id, event):
#                 last_event = event
#             )
#             expect(last_event).to_equal("user_login")
# 
#     describe "gen_event_call":
#         it "collects responses from all handlers":
#             val mgr = gen_event_manager_new("mgr")
#             gen_event_add_handler(mgr, "h1")
#             gen_event_add_handler(mgr, "h2")
#             val responses = gen_event_call(mgr, "ping", fn(handler_id, event):
#                 "pong"
#             )
#             expect(responses.len()).to_equal(2)
# 
#         it "returns empty list when no handlers":
#             val mgr = gen_event_manager_new("mgr")
#             val responses = gen_event_call(mgr, "ping", fn(handler_id, event):
#                 "pong"
#             )
#             expect(responses.len()).to_equal(0)
