# FixedSet - Hash Set Tests

describe "FixedSet":

    describe "construction":
        it "creates empty set":
            val s = FixedSet.new(16)
            expect(s.is_empty()).to_equal(true)
            expect(s.is_full()).to_equal(false)
            expect(s.size()).to_equal(0)
            expect(s.capacity()).to_equal(16)

    describe "add":
        it "adds values":
            val s = FixedSet.new(16)
            expect(s.add(42)).to_equal(true)
            expect(s.add(7)).to_equal(true)
            expect(s.size()).to_equal(2)

        it "returns true for duplicate values":
            val s = FixedSet.new(16)
            s.add(42)
            expect(s.add(42)).to_equal(true)
            expect(s.size()).to_equal(1)

        it "returns false when set is full":
            val s = FixedSet.new(2)
            expect(s.add(1)).to_equal(true)
            expect(s.add(2)).to_equal(true)
            expect(s.add(3)).to_equal(false)

    describe "contains":
        it "returns true for existing value":
            val s = FixedSet.new(16)
            s.add(42)
            expect(s.contains(42)).to_equal(true)

        it "returns false for missing value":
            val s = FixedSet.new(16)
            expect(s.contains(42)).to_equal(false)

    describe "remove":
        it "removes existing value":
            val s = FixedSet.new(16)
            s.add(42)
            s.add(7)
            expect(s.remove(42)).to_equal(true)
            expect(s.contains(42)).to_equal(false)
            expect(s.contains(7)).to_equal(true)
            expect(s.size()).to_equal(1)

        it "returns false for missing value":
            val s = FixedSet.new(16)
            expect(s.remove(42)).to_equal(false)

    describe "multiple elements":
        it "handles multiple elements":
            val s = FixedSet.new(32)
            s.add(1)
            s.add(2)
            s.add(3)
            s.add(4)
            s.add(5)
            expect(s.size()).to_equal(5)
            expect(s.contains(1)).to_equal(true)
            expect(s.contains(3)).to_equal(true)
            expect(s.contains(5)).to_equal(true)
            expect(s.contains(99)).to_equal(false)

    describe "size tracking":
        it "tracks size through add and remove":
            val s = FixedSet.new(16)
            expect(s.size()).to_equal(0)
            s.add(1)
            expect(s.size()).to_equal(1)
            s.add(2)
            expect(s.size()).to_equal(2)
            s.add(2)
            expect(s.size()).to_equal(2)
            s.remove(1)
            expect(s.size()).to_equal(1)

    describe "capacity":
        it "reports full correctly":
            val s = FixedSet.new(3)
            s.add(10)
            s.add(20)
            expect(s.is_full()).to_equal(false)
            s.add(30)
            expect(s.is_full()).to_equal(true)
