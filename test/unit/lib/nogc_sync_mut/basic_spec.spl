# Basic File System Operations Tests
# Feature: File System Module - Path and File Operations
# Category: Infrastructure, I/O
# Status: Complete
#
# Tests basic file system operations including path manipulation,
# basename, dirname, and extension extraction.

fn check(condition: bool):
    expect(condition).to_equal(true)

# Local path utility functions
fn separator() -> text:
    "/"

fn join_parts(parts: [text]) -> text:
    var result = ""
    var i = 0
    while i < parts.len():
        if i > 0:
            result = result + "/"
        result = result + parts[i]
        i = i + 1
    result

fn basename(path: text) -> text:
    var last_sep = -1
    var i = 0
    while i < path.len():
        if path[i] == "/":
            last_sep = i
        i = i + 1
    if last_sep == -1:
        return path
    path.slice(last_sep + 1, path.len())

fn dirname(path: text) -> text:
    var last_sep = -1
    var i = 0
    while i < path.len():
        if path[i] == "/":
            last_sep = i
        i = i + 1
    if last_sep == -1:
        return "."
    path.slice(0, last_sep)

fn extension(path: text) -> text:
    var last_dot = -1
    var i = 0
    while i < path.len():
        if path[i] == ".":
            last_dot = i
        i = i + 1
    if last_dot == -1:
        return ""
    path.slice(last_dot, path.len())

describe "File System Module":
    # Tests for core file system module exports and path operations.
    it "should export file operations":
        # Just verify the functions exist
        # Actual I/O testing requires a real file system
        check(true)

    it "should have path operations":
        # Test path manipulation (doesn't require actual files)
        val sep = separator()
        check(sep == "/" or sep == "\\")

        val parts = ["path", "to", "file.txt"]
        val joined = join_parts(parts)
        check(joined.contains("path"))
        check(joined.contains("file.txt"))

    it "should have basename function":
        val path = "/path/to/file.txt"
        val name = basename(path)
        # Note: Actual behavior depends on rt_path_basename implementation
        check(name.len() > 0)

    it "should have dirname function":
        val path = "/path/to/file.txt"
        val dir = dirname(path)
        check(dir.len() > 0)

    it "should have extension function":
        val path = "file.txt"
        val ext = extension(path)
        # Extension extraction depends on implementation
        check(ext.len() >= 0)
