# End-to-end tests for seq_ce CE builder integration
#
# Tests that ce seq: blocks collect yielded values into an array.

use std.seq_ce.{seq_ce_yield_int, seq_ce_begin, seq_ce_end_int}

describe "ce seq: block â€” yield accumulation":
    it "collects yield values into array":
        # Can't test ce: block directly in interpreter mode
        # but we can test seq_ce library functions directly
        seq_ce_begin()
        seq_ce_yield_int(1)
        seq_ce_yield_int(2)
        seq_ce_yield_int(3)
        val result = seq_ce_end_int()
        expect(result.len()).to_equal(3)

    it "seq_ce_begin clears previous values":
        seq_ce_begin()
        seq_ce_yield_int(10)
        seq_ce_begin()
        seq_ce_yield_int(20)
        val result = seq_ce_end_int()
        expect(result.len()).to_equal(1)

    it "empty sequence has zero length":
        seq_ce_begin()
        val result = seq_ce_end_int()
        expect(result.len()).to_equal(0)
