# StringBuilder spec
#
# Tests for src/lib/string_builder.spl

use std.string_builder.{StringBuilder, string_builder, string_builder_from}

describe "StringBuilder":
    describe "basic construction":
        it "creates empty builder":
            var sb = string_builder()
            expect(sb.is_empty()).to_equal(true)

        it "creates builder from text":
            var sb = string_builder_from("hello")
            expect(sb.to_text()).to_equal("hello")

    describe "push and to_text":
        it "pushes a single part":
            var sb = string_builder()
            sb.push("hello")
            expect(sb.to_text()).to_equal("hello")

        it "pushes multiple parts":
            var sb = string_builder()
            sb.push("Hello, ")
            sb.push("World!")
            expect(sb.to_text()).to_equal("Hello, World!")

        it "push_line appends newline":
            var sb = string_builder()
            sb.push_line("first")
            sb.push("second")
            expect(sb.to_text()).to_equal("first\nsecond")

    describe "len":
        it "returns zero for empty":
            var sb = string_builder()
            expect(sb.len()).to_equal(0)

        it "returns total character count":
            var sb = string_builder()
            sb.push("abc")
            sb.push("de")
            expect(sb.len()).to_equal(5)

    describe "is_empty":
        it "true for new builder":
            var sb = string_builder()
            expect(sb.is_empty()).to_equal(true)

        it "false after push":
            var sb = string_builder()
            sb.push("x")
            expect(sb.is_empty()).to_equal(false)

    describe "clear":
        it "clears all parts":
            var sb = string_builder()
            sb.push("data")
            sb.clear()
            expect(sb.is_empty()).to_equal(true)
            expect(sb.to_text()).to_equal("")
