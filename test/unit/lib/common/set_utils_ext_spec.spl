# Tests for std.set_utils module
# Covers set operations on sorted integer arrays

use std.set_utils.{set_contains, set_add, set_remove}
use std.set_utils.{set_union, set_intersection, set_difference}
use std.set_utils.{is_subset, is_superset, sets_equal}

describe "std.set_utils":
    describe "set_contains":
        it "finds element in set":
            expect(set_contains([1, 2, 3], 2)).to_equal(true)

        it "returns false for missing":
            expect(set_contains([1, 2, 3], 5)).to_equal(false)

    describe "set_add":
        it "adds new element":
            val result = set_add([1, 3], 2)
            expect(set_contains(result, 2)).to_equal(true)

        it "does not add duplicate":
            val result = set_add([1, 2, 3], 2)
            expect(result.len()).to_equal(3)

    describe "set_remove":
        it "removes element":
            val result = set_remove([1, 2, 3], 2)
            expect(set_contains(result, 2)).to_equal(false)
            expect(result.len()).to_equal(2)

    describe "set_union":
        it "combines two sets":
            val result = set_union([1, 2], [2, 3])
            expect(set_contains(result, 1)).to_equal(true)
            expect(set_contains(result, 3)).to_equal(true)

    describe "set_intersection":
        it "finds common elements":
            val result = set_intersection([1, 2, 3], [2, 3, 4])
            expect(set_contains(result, 2)).to_equal(true)
            expect(set_contains(result, 3)).to_equal(true)
            expect(set_contains(result, 1)).to_equal(false)

    describe "set_difference":
        it "finds elements only in first set":
            val result = set_difference([1, 2, 3], [2, 3, 4])
            expect(set_contains(result, 1)).to_equal(true)
            expect(set_contains(result, 2)).to_equal(false)

    describe "is_subset":
        it "checks if a is subset of b":
            expect(is_subset([1, 2], [1, 2, 3])).to_equal(true)
            expect(is_subset([1, 4], [1, 2, 3])).to_equal(false)

    describe "is_superset":
        it "checks if a is superset of b":
            expect(is_superset([1, 2, 3], [1, 2])).to_equal(true)
            expect(is_superset([1, 2], [1, 2, 3])).to_equal(false)

    describe "sets_equal":
        it "checks set equality":
            expect(sets_equal([1, 2, 3], [1, 2, 3])).to_equal(true)
            expect(sets_equal([1, 2], [1, 2, 3])).to_equal(false)
