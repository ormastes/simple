# Tests for src/std/phantom.spl â€” Phantom Type Markers
use std.phantom.{owned, borrowed, read_only, write_only, read_write, connected, disconnected, validated, unvalidated, configured, unconfigured, locked, unlocked}

describe "std.phantom":
    describe "Ownership markers":
        it "owned() returns a struct with _phantom == 0":
            val o = owned()
            expect(o._phantom).to_equal(0)

        it "borrowed() returns a struct with _phantom == 0":
            val b = borrowed()
            expect(b._phantom).to_equal(0)

        it "owned() is non-nil":
            val o = owned()
            expect(o).to_equal(o)

    describe "Access mode markers":
        it "read_only() returns struct with _phantom == 0":
            val r = read_only()
            expect(r._phantom).to_equal(0)

        it "write_only() returns struct with _phantom == 0":
            val w = write_only()
            expect(w._phantom).to_equal(0)

        it "read_write() returns struct with _phantom == 0":
            val rw = read_write()
            expect(rw._phantom).to_equal(0)

    describe "Connection state markers":
        it "connected() returns struct with _phantom == 0":
            val c = connected()
            expect(c._phantom).to_equal(0)

        it "disconnected() returns struct with _phantom == 0":
            val d = disconnected()
            expect(d._phantom).to_equal(0)

    describe "Validation state markers":
        it "validated() returns struct with _phantom == 0":
            val v = validated()
            expect(v._phantom).to_equal(0)

        it "unvalidated() returns struct with _phantom == 0":
            val u = unvalidated()
            expect(u._phantom).to_equal(0)

    describe "Builder pattern markers":
        it "configured() returns struct with _phantom == 0":
            val c = configured()
            expect(c._phantom).to_equal(0)

        it "unconfigured() returns struct with _phantom == 0":
            val u = unconfigured()
            expect(u._phantom).to_equal(0)

    describe "Lock state markers":
        it "locked() returns struct with _phantom == 0":
            val l = locked()
            expect(l._phantom).to_equal(0)

        it "unlocked() returns struct with _phantom == 0":
            val u = unlocked()
            expect(u._phantom).to_equal(0)
