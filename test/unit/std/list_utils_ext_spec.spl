# Tests for std.list_utils module
# Covers list manipulation utilities

use std.list_utils.{reverse_list, take, drop}
use std.list_utils.{chunk, windows}
use std.list_utils.{interleave, flatten, intersperse}
use std.list_utils.{rotate_left, rotate_right}
use std.list_utils.{dedup, dedup_all}
use std.list_utils.{is_sorted, list_equals}

describe "std.list_utils":
    describe "reverse_list":
        it "returns a list of same length":
            val result = reverse_list([1, 2, 3])
            expect(result.len()).to_equal(3)

        it "handles empty list":
            expect(reverse_list([])).to_equal([])

    describe "take":
        it "takes first n elements":
            expect(take([1, 2, 3, 4, 5], 3)).to_equal([1, 2, 3])

        it "returns all if n > length":
            expect(take([1, 2], 5)).to_equal([1, 2])

    describe "drop":
        it "drops first n elements":
            expect(drop([1, 2, 3, 4, 5], 2)).to_equal([3, 4, 5])

    describe "chunk":
        it "splits into chunks of size":
            val chunks = chunk([1, 2, 3, 4, 5], 2)
            expect(chunks.len()).to_equal(3)
            expect(chunks[0]).to_equal([1, 2])
            expect(chunks[2]).to_equal([5])

    describe "windows":
        it "creates sliding windows":
            val wins = windows([1, 2, 3, 4], 2)
            expect(wins.len()).to_equal(3)
            expect(wins[0]).to_equal([1, 2])
            expect(wins[1]).to_equal([2, 3])

    describe "interleave":
        it "interleaves two lists":
            val result = interleave([1, 3, 5], [2, 4, 6])
            expect(result).to_equal([1, 2, 3, 4, 5, 6])

    describe "flatten":
        it "flattens nested lists":
            val result = flatten([[1, 2], [3, 4], [5]])
            expect(result).to_equal([1, 2, 3, 4, 5])

    describe "intersperse":
        it "inserts separator between elements":
            val result = intersperse([1, 2, 3], 0)
            expect(result).to_equal([1, 0, 2, 0, 3])

    describe "rotate_left":
        it "rotates list left":
            val result = rotate_left([1, 2, 3, 4], 1)
            expect(result).to_equal([2, 3, 4, 1])

    describe "rotate_right":
        it "rotates list right":
            val result = rotate_right([1, 2, 3, 4], 1)
            expect(result).to_equal([4, 1, 2, 3])

    describe "dedup":
        it "removes consecutive duplicates":
            val result = dedup([1, 1, 2, 2, 3, 3])
            expect(result).to_equal([1, 2, 3])

        it "preserves non-consecutive duplicates":
            val result = dedup([1, 2, 1, 2])
            expect(result).to_equal([1, 2, 1, 2])

    describe "dedup_all":
        it "removes all duplicates":
            val result = dedup_all([1, 2, 1, 3, 2])
            expect(result.len()).to_equal(3)

    describe "is_sorted":
        it "checks if list is sorted":
            expect(is_sorted([1, 2, 3])).to_equal(true)
            expect(is_sorted([3, 1, 2])).to_equal(false)
            expect(is_sorted([])).to_equal(true)

    describe "list_equals":
        it "checks equality":
            expect(list_equals([1, 2, 3], [1, 2, 3])).to_equal(true)
            expect(list_equals([1, 2], [1, 3])).to_equal(false)
