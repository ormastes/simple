# # Module Import Syntax Specification
#
# **Category:** Syntax
# **Status:** Implemented
#
# Tests for module import/use statement parsing and deprecation warnings.
# Covers modern `use` syntax and deprecated alternatives like `import`, `.`
# and `from...import` patterns.


describe "Module Import Syntax":
    # Verifies parsing and deprecation warnings for module import statements.
    # Covers modern `use` syntax with dot notation, deprecated `.` syntax,
    # and older `import`/`from...import` patterns. Tests export and common use
    # modifiers, relative imports, and module paths with reserved keywords.

    describe "use statement with dot notation":
        # Tests modern `use` statement syntax with dot notation.

        it "parses use module.item":
            # This should parse without warnings
            # Note: Module may not exist, we're testing parsing
            use std.core.Option
            expect(true).to_equal(true)

        it "parses use module with group imports":
            use std.core.{Option, Result}
            expect(true).to_equal(true)

        it "parses use module":
            use std.core
            expect(true).to_equal(true)

        it "parses use with alias":
            use std.core.Option as Opt
            expect(true).to_equal(true)

    describe "deprecated double colon syntax":
        # Tests deprecated `.` syntax which should emit deprecation warnings.

        it "warns on use std double colon core":
            # Parser should emit: "Deprecated: '.' in module paths"
            use std.core
            expect(true).to_equal(true)

        it "warns on use std double colon core double colon star":
            # Multiple . should emit multiple warnings
            use std.core
            expect(true).to_equal(true)

        it "warns on use std double colon core with group":
            use std.core.{Option, Result}
            expect(true).to_equal(true)

    describe "deprecated import keyword":
        # Tests deprecated `import` keyword which should emit deprecation warnings.

        it "warns on import keyword":
            # Parser should emit: "Deprecated: 'import' keyword"
            # Use 'use' instead
            import std.core
            expect(true).to_equal(true)

        it "warns on from...import syntax":
            # Parser should emit: "Deprecated: 'from ... import' syntax"
            # Use 'use module.group' instead
            from std.core import Option
            expect(true).to_equal(true)

    describe "export use statements":
        # Tests export statements with use syntax for re-exporting modules.

        it "parses export use module.item":
            export use std.core.Option
            expect(true).to_equal(true)

        it "parses export use module with group":
            export use std.core.{Option, Result}
            expect(true).to_equal(true)

        it "warns on export use module", tag: "deprecation":
            # Parser should emit: "Avoid 'export use *' - exposes unnecessary interfaces"
            # Use explicit exports instead
            export use std.core
            expect(true).to_equal(true)

        it "parses export A, B from module":
            export Option, Result from std.core
            expect(true).to_equal(true)

        it "parses export group from module":
            export { Option, Result } from std.core
            expect(true).to_equal(true)

    describe "common use statements":
        # Tests `common use` syntax for importing from shared module namespaces.

        it "parses common use module.item":
            common use std.core.Option
            expect(true).to_equal(true)

        it "parses common use module with group":
            common use std.core.{Option, Result}
            expect(true).to_equal(true)

    describe "relative imports":
        # Tests relative import syntax using .. notation.

        it "parses import .. as parent":
            import .. as parent
            expect(true).to_equal(true)

        it "parses import ..sibling":
            import ..sibling
            expect(true).to_equal(true)

    describe "module path with keywords":
        # Tests that reserved keywords are allowed as module path segments.

        it "allows async in path":
            use host.async_nogc_mut.io
            expect(true).to_equal(true)

        it "allows sync in path":
            use host.sync_nogc_mut.io
            expect(true).to_equal(true)

        it "allows test in path":
            use std.test.helpers
            expect(true).to_equal(true)
