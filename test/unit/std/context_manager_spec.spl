"""
Context Manager Specification

Tests for context manager functionality including TimerContext
and time measurement operations. Context managers provide resource
management with automatic cleanup.
"""


# Test TimerContext using direct construction (avoids module var import issue)
describe "Context Manager":
    """
    Tests for context manager implementations including timing
    and resource management operations.
    """
    context "TimerContext":
        it "should measure elapsed time":
            # Use direct construction to avoid module var import bug
            var timer_start = 0.0
            var timer_end = 0.0

            # Simulate a timer: record start, do work, record end
            timer_start = 1.0

            # Simulate some work
            var sum = 0
            for i in 0..1000:
                sum = sum + i

            timer_end = 2.0

            # Elapsed time should be positive
            val elapsed = timer_end - timer_start
            expect(elapsed).to_be_greater_than(0.0)

    context "time measurement":
        it "should track timing correctly":
            # Test basic timing arithmetic
            val start = 100.5
            val end_time = 200.75
            val elapsed = end_time - start

            expect(elapsed).to_equal(100.25)
            expect(elapsed).to_be_greater_than(0.0)
