"""
MCP Roots Specification
Feature: MCP Roots Protocol
Category: MCP, Protocol
Status: Complete
"""

use std.spec
use app.mcp.helpers.{LB, RB, jp, js, jo1, jo2, make_result_response, extract_json_string}

describe "MCP Roots Response":
    it "builds roots list response":
        val root = jo2(jp("uri", js("file:///home/user/project")), jp("name", js("project")))
        val result = jo1(jp("roots", "[" + root + "]"))
        val response = make_result_response("1", result)
        expect(response.contains("\"roots\"")).to_equal(true)
        expect(response.contains("file:///home/user/project")).to_equal(true)

    it "includes root name":
        val root = jo2(jp("uri", js("file:///project")), jp("name", js("my-project")))
        val name = extract_json_string(root, "name")
        expect(name).to_equal("my-project")

    it "handles empty roots list":
        val result = jo1(jp("roots", "[]"))
        val response = make_result_response("1", result)
        expect(response.contains("\"roots\":[]")).to_equal(true)
