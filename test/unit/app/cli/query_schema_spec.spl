# Query Schema Specification
#
# **Feature IDs:** #QS-001 to #QS-006
# **Category:** Tooling
# **Difficulty:** 1/5
# **Status:** Implemented
#
# ## Overview
# Tests for query schema discovery tool.
# Validates that schema lists node types, predicates, and examples.

use std.spec

# ============================================================================
# Test Group 1: AST schema content
# ============================================================================

describe "ast schema content":
    it "defines node kinds":
        val kinds = ["function", "class", "struct", "enum", "trait", "impl", "import", "field", "val", "var", "*"]
        expect(kinds.len()).to_equal(11)
        expect(kinds).to_contain("function")
        expect(kinds).to_contain("*")

    it "defines predicates":
        val preds = ["name", "return_type", "params", "type", "module", "parent", "kind", "signature", "trait", "visibility"]
        expect(preds.len()).to_equal(10)
        expect(preds).to_contain("name")
        expect(preds).to_contain("return_type")

# ============================================================================
# Test Group 2: Semantic schema content
# ============================================================================

describe "semantic schema content":
    it "defines targets":
        val targets = ["fn", "class", "struct", "enum", "trait", "impl", "import", "type", "field", "val", "var", "*"]
        expect(targets.len()).to_equal(12)
        expect(targets).to_contain("fn")
        expect(targets).to_contain("type")

    it "defines comparison operators":
        val ops = ["=", "!=", ">", "<", ">=", "<=", "starts_with", "ends_with", "contains"]
        expect(ops.len()).to_equal(9)
        expect(ops).to_contain("starts_with")

    it "defines function predicates":
        val fn_preds = ["calls", "has_method", "implements", "imports"]
        expect(fn_preds.len()).to_equal(4)
        expect(fn_preds).to_contain("calls")
        expect(fn_preds).to_contain("implements")

    it "defines numeric fields":
        val numeric = ["param_count", "field_count"]
        expect(numeric.len()).to_equal(2)
        expect(numeric).to_contain("param_count")
        expect(numeric).to_contain("field_count")
