# Tests for app.io.string_helpers module
# Covers hex/byte conversion and text hashing

use app.io.string_helpers.{hex_to_char, byte_to_char, char_code, text_hash_native}

describe "app.io.string_helpers":
    describe "hex_to_char":
        it "converts ASCII codes":
            expect(hex_to_char(65)).to_equal("A")
            expect(hex_to_char(97)).to_equal("a")
            expect(hex_to_char(48)).to_equal("0")

        it "converts zero":
            val result = hex_to_char(0)
            expect(result.len()).to_be_greater_than(0)

    describe "byte_to_char":
        it "is alias for hex_to_char":
            expect(byte_to_char(65)).to_equal("A")
            expect(byte_to_char(90)).to_equal("Z")

    describe "char_code":
        it "returns 0 for empty string":
            expect(char_code("")).to_equal(0)

    describe "text_hash_native":
        it "returns consistent hash":
            val h1 = text_hash_native("hello")
            val h2 = text_hash_native("hello")
            expect(h1).to_equal(h2)

        it "returns different hashes for different lengths":
            val h1 = text_hash_native("a")
            val h2 = text_hash_native("ab")
            val same = h1 == h2
            expect(same).to_equal(false)

        it "handles empty string":
            val h = text_hash_native("")
            expect(h).to_be_greater_than(0)
