use app.test_runner_new.test_db_core (TestDatabase)
use app.test_runner_new.test_db_types.*
use app.test_runner_new.test_db_validation (validate_run_record)

describe "debug":
    it "first - uses db":
        var db = TestDatabase.empty()
        db.update_test_result(
            test_name: "t",
            test_file: "f",
            suite_name: "s",
            category: "unit",
            status: TestStatus.Passed,
            duration_ms: 1.0
        )
        expect(db.tests.len()).to_be(1)

    it "second - validate":
        val r = RunRecord(
            run_id: "",
            start_time: "invalid",
            end_time: "invalid",
            pid: -1,
            hostname: "",
            status: "BadStatus",
            test_count: 0,
            passed: 10,
            failed: 10,
            crashed: 0,
            timed_out: 0
        )
        val report = validate_run_record(r)
        expect(report.has_violations()).to_be(true)
