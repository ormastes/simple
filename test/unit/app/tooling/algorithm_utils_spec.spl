# Algorithm Utilities Tests
#
# Tests for sorting algorithms, searching algorithms, list manipulation,
# and utility functions for working with i64 lists.
#
# Feature:
# Algorithm utility functions
#
# Category:
# Tooling/Algorithms
#
# Status:
# Complete

use std.algorithm_utils.{
    is_sorted, lists_equal, swap,
    bubble_sort, selection_sort, insertion_sort, quick_sort, merge_sort, merge_sorted,
    linear_search, binary_search, find_min, find_max, find_min_index, find_max_index,
    reverse_list, take, drop, sum, count_occurrences, find_all_indices,
    remove_duplicates, is_prefix, is_suffix, find_sublist
}

# =====================================
# BDD Tests
# =====================================

describe "Algorithm Utilities":
    # Comprehensive tests for algorithm utility functions covering sorting algorithms,
    # search algorithms, list manipulation, and statistical operations on i64 lists.

    describe "Sorting":
        it "bubble sort works":
            val unsorted = [3, 1, 4, 1, 5, 9, 2, 6]
            val sorted = bubble_sort(unsorted)
            expect is_sorted(sorted)
            expect sorted[0] == 1

        it "selection sort works":
            val unsorted = [64, 25, 12, 22, 11]
            val sorted = selection_sort(unsorted)
            expect is_sorted(sorted)
            expect sorted[0] == 11

        it "insertion sort works":
            val unsorted = [12, 11, 13, 5, 6]
            val sorted = insertion_sort(unsorted)
            expect is_sorted(sorted)
            expect sorted[0] == 5

        it "quick sort works":
            val unsorted = [10, 7, 8, 9, 1, 5]
            val sorted = quick_sort(unsorted)
            expect is_sorted(sorted)
            expect sorted[0] == 1

        it "merge sort works":
            val unsorted = [38, 27, 43, 3, 9, 82, 10]
            val sorted = merge_sort(unsorted)
            expect is_sorted(sorted)
            expect sorted[0] == 3

        it "merge sorted lists":
            val left = [1, 3, 5]
            val right = [2, 4, 6]
            val merged = merge_sorted(left=left, right=right)
            expect lists_equal(a=merged, b=[1, 2, 3, 4, 5, 6])

        it "is_sorted detects sorted list":
            expect is_sorted([1, 2, 3, 4, 5])

        it "is_sorted detects unsorted list":
            expect not is_sorted([1, 3, 2, 4, 5])

        it "is_sorted handles empty list":
            val empty: [i64] = []
            expect is_sorted(empty)

    describe "Searching":
        it "linear search finds element":
            val list = [10, 20, 30, 40, 50]
            val result = linear_search(list, 30)
            expect result == 2

        it "linear search returns nil for missing":
            val list = [10, 20, 30, 40, 50]
            val result = linear_search(list, 25)
            expect result == nil

        it "binary search finds element":
            val list = [1, 3, 5, 7, 9, 11, 13]
            val result = binary_search(list, 7)
            expect result == 3

        it "binary search returns nil for missing":
            val list = [1, 3, 5, 7, 9, 11, 13]
            val result = binary_search(list, 6)
            expect result == nil

        it "find_min returns minimum":
            val list = [5, 2, 8, 1, 9]
            val result = find_min(list)
            expect result == 1

        it "find_max returns maximum":
            val list = [5, 2, 8, 1, 9]
            val result = find_max(list)
            expect result == 9

        it "find_min_index returns correct index":
            val list = [5, 2, 8, 1, 9]
            val result = find_min_index(list)
            expect result == 3

        it "find_max_index returns correct index":
            val list = [5, 2, 8, 1, 9]
            val result = find_max_index(list)
            expect result == 4

    describe "List Manipulation":
        it "reverse_list works":
            val list = [1, 2, 3, 4, 5]
            val reversed = reverse_list(list)
            expect lists_equal(a=reversed, b=[5, 4, 3, 2, 1])

        it "take gets first n elements":
            val list = [1, 2, 3, 4, 5]
            val taken = take(list, 3)
            expect lists_equal(a=taken, b=[1, 2, 3])

        it "drop removes first n elements":
            val list = [1, 2, 3, 4, 5]
            val dropped = drop(list, 2)
            expect lists_equal(a=dropped, b=[3, 4, 5])

        it "remove_duplicates works":
            val list = [1, 2, 2, 3, 3, 3, 4]
            val unique = remove_duplicates(list)
            expect lists_equal(a=unique, b=[1, 2, 3, 4])

    describe "Statistics":
        it "sum calculates total":
            val list = [1, 2, 3, 4, 5]
            expect sum(list) == 15

        it "sum of empty list is 0":
            val list: [i64] = []
            expect sum(list) == 0

    describe "Comparisons":
        it "lists_equal returns true for equal lists":
            expect lists_equal(a=[1, 2, 3], b=[1, 2, 3])

        it "lists_equal returns false for different lists":
            expect not lists_equal(a=[1, 2, 3], b=[1, 2, 4])

        it "is_prefix works":
            expect is_prefix(prefix=[1, 2], list=[1, 2, 3, 4])

        it "is_suffix works":
            expect is_suffix(suffix=[3, 4], list=[1, 2, 3, 4])

        it "count_occurrences works":
            val list = [1, 2, 2, 3, 2, 4]
            expect count_occurrences(list, 2) == 3

        it "find_all_indices works":
            val list = [1, 2, 2, 3, 2, 4]
            val indices = find_all_indices(list, 2)
            expect lists_equal(a=indices, b=[1, 2, 4])

    describe "Edge Cases":
        it "sort empty list":
            val empty: [i64] = []
            val sorted = quick_sort(empty)
            expect sorted.len() == 0

        it "sort single element":
            val single = [42]
            val sorted = merge_sort(single)
            expect lists_equal(a=sorted, b=[42])

        it "take more than length":
            val list = [1, 2, 3]
            val taken = take(list, 10)
            expect lists_equal(a=taken, b=[1, 2, 3])

        it "drop more than length":
            val list = [1, 2, 3]
            val dropped = drop(list, 10)
            expect dropped.len() == 0
