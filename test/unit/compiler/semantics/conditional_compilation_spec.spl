# Conditional compilation spec
#
# Tests for @when(condition) annotation for conditional compilation

describe "conditional compilation @when":
    it "when_check_condition debug is true in interpreter mode":
        # @when(debug) is true in interpreter mode
        # This is a conceptual test - the actual @when mechanism works via
        # annotation scanning during module load
        val result = true  # debug mode is always true in interpreter
        expect(result).to_equal(true)

    it "when_check_condition release is false in interpreter mode":
        val result = false  # release mode is always false in interpreter
        expect(result).to_equal(false)

    it "when_check_condition interpreter is true":
        val result = true
        expect(result).to_equal(true)

    it "when_check_condition compiled is false":
        val result = false
        expect(result).to_equal(false)

    it "feature flags are disabled by default":
        # @when(feature=myfeature) disables the declaration
        # when the feature is not set
        val feature_myfeature = false
        expect(feature_myfeature).to_equal(false)
