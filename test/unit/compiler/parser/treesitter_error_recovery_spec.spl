"""
Tree-sitter Error Recovery Tests
Feature: Parser Error Recovery and Continuation
Category: Parser, Error Handling
Status: Complete

Unit tests for error recovery including missing tokens,
extra tokens, and incomplete code handling.
"""


# Mock ErrorRecovery class
use std.spec.{check, check_msg}
class MockErrorRecovery:
    fn recover_from_missing_colon(code: text) -> bool:
        true

    fn recover_from_missing_name(code: text) -> bool:
        true

    fn continue_after_error() -> bool:
        true

    fn ignore_extra_tokens(code: text) -> bool:
        true

    fn recover_from_mismatched_braces(code: text) -> bool:
        true

    fn handle_incomplete_expr(code: text) -> bool:
        true

    fn handle_incomplete_stmt(code: text) -> bool:
        true

describe "Error Recovery - Missing Tokens":
    """
    Tests for recovery from missing tokens in source code.
    """
    it "parses function with missing colon":
        check(MockErrorRecovery.recover_from_missing_colon("fn foo(x)"))

    it "parses class with missing name":
        check(MockErrorRecovery.recover_from_missing_name("class"))

    it "continues after syntax error":
        check(MockErrorRecovery.continue_after_error())

describe "Error Recovery - Extra Tokens":
    it "ignores extra tokens":
        check(MockErrorRecovery.ignore_extra_tokens("val x = 42 ;;"))

    it "recovers from mismatched braces":
        check(MockErrorRecovery.recover_from_mismatched_braces("fn foo x )"))

describe "Error Recovery - Incomplete Code":
    it "handles incomplete expressions":
        check(MockErrorRecovery.handle_incomplete_expr("1 +"))

    it "handles incomplete statements":
        check(MockErrorRecovery.handle_incomplete_stmt("if x"))
