"""
# AST Debug Specification

**Feature IDs:** #TBD
**Category:** Compiler
**Status:** In Progress

## Overview

Tests that AST function nodes have the expected name and structure
after parsing a simple function.
"""

use std.spec
use compiler.core.parser.*
use compiler.parser_types.*
use compiler.core.lexer.*
use compiler.blocks.*
use compiler.treesitter.*


describe "AST Debug":
    it "parsed function has name 'main'":
        val source = "fn main() -> i64:\n    0\n"
        var parser = Parser.new(source)
        val ast_module = parser.parse()
        var fn_name = ""
        for name in ast_module.functions.keys():
            fn_name = name
        expect(fn_name).to_equal("main")

    it "parsed function has 0 parameters":
        val source = "fn main() -> i64:\n    0\n"
        var parser = Parser.new(source)
        val ast_module = parser.parse()
        for name in ast_module.functions.keys():
            val fn_ = ast_module.functions[name]
            expect(fn_.params.len()).to_equal(0)
