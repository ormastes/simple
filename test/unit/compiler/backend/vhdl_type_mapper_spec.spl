describe "Vhdl Type Mapper":
    it "skipped":
        skip("pre-existing test failures - functions/imports not available")

# # VHDL Type Mapper Specification
# #
# # Tests for VhdlTypeMapper: mapping Simple/MIR types to VHDL type strings.
# 
# # # VHDL Type Mapper Specification
# #
# # **Feature IDs:** #vhdl-type-mapper
# # **Category:** Backend
# # **Difficulty:** 3/5
# # **Status:** In Progress
# #
# # ## Overview
# #
# # Tests VhdlTypeMapper which maps MIR primitive types, arrays, records,
# # enums, and port directions to VHDL-2008 type strings using ieee.numeric_std.
# #
# # ## Related Files
# # - `src/compiler/backend/vhdl_type_mapper.spl` - Type mapper implementation
# 
# use compiler.backend.vhdl_type_mapper.VhdlTypeMapper
# use compiler.mir_data.{PrimitiveType, VhdlPortDirection, MirType}
# fn check(condition: bool):
#     expect(condition).to_equal(true)
# fn check_msg(condition: bool, message: text):
#     if not condition:
#         expect(message).to_equal("")
# 
# # ============================================================================
# # Primitive Type Mapping
# # ============================================================================
# 
# describe "VhdlTypeMapper primitive mapping":
#     # ## Primitive Type Mapping
#     #
#     # Maps Simple primitive types to VHDL ieee.numeric_std types.
# 
#     context "signed integer types":
#         it "maps I64 to signed(63 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.I64)
#             expect(result).to_equal("signed(63 downto 0)")
# 
#         it "maps I32 to signed(31 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.I32)
#             expect(result).to_equal("signed(31 downto 0)")
# 
#         it "maps I16 to signed(15 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.I16)
#             expect(result).to_equal("signed(15 downto 0)")
# 
#         it "maps I8 to signed(7 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.I8)
#             expect(result).to_equal("signed(7 downto 0)")
# 
#     context "unsigned integer types":
#         it "maps U64 to unsigned(63 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.U64)
#             expect(result).to_equal("unsigned(63 downto 0)")
# 
#         it "maps U32 to unsigned(31 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.U32)
#             expect(result).to_equal("unsigned(31 downto 0)")
# 
#         it "maps U16 to unsigned(15 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.U16)
#             expect(result).to_equal("unsigned(15 downto 0)")
# 
#         it "maps U8 to unsigned(7 downto 0)":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.U8)
#             expect(result).to_equal("unsigned(7 downto 0)")
# 
#     context "boolean type (unresolved)":
#         it "maps Bool to bit when unresolved":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.Bool)
#             expect(result).to_equal("bit")
# 
#     context "boolean type (resolved)":
#         it "maps Bool to std_logic when resolved":
#             val mapper = VhdlTypeMapper__create_resolved()
#             val result = mapper.map_primitive(PrimitiveType.Bool)
#             expect(result).to_equal("std_logic")
# 
#     context "unsynthesizable types":
#         it "maps F64 to error comment":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.F64)
#             check(result.contains("ERROR"))
#             check(result.contains("f64"))
# 
#         it "maps F32 to error comment":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.F32)
#             check(result.contains("ERROR"))
#             check(result.contains("f32"))
# 
#         it "maps F16 to error comment":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.F16)
#             check(result.contains("ERROR"))
# 
#     context "unit type":
#         it "maps Unit to void comment":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_primitive(PrimitiveType.Unit)
#             check(result.contains("void"))
# 
# # ============================================================================
# # VHDL-Specific Methods
# # ============================================================================
# 
# describe "VhdlTypeMapper VHDL-specific methods":
#     # ## VHDL-Specific Type Helpers
#     #
#     # Tests for signed, unsigned, integer range, std_logic_vector, bit_vector.
# 
#     context "explicit width mapping":
#         it "maps signed with custom width":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.map_signed(16)).to_equal("signed(15 downto 0)")
# 
#         it "maps unsigned with custom width":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.map_unsigned(8)).to_equal("unsigned(7 downto 0)")
# 
#         it "maps std_logic_vector with width":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.map_std_logic_vector(32)).to_equal("std_logic_vector(31 downto 0)")
# 
#         it "maps bit_vector with width":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.map_bit_vector(16)).to_equal("bit_vector(15 downto 0)")
# 
#     context "integer range mapping":
#         it "maps integer range":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.map_integer_range(0, 255)).to_equal("integer range 0 to 255")
# 
#         it "maps negative integer range":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.map_integer_range(-128, 127)).to_equal("integer range -128 to 127")
# 
# # ============================================================================
# # Composite Types
# # ============================================================================
# 
# describe "VhdlTypeMapper composite types":
#     # ## Composite Types
#     #
#     # Records, enums, and arrays.
# 
#     context "record types":
#         it "maps struct fields to VHDL record":
#             val mapper = VhdlTypeMapper__create()
#             val fields = [("x", "signed(31 downto 0)"), ("y", "signed(31 downto 0)")]
#             val result = mapper.map_record(fields)
#             check(result.contains("record"))
#             check(result.contains("x : signed(31 downto 0);"))
#             check(result.contains("y : signed(31 downto 0);"))
#             check(result.contains("end record"))
# 
#         it "maps single-field record":
#             val mapper = VhdlTypeMapper__create()
#             val fields = [("data", "unsigned(7 downto 0)")]
#             val result = mapper.map_record(fields)
#             check(result.contains("record"))
#             check(result.contains("data : unsigned(7 downto 0);"))
#             check(result.contains("end record"))
# 
#     context "enum types":
#         it "maps enum variants to VHDL enumeration":
#             val mapper = VhdlTypeMapper__create()
#             val variants = ["Idle", "Running", "Done"]
#             val result = mapper.map_enum_type(variants)
#             expect(result).to_equal("(Idle, Running, Done)")
# 
#         it "maps single variant enum":
#             val mapper = VhdlTypeMapper__create()
#             val variants = ["Reset"]
#             val result = mapper.map_enum_type(variants)
#             expect(result).to_equal("(Reset)")
# 
#     context "array types":
#         it "maps fixed-size array":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_array_type("signed(31 downto 0)", 8)
#             expect(result).to_equal("array (0 to 7) of signed(31 downto 0)")
# 
#         it "maps single-element array":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_array_type("bit", 1)
#             expect(result).to_equal("array (0 to 0) of bit")
# 
# # ============================================================================
# # Port Directions
# # ============================================================================
# 
# describe "VhdlTypeMapper port directions":
#     it "maps In direction":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.map_port_direction(VhdlPortDirection.In)).to_equal("in")
# 
#     it "maps Out direction":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.map_port_direction(VhdlPortDirection.Out)).to_equal("out")
# 
#     it "maps InOut direction":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.map_port_direction(VhdlPortDirection.InOut)).to_equal("inout")
# 
#     it "maps Buffer direction":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.map_port_direction(VhdlPortDirection.Buffer)).to_equal("buffer")
# 
# # ============================================================================
# # Bit Type Helpers
# # ============================================================================
# 
# describe "VhdlTypeMapper bit type helpers":
#     context "unresolved mode":
#         it "returns bit for single-bit type":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.bit_type()).to_equal("bit")
# 
#         it "returns bit_vector for vector type":
#             val mapper = VhdlTypeMapper__create()
#             expect(mapper.bit_vector_type(8)).to_equal("bit_vector(7 downto 0)")
# 
#     context "resolved mode":
#         it "returns std_logic for single-bit type":
#             val mapper = VhdlTypeMapper__create_resolved()
#             expect(mapper.bit_type()).to_equal("std_logic")
# 
#         it "returns std_logic_vector for vector type":
#             val mapper = VhdlTypeMapper__create_resolved()
#             expect(mapper.bit_vector_type(8)).to_equal("std_logic_vector(7 downto 0)")
# 
# # ============================================================================
# # Width Queries
# # ============================================================================
# 
# describe "VhdlTypeMapper width queries":
#     it "returns 64 for I64 and U64":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.width_of_type(PrimitiveType.I64)).to_equal(64)
#         expect(mapper.width_of_type(PrimitiveType.U64)).to_equal(64)
# 
#     it "returns 32 for I32 and U32":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.width_of_type(PrimitiveType.I32)).to_equal(32)
#         expect(mapper.width_of_type(PrimitiveType.U32)).to_equal(32)
# 
#     it "returns 16 for I16 and U16":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.width_of_type(PrimitiveType.I16)).to_equal(16)
#         expect(mapper.width_of_type(PrimitiveType.U16)).to_equal(16)
# 
#     it "returns 8 for I8 and U8":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.width_of_type(PrimitiveType.I8)).to_equal(8)
#         expect(mapper.width_of_type(PrimitiveType.U8)).to_equal(8)
# 
#     it "returns 1 for Bool":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.width_of_type(PrimitiveType.Bool)).to_equal(1)
# 
#     it "returns 0 for unsupported types":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.width_of_type(PrimitiveType.F64)).to_equal(0)
# 
# # ============================================================================
# # Synthesizability Checks
# # ============================================================================
# 
# describe "VhdlTypeMapper synthesizability":
#     it "marks integer types as synthesizable":
#         val mapper = VhdlTypeMapper__create()
#         check(mapper.is_synthesizable(PrimitiveType.I32))
#         check(mapper.is_synthesizable(PrimitiveType.U32))
#         check(mapper.is_synthesizable(PrimitiveType.I8))
#         check(mapper.is_synthesizable(PrimitiveType.U64))
# 
#     it "marks Bool as synthesizable":
#         val mapper = VhdlTypeMapper__create()
#         check(mapper.is_synthesizable(PrimitiveType.Bool))
# 
#     it "marks float types as not synthesizable":
#         val mapper = VhdlTypeMapper__create()
#         check(not mapper.is_synthesizable(PrimitiveType.F16))
#         check(not mapper.is_synthesizable(PrimitiveType.F32))
#         check(not mapper.is_synthesizable(PrimitiveType.F64))
# 
# # ============================================================================
# # Backend Metadata
# # ============================================================================
# 
# describe "VhdlTypeMapper metadata":
#     it "returns VHDL as backend name":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.backend_name()).to_equal("VHDL")
# 
#     it "does not support half precision":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.supports_half_precision()).to_equal(false)
# 
#     it "does not support GPU":
#         val mapper = VhdlTypeMapper__create()
#         expect(mapper.supports_gpu()).to_equal(false)
# 
# # ============================================================================
# # Vector Type Mapping
# # ============================================================================
# 
# describe "VhdlTypeMapper vector types":
#     context "unresolved mode":
#         it "maps vector to bit_vector":
#             val mapper = VhdlTypeMapper__create()
#             val result = mapper.map_vector_type("bit", 16)
#             expect(result).to_equal("bit_vector(15 downto 0)")
# 
#     context "resolved mode":
#         it "maps vector to std_logic_vector":
#             val mapper = VhdlTypeMapper__create_resolved()
#             val result = mapper.map_vector_type("std_logic", 16)
#             expect(result).to_equal("std_logic_vector(15 downto 0)")
# 
# # ============================================================================
# # Pointer Mapping (Not Synthesizable)
# # ============================================================================
# 
# describe "VhdlTypeMapper pointer mapping":
#     it "maps pointers to error comment":
#         val mapper = VhdlTypeMapper__create()
#         val result = mapper.map_pointer("signed(31 downto 0)", Mutability.Immutable)
#         check(result.contains("ERROR"))
#         check(result.contains("pointer"))
