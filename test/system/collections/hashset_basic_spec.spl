# HashSet Basic System Tests
"""
## System Test: HashSet Basic Operations

**Integration Scope:** HashSet + Collections FFI
**Complexity:** Low
**Coverage Impact:** hashset.rs (0%â†’40%), collections FFI

Tests basic HashSet operations through the FFI layer.
"""

import std.spec
import collections.{HashSet}

describe "HashSet basic operations":
    context "Creation and insertion":
        it "creates new HashSet":
            val set = HashSet.new()

            expect(set).not_to(be_nil())
            expect(set.is_empty()).to(be_true())

        it "inserts elements":
            val set = HashSet.new()
            set.insert(1)
            set.insert(2)
            set.insert(3)

            expect(set.len()).to(eq(3))
            expect(set.contains(1)).to(be_true())
            expect(set.contains(2)).to(be_true())

        it "handles duplicate insertions":
            val set = HashSet.new()
            set.insert("apple")
            set.insert("apple")

            expect(set.len()).to(eq(1))

    context "Membership testing":
        it "checks if element exists":
            val set = HashSet.new()
            set.insert("exists")

            expect(set.contains("exists")).to(be_true())
            expect(set.contains("missing")).to(be_false())

        it "removes elements":
            val set = HashSet.new()
            set.insert(42)

            val removed = set.remove(42)
            expect(removed).to(be_true())
            expect(set.contains(42)).to(be_false())

    context "Collection operations":
        it "clears all elements":
            val set = HashSet.new()
            set.insert(1)
            set.insert(2)
            set.insert(3)

            set.clear()
            expect(set.is_empty()).to(be_true())
            expect(set.len()).to(eq(0))

        it "converts to array":
            val set = HashSet.new()
            set.insert("a")
            set.insert("b")
            set.insert("c")

            val arr = set.to_array()
            expect(arr.len()).to(eq(3))
