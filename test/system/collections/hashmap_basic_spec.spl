"""
# HashMap Basic Operations Specification

**Category:** Stdlib
**Status:** Implemented

System tests for basic HashMap operations through the FFI layer.
Tests creation, insertion, retrieval, and collection operations.

## Integration Scope

HashMap + Collections FFI

## Complexity

Low

## Coverage Impact

hashmap.rs (0%â†’40%), collections FFI
"""

use collections.hashmap.HashMap

describe "HashMap Basic Operations":
    """
    Verifies basic HashMap functionality through the FFI layer.
    Covers creation, insertion, retrieval, key operations, and collection methods.
    """

    describe "Creation and insertion":
        """
        Tests HashMap initialization and basic insert/retrieve operations.
        """

        it "creates new HashMap":
            var map = HashMap.new()

            expect(map).not_to(be_nil())
            expect(map.is_empty()).to(be_true())

        it "inserts and retrieves values":
            var map = HashMap.new()
            map.insert("key1", "value1")

            val result = map.get("key1")
            expect(result).to(eq("value1"))

        it "handles multiple insertions":
            var map = HashMap.new()
            map.insert("a", 1)
            map.insert("b", 2)
            map.insert("c", 3)

            expect(map.len()).to(eq(3))
            expect(map.get("a")).to(eq(1))
            expect(map.get("b")).to(eq(2))
            expect(map.get("c")).to(eq(3))

    describe "Key operations":
        """
        Tests key-related operations like existence checks and removal.
        """

        it "checks if key exists":
            var map = HashMap.new()
            map.insert("exists", "yes")

            expect(map.contains_key("exists")).to(be_true())
            expect(map.contains_key("missing")).to(be_false())

        it "removes keys":
            var map = HashMap.new()
            map.insert("key", "value")

            val removed = map.remove("key")
            expect(removed).to(eq("value"))
            expect(map.contains_key("key")).to(be_false())

        it "gets all keys":
            var map = HashMap.new()
            map.insert("k1", "v1")
            map.insert("k2", "v2")

            val keys = map.keys()
            expect(keys.len()).to(eq(2))

    describe "Collection methods":
        """
        Tests collection-level operations like clear and values retrieval.
        """

        it "clears all entries":
            var map = HashMap.new()
            map.insert("a", 1)
            map.insert("b", 2)

            map.clear()
            expect(map.is_empty()).to(be_true())
            expect(map.len()).to(eq(0))

        it "gets all values":
            var map = HashMap.new()
            map.insert("k1", 100)
            map.insert("k2", 200)

            val values = map.values()
            expect(values.len()).to(eq(2))
