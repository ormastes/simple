# @pending
"""
BTreeMap Basic Operations System Test

**Feature:** Collections.BTreeMap
**Category:** System/Collections
**Status:** Active

## Description

Integration tests for BTreeMap (ordered map) basic operations through the FFI layer.

Tests cover:
- Map creation and initialization
- Key-value insertion and retrieval
- Key ordering maintenance
- Key existence checking and removal
- Collection mutations (clear)
- Array/collection views (keys, values)

**Integration Scope:** BTreeMap + Collections FFI
**Complexity:** Low
**Coverage Impact:** btreemap.rs (0%â†’40%), collections FFI
"""

use collections.btreemap.BTreeMap

describe "BTreeMap basic operations":
    """
    System-level tests for BTreeMap operations.

    Validates BTreeMap maintains sorted order while supporting
    insertion, retrieval, removal, and iteration through the Rust FFI layer.
    """

    context "Creation and insertion":
        it "creates new BTreeMap":
            val map = BTreeMap.new()

            expect(map).not_to(be_nil())
            expect(map.is_empty()).to(be_true())

        it "inserts and retrieves values":
            var map = BTreeMap.new()
            map.insert("key1", "value1")

            val result = map.get("key1")
            expect(result).to(eq("value1"))

        it "maintains sorted order":
            var map = BTreeMap.new()
            map.insert("c", 3)
            map.insert("a", 1)
            map.insert("b", 2)

            val keys = map.keys()
            expect(keys.len()).to(eq(3))
            # Keys should be sorted

    context "Key operations":
        it "checks if key exists":
            var map = BTreeMap.new()
            map.insert("exists", "yes")

            expect(map.contains_key("exists")).to(be_true())
            expect(map.contains_key("missing")).to(be_false())

        it "removes keys":
            var map = BTreeMap.new()
            map.insert("key", "value")

            val removed = map.remove("key")
            expect(removed).to(eq("value"))
            expect(map.contains_key("key")).to(be_false())

    context "Collection methods":
        it "clears all entries":
            var map = BTreeMap.new()
            map.insert("a", 1)
            map.insert("b", 2)

            map.clear()
            expect(map.is_empty()).to(be_true())

        it "gets all values":
            var map = BTreeMap.new()
            map.insert(1, 100)
            map.insert(2, 200)

            val values = map.values()
            expect(values.len()).to(eq(2))
