"""
# Named Arguments Specification

**Feature ID:** #NAMED-ARGS-001
**Category:** Language | Functions
**Status:** Implemented

## Overview

Tests for named argument support allowing function calls with explicit
parameter names, improving code clarity and enabling flexible argument ordering.

## Syntax

```simple
fn create_user(name: str, email: str, age: i64) -> User:
    User(name: name, email: email, age: age)

# Call with positional arguments
val user1 = create_user("Alice", "alice@example.com", 30)

# Call with named arguments
val user2 = create_user(age=25, name="Bob", email="bob@example.com")

# Mixed positional and named
val user3 = create_user("Charlie", email="charlie@example.com", age=35)
```

## Key Concepts

| Concept | Description |
|---------|-------------|
| Named Argument | Explicitly passing parameter by name |
| Positional Argument | Passing argument by position order |
| Argument Reordering | Non-positional order with named arguments |
| Default Values | Optional parameters with defaults |
| Clarity | Improved code readability with explicit parameter names |

## Behavior

- Named arguments can be passed in any order
- Positional arguments must precede named arguments (if mixed)
- Parameter names are part of the function signature
- Type checking applies to named arguments like positional
- Named arguments cannot be repeated in a single call
- Works with constructors and regular functions
"""

use std.spec


# ============================================================================
# Test Group 1: Basic Named Arguments
# ============================================================================

describe "Named Arguments Basic Usage":
    """
    ## Named Parameter Passing

    Verifies that functions accept named arguments and properly
    map them to their corresponding parameters.
    """

    it "calls function with named arguments":
        fn greet(name, greeting):
            return 1
        expect greet(name="world", greeting="hello") == 1

    it "passes values correctly with named arguments":
        fn add(a, b):
            return a + b
        expect add(a=10, b=20) == 30

    it "works with string values":
        fn concat(first, second):
            return first + second
        val result = concat(first="Hello", second=" World")
        var r = 0
        if result == "Hello World":
            r = 1
        expect r == 1


# ============================================================================
# Test Group 2: Named Argument Reordering
# ============================================================================

describe "Named Arguments Reordering":
    """
    ## Argument Reordering

    Tests that named arguments can be passed in any order,
    regardless of parameter definition order.
    """

    it "allows reversed argument order":
        fn sub(a, b):
            return a - b
        expect sub(b=10, a=30) == 20

    it "reorders three arguments":
        fn calc(x, y, z):
            return x + y * z
        expect calc(z=4, x=2, y=3) == 14

    it "reorders with different calculation":
        fn compute(first, second, third):
            return first * 100 + second * 10 + third
        expect compute(third=3, first=1, second=2) == 123


# ============================================================================
# Test Group 3: Mixed Positional and Named Arguments
# ============================================================================

describe "Mixed Positional and Named Arguments":
    """
    ## Mixing Argument Styles

    Tests combining positional arguments with named arguments
    in the same function call.
    """

    it "mixes positional and named arguments":
        fn calc(x, y, z):
            return x + y * z
        expect calc(2, z=4, y=3) == 14

    it "uses positional first then named":
        fn process(a, b, c):
            return a * b + c
        expect process(5, c=7, b=3) == 22

    it "uses single positional with multiple named":
        fn combine(base, mult, add):
            return base * mult + add
        expect combine(10, add=5, mult=2) == 25


# ============================================================================
# Test Group 4: Named Arguments with Default Values
# ============================================================================

describe "Named Arguments with Defaults":
    """
    ## Default Parameter Values

    Tests named arguments combined with default parameter values.
    """

    it "uses default when argument not provided":
        fn add(a, b=10):
            return a + b
        expect add(5) == 15

    it "overrides default with named argument":
        fn add(a, b=10):
            return a + b
        expect add(5, b=20) == 25

    it "works with multiple defaults":
        fn calculate(x, y=2, z=3):
            return x + y * z
        expect calculate(1) == 7
        expect calculate(1, y=5) == 16
        expect calculate(1, z=10) == 21


# ============================================================================
# Test Group 5: Named Arguments in Method Calls
# ============================================================================

describe "Named Arguments in Methods":
    """
    ## Method Calls with Named Arguments

    Tests named arguments when calling methods on objects.
    """

    it "uses named arguments with class methods":
        class Calculator:
            fn compute(self, a, b):
                return a * b

        val calc = Calculator {}
        expect calc.compute(a=6, b=7) == 42

    it "reorders method arguments":
        class Math:
            fn subtract(self, minuend, subtrahend):
                return minuend - subtrahend

        val m = Math {}
        expect m.subtract(subtrahend=15, minuend=50) == 35


# ============================================================================
# Test Group 6: Named Arguments Edge Cases
# ============================================================================

describe "Named Arguments Edge Cases":
    """
    ## Special Cases

    Tests edge cases and boundary conditions for named arguments.
    """

    it "handles single named argument":
        fn identity(x):
            return x
        expect identity(x=42) == 42

    it "handles many named arguments":
        fn sum5(a, b, c, d, e):
            return a + b + c + d + e
        expect sum5(e=5, d=4, c=3, b=2, a=1) == 15

    it "works with nested function calls":
        fn double(x):
            return x * 2
        fn add(a, b):
            return a + b
        expect add(a=double(x=5), b=double(x=3)) == 16
