# @pending
# @skip - Uses unsupported keyword: with
"""
# Assert Statement Specification

**Feature IDs:** #ASSERT-001 to #ASSERT-012
**Category:** Language | Contracts
**Status:** Implemented

Tests assert statement support including:
- Basic assert with boolean condition
- Assert with custom error message
- Assert in functions
- Assert with expressions and boolean logic
- Assert in control flow (if blocks, loops)
- Assert combined with function contracts

## Syntax

```simple
# Basic assert
expect(x > 0).to_equal(true)

# Assert with message
expect(x > 0, "x must be positive").to_equal(true)

# Assert in function
fn validate(x: i64) -> i64:
    expect(x >= 0, "input must be non-negative").to_equal(true)
    x * 2
```
"""



# ============================================================================
# Test Group 1: Basic Assert
# ============================================================================

describe "Basic Assert Statement":
    """
    ## Simple Assertions

    Tests basic assert statement syntax.
    """

    it "basic assert compiles":
        val x = 10
        expect(x > 0).to_equal(true)
        expect x == 10

    it "assert with message compiles":
        val x = 10
        expect(x > 0, "x must be positive").to_equal(true)
        expect x == 10

    it "multiple assert conditions":
        val x = 5
        expect(x < 100).to_equal(true)
        expect(x >= 0, "x must be non-negative").to_equal(true)
        expect x == 5


# ============================================================================
# Test Group 2: Assert in Functions
# ============================================================================

describe "Assert in Functions":
    """
    ## Function Body Assertions

    Tests assert inside function bodies.
    """

    it "assert in function body":
        fn validate_and_compute(x: i64) -> i64:
            expect(x >= 0, "input must be non-negative").to_equal(true)
            expect(x < 1000).to_equal(true)
            x * 2

        expect validate_and_compute(50) == 100

    it "multiple asserts in function":
        fn validate(x: i64, y: i64) -> i64:
            expect(x > 0).to_equal(true)
            expect(y > 0).to_equal(true)
            expect(x).to_not_equal(y, "x and y must be different")
            x + y

        expect validate(10, 20) == 30


# ============================================================================
# Test Group 3: Assert with Expressions
# ============================================================================

describe "Assert with Expressions":
    """
    ## Complex Assert Conditions

    Tests assert with comparison and boolean expressions.
    """

    it "assert with comparison":
        val a = 10
        val b = 20
        expect(a < b).to_equal(true)
        expect(a + b).to_equal(30)
        expect(a * 2).to_equal(b)
        expect true

    it "assert with boolean logic":
        val x = 10
        val y = 20
        expect(x > 0 and y > 0).to_equal(true)
        expect(x < 100 or y < 100).to_equal(true)
        expect(not (x < 0)).to_equal(true)
        expect true


# ============================================================================
# Test Group 4: Assert in Control Flow
# ============================================================================

describe "Assert in Control Flow":
    """
    ## Assertions in Branches and Loops

    Tests assert inside if blocks and loops.
    """

    it "assert in if block":
        fn process(x: i64) -> i64:
            if x > 0:
                expect(x < 1000, "must be under 1000 in positive branch").to_equal(true)
                x * 2
            else:
                expect(x >= -100, "must be at least -100").to_equal(true)
                -x

        expect process(50) == 100

    it "assert in loop":
        fn sum_with_validation(n: i64) -> i64:
            var total = 0
            var i = 0
            while i < n:
                expect(i >= 0, "iteration counter must be non-negative").to_equal(true)
                total = total + i
                i = i + 1
            total

        expect sum_with_validation(5) == 10


# ============================================================================
# Test Group 5: Assert with Contracts
# ============================================================================

describe "Assert with Function Contracts":
    """
    ## Combining Assert and Contracts

    Tests assert used alongside function contracts.
    """

    it "assert combined with contracts":
        fn compute(x: i64) -> i64:
            in:
                x >= 0
            out(ret):
                ret >= x
            # Runtime assertions for additional validation
            expect(x < 1000, "x must be reasonable").to_equal(true)
            x + 10

        expect compute(50) == 60

