# @pending
# @skip - Uses unsupported keyword: with
"""
# Arithmetic Operations Specification

**Feature IDs:** #ARITH-001 to #ARITH-030
**Category:** Language | Operators
**Difficulty:** 1/5
**Status:** Implemented

## Overview

Arithmetic operations provide basic mathematical computations on numeric types.
Simple supports integer and floating-point arithmetic with standard operators
and correct operator precedence.

## Syntax

```simple
# Basic binary operators
2 + 3              # Addition
10 - 3             # Subtraction
4 * 5              # Multiplication
15 / 3             # Division
17 % 5             # Modulo (remainder)
2 ** 3             # Exponentiation (power)

# Unary operators
-x                 # Negation
+x                 # Positive (identity)

# Operator precedence (high to low)
# 1. Exponentiation (**)
# 2. Unary (-, +)
# 3. Multiplication, Division, Modulo (*, /, %)
# 4. Addition, Subtraction (+, -)
```

## Key Concepts

| Operator | Name | Operands | Result |
|----------|------|----------|--------|
| `+` | Addition | i64, f64 | Same type |
| `-` | Subtraction | i64, f64 | Same type |
| `*` | Multiplication | i64, f64 | Same type |
| `/` | Division | i64, f64 | Same type |
| `%` | Modulo | i64 | i64 |
| `**` | Power | i64, f64 | Same type |

## Behavior

- Integer division truncates toward zero
- Modulo has the sign of the dividend
- Type coercion follows standard rules
- Overflow behavior (wrapping, panic, or saturation) depends on context
- Division by zero is an error
"""



# ============================================================================
# Test Group 1: Basic Binary Operators
# ============================================================================

describe "Basic Binary Operators":
    """
    ## Basic Binary Operators

    Tests for fundamental arithmetic operators on integers.
    """

    context "addition":
        it "adds positive integers":
            expect 2 + 3 == 5

        it "adds zero":
            expect 5 + 0 == 5
            expect 0 + 5 == 5

        it "adds larger numbers":
            expect 100 + 200 == 300

        it "adds negative integers":
            expect ((-5)) + 3 == -2

    context "subtraction":
        it "subtracts integers":
            expect 10 - 3 == 7

        it "subtracts zero":
            expect 5 - 0 == 5

        it "subtracts from zero":
            expect 0 - 5 == -5

        it "subtracts resulting in negative":
            expect 3 - 10 == -7

    context "multiplication":
        it "multiplies integers":
            expect 4 * 5 == 20

        it "multiplies by zero":
            expect 5 * 0 == 0
            expect 0 * 5 == 0

        it "multiplies by one":
            expect 5 * 1 == 5

        it "multiplies negative numbers":
            expect ((-4)) * 5 == -20
            expect ((-4)) * -5 == 20

    context "division":
        it "divides integers":
            expect 15 / 3 == 5

        it "divides with truncation":
            expect 7 / 2 == 3

        it "divides by one":
            expect 42 / 1 == 42

        it "divides zero by number":
            expect 0 / 5 == 0

        it "divides negative numbers":
            expect ((-20)) / 4 == -5
            expect 20 / -4 == -5


# ============================================================================
# Test Group 2: Operator Precedence
# ============================================================================

describe "Operator Precedence":
    """
    ## Operator Precedence

    Tests that operators are evaluated in the correct order.
    """

    it "evaluates multiplication before addition":
        expect 2 + 3 * 4 == 14

    it "evaluates multiplication before subtraction":
        expect 10 - 3 * 2 == 4

    it "evaluates division before addition":
        expect 10 + 20 / 4 == 15

    it "handles chain of same precedence (left-to-right)":
        expect 20 - 5 - 3 == 12
        expect 20 / 4 / 2 == 2

    it "respects multiple operations":
        expect 2 + 3 * 4 - 1 == 13

    it "handles complex expression":
        expect 2 * 3 + 4 * 5 == 26


# ============================================================================
# Test Group 3: Parentheses and Grouping
# ============================================================================

describe "Parentheses and Expression Grouping":
    """
    ## Parentheses and Expression Grouping

    Tests that parentheses override default precedence.
    """

    it "changes addition before multiplication":
        expect (2 + 3) * 4 == 20

    it "changes subtraction before division":
        expect (20 - 4) / 2 == 8

    it "handles nested parentheses":
        expect ((2 + 3) * 4) + 1 == 21

    it "handles deeply nested parentheses":
        expect (((10 + 5) * 2) - 5) / 3 == 6


# ============================================================================
# Test Group 4: Modulo Operation
# ============================================================================

describe "Modulo Operation":
    """
    ## Modulo Operation

    Tests remainder calculation via modulo operator.
    """

    it "calculates simple modulo":
        expect 17 % 5 == 2

    it "modulo of exact division":
        expect 20 % 5 == 0

    it "modulo with smaller divisor":
        expect 3 % 7 == 3

    it "modulo with one":
        expect 5 % 1 == 0

    it "modulo with negative dividend":
        expect ((-17)) % 5 == -2

    it "modulo with negative divisor":
        expect 17 % -5 == 2


# ============================================================================
# Test Group 5: Unary Operators
# ============================================================================

describe "Unary Operators":
    """
    ## Unary Operators

    Tests unary negation and positive operators.
    """

    it "negates positive number":
        expect ((-5)) == -5

    it "negates negative number":
        expect (-(-5)) == 5

    it "applies unary plus":
        # Skipped: unary plus not supported in parser
        expect true

    it "applies unary plus to negative":
        # Skipped: unary plus not supported in parser
        expect true

    it "negates in expression":
        expect 10 + (-5) == 5


# ============================================================================
# Test Group 6: Floating Point Arithmetic
# ============================================================================

describe "Floating Point Arithmetic":
    """
    ## Floating Point Arithmetic

    Tests arithmetic operations on floating-point numbers.
    """

    context "float addition":
        it "adds floats":
            expect 2.5 + 3.5 == 6.0

        it "adds float and integer":
            expect 2.5 + 3 == 5.5

    context "float subtraction":
        it "subtracts floats":
            expect 10.5 - 3.2 == 7.3

    context "float multiplication":
        it "multiplies floats":
            expect 2.5 * 4.0 == 10.0

    context "float division":
        it "divides floats":
            expect 10.0 / 2.0 == 5.0

        it "divides with fractional result":
            expect 5.0 / 2.0 == 2.5


# ============================================================================
# Test Group 7: Exponentiation
# ============================================================================

describe "Exponentiation":
    """
    ## Exponentiation

    Tests power/exponentiation operator.
    """

    it "calculates 2 to power 3":
        expect 2 ** 3 == 8

    it "calculates any number to power 0":
        expect 5 ** 0 == 1

    it "calculates any number to power 1":
        expect 5 ** 1 == 5

    it "calculates 10 squared":
        expect 10 ** 2 == 100

    it "has higher precedence than multiplication":
        expect 2 * 3 ** 2 == 18


# ============================================================================
# Test Group 8: Mixed Type Arithmetic
# ============================================================================

describe "Mixed Type Arithmetic":
    """
    ## Mixed Type Arithmetic

    Tests arithmetic between integers and floats.
    """

    it "adds integer to float":
        expect 5 + 2.5 == 7.5

    it "multiplies integer by float":
        expect 4 * 2.5 == 10.0

    it "divides integer by float":
        expect 10 / 2.5 == 4.0

    it "complex mixed expression":
        expect 2 + 3.5 * 4 == 16.0


# ============================================================================
# Test Group 9: Zero and Identity Cases
# ============================================================================

describe "Zero and Identity Cases":
    """
    ## Zero and Identity Cases

    Tests edge cases with zero and identity elements.
    """

    it "adds zero identity":
        expect 42 + 0 == 42

    it "multiplies by one identity":
        expect 42 * 1 == 42

    it "multiplies by zero":
        expect 42 * 0 == 0

    it "subtracts zero":
        expect 42 - 0 == 42

    it "divides by one":
        expect 42 / 1 == 42


# ============================================================================
# Test Group 10: Negative Number Arithmetic
# ============================================================================

describe "Negative Number Arithmetic":
    """
    ## Negative Number Arithmetic

    Tests arithmetic with negative values.
    """

    it "adds two negatives":
        expect ((-5)) + -3 == -8

    it "adds positive and negative":
        expect 5 + -3 == 2

    it "multiplies negatives":
        expect ((-5)) * -3 == 15

    it "multiplies positive and negative":
        expect 5 * -3 == -15

    it "divides negatives":
        expect ((-20)) / -4 == 5

    it "divides positive by negative":
        expect 20 / -4 == -5


# ============================================================================
# Test Group 11: Large Numbers
# ============================================================================

describe "Large Number Arithmetic":
    """
    ## Large Number Arithmetic

    Tests arithmetic with large values.
    """

    it "adds large numbers":
        expect 1000000 + 2000000 == 3000000

    it "multiplies large numbers":
        expect 100000 * 100 == 10000000

    it "handles near max i64":
        # Not testing max itself to avoid overflow complexity
        val big = 9000000000000000000
        expect big + 0 == big


# ============================================================================
# Test Group 12: Assignment with Operators
# ============================================================================

describe "Assignment with Arithmetic":
    """
    ## Assignment with Arithmetic

    Tests combining arithmetic with variable assignment.
    """

    it "uses arithmetic in variable assignment":
        val result = 2 + 3 * 4
        expect result == 14

    it "chains multiple arithmetic operations":
        val a = 10
        val b = 20
        val c = a + b * 2
        expect c == 50

    it "modifies variable with arithmetic":
        var x = 10
        x = x + 5
        expect x == 15

    it "multiple arithmetic assignments":
        var total = 0
        total = total + 5
        total = total + 10
        total = total + 3
        expect total == 18


# ============================================================================
# Test Group 13: Arithmetic in Collections
# ============================================================================

describe "Arithmetic in Collections":
    """
    ## Arithmetic in Collections

    Tests arithmetic operations when used with arrays and loops.
    """

    it "sums array with loop":
        val arr = [1, 2, 3, 4, 5]
        var sum = 0
        for i in arr:
            sum = sum + i
        expect sum == 15

    it "multiply each element":
        val arr = [1, 2, 3]
        var product = 1
        for i in arr:
            product = product * i
        expect product == 6

    it "arithmetic on array indices":
        val arr = [10, 20, 30, 40, 50]
        expect arr[2 + 1] == 40


# ============================================================================
# Test Group 14: Arithmetic in Conditionals
# ============================================================================

describe "Arithmetic in Conditionals":
    """
    ## Arithmetic in Conditionals

    Tests arithmetic expressions in if/else conditions.
    """

    it "condition with addition":
        expect (if 2 + 3 == 5: true else: false) == true

    it "condition with multiplication":
        expect (if 4 * 5 == 20: true else: false) == true

    it "nested arithmetic in condition":
        expect (if 2 * 3 + 4 == 10: true else: false) == true

    it "arithmetic comparison":
        expect (if 10 / 2 > 3: true else: false) == true


# ============================================================================
# Test Group 15: Practical Examples
# ============================================================================

describe "Arithmetic Practical Examples":
    """
    ## Practical Examples

    Real-world arithmetic scenarios.
    """

    it "calculates average":
        val sum = 10 + 20 + 30
        val avg = sum / 3
        expect avg == 20

    it "calculates compound interest":
        val principal = 1000
        val rate = 5
        val years = 2
        val interest = principal * rate / 100 * years
        expect interest == 100

    it "calculates area of rectangle":
        val width = 10
        val height = 5
        val area = width * height
        expect area == 50

    it "converts between units":
        val kilometers = 5
        val meters = kilometers * 1000
        expect meters == 5000

    it "calculates percentage":
        val total = 200
        val part = 50
        val percent = part * 100 / total
        expect percent == 25
