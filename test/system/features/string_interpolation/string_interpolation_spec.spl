# @pending
# @skip - Uses unsupported keyword: with
"""
# String Interpolation Specification

**Feature IDs:** #INTERP-001 to #INTERP-020
**Category:** Language | Syntax
**Status:** Implemented

## Overview

String interpolation allows embedding expressions directly in string literals
using curly braces. Simple treats interpolation as the default for regular
strings, with raw strings available when needed.

## Syntax

```simple
# Default interpolation (no special prefix needed)
val name = "Alice"
print "Hello, {name}!"          # Output: Hello, Alice!

# Expressions in braces
print "Result: {2 + 3}"         # Output: Result: 5

# Raw strings (no interpolation)
val regex = r"pattern: \d+"     # Backslashes not escaped, no interpolation
```

## Key Concepts

| Concept | Syntax | Escaping | Interpolation |
|---------|--------|----------|---------------|
| Default String | `"..."` | Standard | Yes |
| Raw String | `r"..."` | None | No |
| Expression | `{expr}` | Within braces | Yes |
| Escape Sequence | `\n, \t, \\` | Standard | Processed |

## Behavior

- Expressions in braces are evaluated at runtime
- Any expression can appear in braces, not just variables
- Raw strings skip interpolation and escape processing
"""



# ============================================================================
# Test Group 1: Basic String Interpolation
# ============================================================================

describe "Basic String Interpolation":
    """
    ## Basic String Interpolation

    Tests simple variable interpolation in strings.
    """

    it "interpolates variable in string":
        val name = "Alice"
        val result = "Hello, {name}!"
        var r = 0
        if result == "Hello, Alice!":
            r = 1
        expect r == 1

    it "interpolates multiple variables":
        val first = "John"
        val last = "Doe"
        val result = "{first} {last}"
        var r = 0
        if result == "John Doe":
            r = 1
        expect r == 1

    it "interpolates at start of string":
        val value = 42
        val result = "{value} is the answer"
        var r = 0
        if result == "42 is the answer":
            r = 1
        expect r == 1

    it "interpolates at end of string":
        val value = 42
        val result = "The answer is {value}"
        var r = 0
        if result == "The answer is 42":
            r = 1
        expect r == 1


# ============================================================================
# Test Group 2: Expression Interpolation
# ============================================================================

describe "Expression Interpolation":
    """
    ## Expression Interpolation

    Tests that arbitrary expressions can be interpolated.
    """

    it "interpolates arithmetic expression":
        val a = 10
        val b = 20
        val result = "Sum: {a + b}"
        var r = 0
        if result == "Sum: 30":
            r = 1
        expect r == 1

    it "interpolates multiplication expression":
        val x = 5
        val y = 3
        val result = "Product: {x * y}"
        var r = 0
        if result == "Product: 15":
            r = 1
        expect r == 1

    it "interpolates boolean value":
        val b = true
        val result = "flag: {b}"
        var r = 0
        if result == "flag: true":
            r = 1
        expect r == 1

    it "interpolates false boolean value":
        val b = false
        val result = "flag: {b}"
        var r = 0
        if result == "flag: false":
            r = 1
        expect r == 1


# ============================================================================
# Test Group 3: Raw Strings
# ============================================================================

describe "Raw Strings":
    """
    ## Raw Strings

    Tests raw strings with no interpolation.
    """

    it "raw string preserves braces":
        val template = r"{name}"
        expect template.len() == 6

    it "raw string preserves backslashes":
        val path = r"C:\Users\test"
        expect path.len() == 13


# ============================================================================
# Test Group 4: F-String Explicit Syntax
# ============================================================================

describe "F-String Syntax":
    """
    ## F-String Explicit Syntax

    Tests explicit f-string prefix (legacy compatibility).
    """

    it "f-string basic interpolation":
        val x = 42
        val s = f"value is {x}"
        var r = 0
        if s == "value is 42":
            r = 1
        expect r == 1

    it "f-string with expression":
        val a = 10
        val b = 20
        val s = f"sum is {a + b}"
        var r = 0
        if s == "sum is 30":
            r = 1
        expect r == 1

    it "f-string multiple interpolations":
        val name = "world"
        val count = 3
        val s = f"hello {name}, count={count}"
        var r = 0
        if s == "hello world, count=3":
            r = 1
        expect r == 1

    it "f-string no interpolation":
        val s = f"just a string"
        var r = 0
        if s == "just a string":
            r = 1
        expect r == 1

