"""
# Control Flow Specification (Python-Inspired)


**Feature IDs:** #PYTHON-COMPAT-CONTROL
**Category:** Control Flow
**Status:** Planned

This specification tests control flow constructs that Python developers
will find familiar. Simple uses indentation-based blocks like Python
for if/else, loops, and match expressions.

## Covered Features

- if/else conditionals (indentation-based)
- for loops with ranges and iterables
- while loops
- match expressions (pattern matching)
- Loop control: break, continue
"""
import std.spec
use std.text.{NL}

describe "Control Flow":
    """
    ## Python-Inspired Control Flow

    Tests for conditional execution, loops, and pattern matching.
    Simple's control flow uses Python-style indentation to define blocks,
    making code structure visually clear.

    Key areas tested:
    - if/elif/else branching
    - for-in loops over ranges and collections
    - while loops with conditions
    - match expressions for pattern matching
    - Loop control statements
    """

    context "if/else":
        it "executes if branch when true":
            val x = 10
            var result = ""
            if x > 5:
                result = "big"
            else:
                result = "small"
            expect result == "big"

        it "executes else branch when false":
            val x = 3
            var result = ""
            if x > 5:
                result = "big"
            else:
                result = "small"
            expect result == "small"

    context "for loops":
        it "iterates over range":
            var sum = 0
            for i in 0..5:
                sum = sum + i
            expect sum == 10

        it "iterates over list":
            val items = ["a", "b", "c"]
            var count = 0
            for item in items:
                count = count + 1
            expect count == 3

    context "while loops":
        it "loops while condition is true":
            var i = 0
            var sum = 0
            while i < 5:
                sum = sum + i
                i = i + 1
            expect sum == 10

    context "match expressions":
        it "matches literal values":
            val x = 2
            val result = match x:
                case 1:
                    "one"
                case 2:
                    "two"
                case _:
                    "other"
            expect result == "two"

        it "matches with guards":
            val n = 15
            val category = match n:
                case x if x > 10:
                    "large"
                case x if x > 0:
                    "small"
                case _:
                    "non-positive"
            expect category == "large"
