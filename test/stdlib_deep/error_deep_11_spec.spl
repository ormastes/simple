"""
# STDLIB Deep-Dive Test


**Feature IDs:** #STDLIB-DEEP
**Category:** Standard Library Deep Coverage
**Status:** Implemented
"""

use std.spec.{check}
use std.string.{NL}

describe "Deep Coverage Test":
    it "basic 1": check(true)
    it "basic 2": check(1 == 1)
    it "basic 3": check("a" == "a")
    
    it "op 1": check(1 + 1 == 2)
    it "op 2": check(5 - 3 == 2)
    it "op 3": check(2 * 3 == 6)
    it "op 4": check(10 / 2 == 5)
    it "op 5": check(10 % 3 == 1)
    
    it "cmp 1": check(5 > 3)
    it "cmp 2": check(3 < 5)
    it "cmp 3": check(5 >= 5)
    it "cmp 4": check(5 <= 5)
    it "cmp 5": check(5 != 3)
    
    it "bool 1": check(true and true)
    it "bool 2": check(true or false)
    it "bool 3": check(not false)
    
    it "arr 1": val a = [1,2,3]; check(a.len() == 3)
    it "arr 2": val a = []; check(a.len() == 0)
    it "arr 3": val a = [1]; check(a[0] == 1)
    it "arr 4": val a = [1,2,3]; check(a[-1] == 3)
    it "arr 5": val a = [1,2]; val b = a.append(3); check(b.len() == 3)
    
    it "str 1": check("".len() == 0)
    it "str 2": check("a".len() == 1)
    it "str 3": check("test".len() == 4)
    it "str 4": check("hello".contains("ell"))
    it "str 5": check("test".starts_with("te"))
    it "str 6": check("test".ends_with("st"))
    
    it "opt 1": val o = Some(1); check(o.?)
    it "opt 2": val o = nil; check(not o.?)
    it "opt 3": val o = Some(42); check(o? == 42)
    it "opt 4": val o = nil; check((o ?? 99) == 99)
    
    it "dict 1": val d = {"a": 1}; check(d["a"] == 1)
    it "dict 2": val d = {}; check(dict_keys(d).len() == 0)
    it "dict 3": val d = {"a": 1, "b": 2}; check(dict_keys(d).len() == 2)
    
    it "if 1": if true: check(true); else: check(false)
    it "if 2": if false: check(false); else: check(true)
    it "if 3": 
        val x = 10
        if x > 5: check(true)
        else: check(false)
    
    it "for 1": 
        var c = 0
        for i in 0..5: c = c + 1
        check(c == 5)
    
    it "for 2":
        var s = 0
        for i in 0..10: s = s + i
        check(s == 45)
    
    it "match 1":
        match Some(1):
            Some(x): check(x == 1)
            nil: check(false)
    
    it "match 2":
        match nil:
            Some(x): check(false)
            nil: check(true)
    
    it "nested 1":
        for i in 0..3:
            for j in 0..3:
                check(true)
    
    it "complex 1":
        val arr = [1,2,3,4,5]
        var evens = []
        for x in arr:
            if x % 2 == 0:
                evens = evens.append(x)
        check(evens.len() == 2)
