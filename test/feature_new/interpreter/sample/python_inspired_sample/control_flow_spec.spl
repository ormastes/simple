"""
# Control Flow Specification


**Feature IDs:** #CONTROL-FLOW
**Category:** Core
**Status:** Implemented

Tests Python-inspired control flow constructs in Simple.
Covers if/else expressions, for loops, while loops,
and match expressions.
"""
import std.spec
use std.text.{NL}

describe "Control Flow":
    """
    ## Control Flow Constructs

    Verifies Python-like control flow:
    - if/else as expressions
    - for loops with ranges and iterables
    - while loops
    - match expressions (pattern matching)
    """

    context "if expressions":
        it "evaluates then branch when true":
            val result = if true: "yes" else: "no"
            expect result == "yes"

        it "evaluates else branch when false":
            val result = if false: "yes" else: "no"
            expect result == "no"

        it "chains elif conditions":
            fn classify(x: i64) -> text:
                if x > 0:
                    "positive"
                elif x < 0:
                    "negative"
                else:
                    "zero"
            expect classify(5) == "positive"
            expect classify(-5) == "negative"
            expect classify(0) == "zero"

    context "for loops":
        it "iterates over range":
            var sum = 0
            for i in 0..5:
                sum = sum + i
            expect sum == 10

        it "iterates over list":
            val items = [1, 2, 3]
            var total = 0
            for item in items:
                total = total + item
            expect total == 6

    context "while loops":
        it "loops while condition true":
            var count = 0
            while count < 3:
                count = count + 1
            expect count == 3

    context "match expressions":
        it "matches literal pattern":
            fn describe(x: i64) -> text:
                match x:
                    case 0:
                        "zero"
                    case 1:
                        "one"
                    case _:
                        "other"
            expect describe(0) == "zero"
            expect describe(1) == "one"
            expect describe(99) == "other"
