# RISC-V Null Pointer Crash Test
#
# This kernel intentionally dereferences a null pointer
# to test crash detection and debug information extraction.

use baremetal.riscv.startup.{uart_init, uart_puts}

fn crash_null_pointer():
    # Dereference null pointer to cause crash.
    unsafe:
        # Dereference address 0 (null pointer)
        val ptr = @address(0) @volatile val: u32
        val value = ptr  # Should cause crash

fn main():
    # Test kernel that crashes.
    uart_init()
    uart_puts("About to crash (null pointer)...\r\n")

    # Cause null pointer dereference
    crash_null_pointer()

    # Should never reach here
    uart_puts("ERROR: Survived crash!\r\n")
