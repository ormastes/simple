# Minimal RISC-V 32 Kernel for Testing
#
# This is a simple test kernel that:
# 1. Boots in machine mode
# 2. Writes "RISC-V started" to UART (QEMU serial)
# 3. Parks in WFI loop

use baremetal.riscv.startup.{UART_BASE, uart_init, uart_puts}
use std.string.{NL}

fn halt():
    """Park hart in low-power loop."""
    loop:
        unsafe:
            asm volatile:
                "wfi"  # Wait for interrupt

# Main entry point (called by _start)
fn main():
    """Minimal test kernel."""
    # Initialize UART
    uart_init()

    # Write test message
    uart_puts("RISC-V started\r{NL}")

    # Park hart
    halt()
