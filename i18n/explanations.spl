# English error explanations for the Simple compiler
# Detailed help text for common error codes

val explanations = {
    "E0002": {
        "id": "E0002",
        "title": "Unexpected Token",
        "description": "The parser encountered a token it didn't expect at this location.",
        "causes": [
            "Missing punctuation (comma, semicolon, closing bracket)",
            "Typo in keyword or identifier",
            "Incorrect syntax for the language construct"
        ],
        "fixes": [
            "Check for missing or extra punctuation",
            "Verify the syntax matches Simple language rules",
            "Look at the 'expected' hint in the error message"
        ],
        "example_bad": "fn main():\n    let x = [1, 2, 3  # Missing closing bracket",
        "example_good": "fn main():\n    let x = [1, 2, 3]  # Properly closed",
        "related": ["E0001", "E0010"]
    },

    "E1001": {
        "id": "E1001",
        "title": "Undefined Variable",
        "description": "Attempted to use a variable that hasn't been declared in the current scope.",
        "causes": [
            "Variable name was misspelled",
            "Variable was used before declaration",
            "Variable is out of scope (declared in different block)",
            "Variable name shadowed by inner scope"
        ],
        "fixes": [
            "Check the spelling of the variable name",
            "Declare the variable with 'let' or 'var' before using it",
            "Move the variable declaration to an outer scope if needed",
            "Check for typos in similar variable names"
        ],
        "example_bad": "fn main():\n    print(count)  # Error: count not defined",
        "example_good": "fn main():\n    let count = 0\n    print(count)  # OK",
        "related": ["E1002", "E1008"]
    },

    "E1002": {
        "id": "E1002",
        "title": "Undefined Function",
        "description": "Attempted to call a function that doesn't exist in the current scope.",
        "causes": [
            "Function name was misspelled",
            "Function not imported from module",
            "Function defined after use (forward reference)",
            "Function is private in another module"
        ],
        "fixes": [
            "Check the spelling of the function name",
            "Import the function: 'from module import function'",
            "Define the function before calling it",
            "Ensure the function is marked 'pub' if importing from another module"
        ],
        "example_bad": "fn main():\n    result = calcualte(42)  # Typo!",
        "example_good": "fn main():\n    result = calculate(42)  # Correct spelling",
        "related": ["E1001", "E1010"]
    },

    "E1003": {
        "id": "E1003",
        "title": "Type Mismatch",
        "description": "An expression has a different type than expected in this context.",
        "causes": [
            "Wrong type provided to function parameter",
            "Cannot convert between incompatible types",
            "Return type doesn't match function signature",
            "Binary operation on incompatible types"
        ],
        "fixes": [
            "Convert the value to the expected type",
            "Change the function signature to match usage",
            "Use type casting if conversion is safe",
            "Check the types of all operands in expressions"
        ],
        "example_bad": "fn add(x: i64, y: i64) -> i64:\n    return x + y\n\nadd(\"5\", 10)  # Error: string instead of i64",
        "example_good": "fn add(x: i64, y: i64) -> i64:\n    return x + y\n\nadd(5, 10)  # OK: both i64",
        "related": ["E1004", "E1005"]
    },

    "E1101": {
        "id": "E1101",
        "title": "Break Outside Loop",
        "description": "The 'break' statement can only be used inside loop constructs.",
        "causes": [
            "Break used in conditional block outside loop",
            "Break in function not containing a loop",
            "Misplaced break statement"
        ],
        "fixes": [
            "Move the break inside a 'for', 'while', or 'loop' statement",
            "Remove the break if it's not needed",
            "Use 'return' instead if you want to exit the function"
        ],
        "example_bad": "fn main():\n    if true:\n        break  # Error: not in a loop",
        "example_good": "fn main():\n    for i in 0..10:\n        if i > 5:\n            break  # OK: inside loop",
        "related": ["E1102", "E1103"]
    },

    "E1102": {
        "id": "E1102",
        "title": "Continue Outside Loop",
        "description": "The 'continue' statement can only be used inside loop constructs.",
        "causes": [
            "Continue used in conditional block outside loop",
            "Continue in function not containing a loop"
        ],
        "fixes": [
            "Move the continue inside a 'for', 'while', or 'loop' statement",
            "Remove the continue if it's not needed"
        ],
        "example_bad": "fn process(x: i64):\n    if x < 0:\n        continue  # Error: not in a loop",
        "example_good": "fn process(items: [i64]):\n    for x in items:\n        if x < 0:\n            continue  # OK: inside loop",
        "related": ["E1101", "E1103"]
    },

    "E3001": {
        "id": "E3001",
        "title": "Division by Zero",
        "description": "Attempted to divide by zero at runtime, which is undefined.",
        "causes": [
            "Divisor is literally zero",
            "Variable evaluated to zero",
            "Calculation resulted in zero divisor"
        ],
        "fixes": [
            "Check if divisor is zero before dividing",
            "Use checked_div() for safe division that returns Option",
            "Add assertion or validation for divisor != 0"
        ],
        "example_bad": "let x = 10 / 0  # Runtime error!",
        "example_good": "let divisor = get_value()\nif divisor != 0:\n    let x = 10 / divisor\nelse:\n    print(\"Cannot divide by zero\")",
        "related": ["E3002"]
    },

    "E3002": {
        "id": "E3002",
        "title": "Index Out of Bounds",
        "description": "Attempted to access an array element at an invalid index.",
        "causes": [
            "Index is negative",
            "Index is >= array length",
            "Off-by-one error in loop bounds"
        ],
        "fixes": [
            "Check array bounds before accessing: 'if index < arr.len()'",
            "Use .get(index) method for safe access returning Option",
            "Fix loop bounds to use 'for i in 0..arr.len()'"
        ],
        "example_bad": "let arr = [1, 2, 3]\nlet x = arr[10]  # Error: index 10 >= length 3",
        "example_good": "let arr = [1, 2, 3]\nif 2 < arr.len():\n    let x = arr[2]  # OK: bounds checked",
        "related": ["E3001", "E3003"]
    }
}
