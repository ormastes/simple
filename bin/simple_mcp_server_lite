#!/bin/bash
# Simple MCP Server Wrapper (Lite)
# Fast startup with main_lazy MCP entrypoint.

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
RUNTIME="${SIMPLE_RUNTIME:-${SCRIPT_DIR}/bootstrap/cpp/simple}"
if [ ! -x "$RUNTIME" ]; then
  RUNTIME="${SCRIPT_DIR}/release/simple"
fi
MCP_MAIN="${SCRIPT_DIR}/../src/app/mcp/main_lazy.spl"
PROXY="${SCRIPT_DIR}/mcp_stdio_proxy.py"

export SIMPLE_LIB="${SCRIPT_DIR}/../src"
export SIMPLE_VERSION=$(cat "${SCRIPT_DIR}/../VERSION" 2>/dev/null || echo "unknown")

# Suppress stderr warnings for clean MCP stdio transport.
RUST_LOG=error exec "$PROXY" "$RUNTIME" "$MCP_MAIN" 2>/dev/null
