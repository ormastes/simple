# PyTorch Basic Example
#
# Simple example demonstrating basic torch module functionality.
# Note: Tensor operations require FFI backend (not available in interpreter).

import ml.torch.training.{EarlyStopping, ParameterStats}


fn main():
    print("=" * 50)
    print("PyTorch Basic Example")
    print("=" * 50)

    # Example 1: EarlyStopping (training utility)
    print("\n[1] Training utilities - EarlyStopping")
    val early_stop = EarlyStopping(5)
    print("  EarlyStopping(patience=5): created")

    # Simulate training loop checking
    print("\n  Simulating training loop with losses: [1.0, 0.8, 0.6, 0.5, 0.55, ...]")
    val losses: [f64] = [1.0, 0.8, 0.6, 0.5, 0.55, 0.56, 0.57, 0.58, 0.59, 0.60]
    var epoch = 0
    for loss in losses:
        val should_continue = early_stop.check(loss)
        if not should_continue:
            print("  -> Training stopped at epoch {epoch} (patience exhausted)")
            break
        print("    Epoch {epoch}: loss={loss} - continuing")
        epoch = epoch + 1

    if not early_stop.should_stop:
        print("  -> Training completed all epochs")

    # Example 2: ParameterStats
    print("\n[2] Training utilities - ParameterStats")
    val stats = ParameterStats("weight", 0.01, 0.5, 1.2)
    print("  ParameterStats created:")
    print("    name: {stats.name}")
    print("    mean: {stats.mean}")
    print("    std: {stats.std}")
    print("    norm: {stats.norm}")

    val stats2 = ParameterStats("bias", 0.0, 0.1, 0.5)
    print("  ParameterStats for bias:")
    print("    name: {stats2.name}")
    print("    mean: {stats2.mean}")
    print("    std: {stats2.std}")
    print("    norm: {stats2.norm}")

    print("\n" + "=" * 50)
    print("Example completed successfully!")
    print("=" * 50)


main()
