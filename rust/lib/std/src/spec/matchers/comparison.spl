# Comparison Matchers - gt, lt, gte, lte
# Numeric and ordered type comparisons

use matchers.{Matcher, MatchResult}

# Greater than: expect x to gt 5
class GtMatcher<T>:
    expected: T

impl GtMatcher:
    fn new(expected: T) -> GtMatcher<T>:
        return GtMatcher { expected: expected }

impl Matcher for GtMatcher<T>:
    fn matches(actual: T) -> MatchResult:
        if actual > self.expected:
            return MatchResult.success()
        else:
            return MatchResult.failure(
                "Expected {actual} to be greater than {self.expected}"
            )

fn gt<T>(expected: T) -> GtMatcher<T>:
    return GtMatcher.new(expected)

# Less than: expect x to lt 5
class LtMatcher<T>:
    expected: T

impl LtMatcher:
    fn new(expected: T) -> LtMatcher<T>:
        return LtMatcher { expected: expected }

impl Matcher for LtMatcher<T>:
    fn matches(actual: T) -> MatchResult:
        if actual < self.expected:
            return MatchResult.success()
        else:
            return MatchResult.failure(
                "Expected {actual} to be less than {self.expected}"
            )

fn lt<T>(expected: T) -> LtMatcher<T>:
    return LtMatcher.new(expected)

# Greater than or equal: expect x to gte 5
class GteMatcher<T>:
    expected: T

impl GteMatcher:
    fn new(expected: T) -> GteMatcher<T>:
        return GteMatcher { expected: expected }

impl Matcher for GteMatcher<T>:
    fn matches(actual: T) -> MatchResult:
        if actual >= self.expected:
            return MatchResult.success()
        else:
            return MatchResult.failure(
                "Expected {actual} to be >= {self.expected}"
            )

fn gte<T>(expected: T) -> GteMatcher<T>:
    return GteMatcher.new(expected)

# Less than or equal: expect x to lte 5
class LteMatcher<T>:
    expected: T

impl LteMatcher:
    fn new(expected: T) -> LteMatcher<T>:
        return LteMatcher { expected: expected }

impl Matcher for LteMatcher<T>:
    fn matches(actual: T) -> MatchResult:
        if actual <= self.expected:
            return MatchResult.success()
        else:
            return MatchResult.failure(
                "Expected {actual} to be <= {self.expected}"
            )

fn lte<T>(expected: T) -> LteMatcher<T>:
    return LteMatcher.new(expected)
