# Common Network Types
# Shared across all host variants (async_nogc_mut, async_gc_immut, etc.)

use core.traits.*

# Shutdown modes for TCP connections
pub enum Shutdown:
    Read
    Write
    Both

impl Display for Shutdown:
    fn fmt() -> str:
        match self:
            case Read: "read"
            case Write: "write"
            case Both: "both"

    # =========================================================================
    # Helper Methods
    # =========================================================================

    pub fn is_read(self) -> bool:
        """Check if shutdown mode is Read.

        Returns:
            True if Read
        """
        match self:
            case Read: true
            case _: false

    pub fn is_write(self) -> bool:
        """Check if shutdown mode is Write.

        Returns:
            True if Write
        """
        match self:
            case Write: true
            case _: false

    pub fn is_both(self) -> bool:
        """Check if shutdown mode is Both.

        Returns:
            True if Both
        """
        match self:
            case Both: true
            case _: false

    pub fn affects_reading(self) -> bool:
        """Check if shutdown affects reading.

        Returns:
            True for Read or Both
        """
        match self:
            case Read: true
            case Both: true
            case _: false

    pub fn affects_writing(self) -> bool:
        """Check if shutdown affects writing.

        Returns:
            True for Write or Both
        """
        match self:
            case Write: true
            case Both: true
            case _: false

    pub fn is_partial(self) -> bool:
        """Check if shutdown is partial (not Both).

        Returns:
            True if Read or Write only
        """
        match self:
            case Both: false
            case _: true

    pub fn is_complete(self) -> bool:
        """Check if shutdown is complete (Both).

        Returns:
            True if Both
        """
        return self.is_both()

    pub fn to_int(self) -> i64:
        """Convert to integer for FFI.

        Returns:
            Integer value (0=read, 1=write, 2=both)
        """
        match self:
            case Read: 0
            case Write: 1
            case Both: 2

    pub fn from_int(value: i64) -> Option<Shutdown>:
        """Create from integer value.

        Args:
            value: Integer (0=read, 1=write, 2=both)

        Returns:
            Shutdown mode or None if invalid
        """
        match value:
            case 0: Some(Read)
            case 1: Some(Write)
            case 2: Some(Both)
            case _: None

    pub fn to_string(self) -> text:
        """Convert shutdown mode to string.

        Returns:
            Mode name

        Example:
            Shutdown.Both.to_string()  # → "both"
        """
        match self:
            case Read: "read"
            case Write: "write"
            case Both: "both"

    pub fn description(self) -> text:
        """Get shutdown mode description.

        Returns:
            Human-readable description

        Example:
            Shutdown.Both.description()
            # → "Shutdown both read and write operations"
        """
        match self:
            case Read: "Shutdown read operations only"
            case Write: "Shutdown write operations only"
            case Both: "Shutdown both read and write operations"

    pub fn summary(self) -> str:
        """Get summary of shutdown mode.

        Returns:
            Human-readable summary

        Example:
            Shutdown.Both.summary()
            # → "Shutdown: both (affects read and write, complete)"
        """
        val name = self.fmt()
        val props = []
        if self.affects_reading():
            props.push("affects read")
        if self.affects_writing():
            props.push("affects write")
        if self.is_complete():
            props.push("complete")
        else:
            props.push("partial")
        val props_str = if props.len() > 0: " ({props.join(\", \")})" else: ""
        return "Shutdown: {name}{props_str}"

# HTTP Methods
