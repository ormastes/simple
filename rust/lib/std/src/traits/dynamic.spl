# Dynamic Trait Utilities
#
# Helpers for working with dyn Trait objects (runtime polymorphism).
#
# dyn Trait wraps a concrete value with its trait name, enabling:
# - Heterogeneous collections: [dyn Drawable] can hold Circle, Square, etc.
# - Polymorphic function parameters: fn render(shape: dyn Drawable)
# - Runtime dispatch: method calls resolve to the concrete type's implementation
#
# Auto-wrapping happens at let bindings:
#   val shape: dyn Drawable = Circle(radius: 5)
#   # shape is now a TraitObject wrapping the Circle
#
# NOTE: dyn Mixin is NOT supported. Mixins are compile-time field/method
# injection, not runtime behavioral contracts. Use dyn Trait for polymorphism.

# Apply a function to each element in a heterogeneous dyn Trait collection
fn map_trait_objects(items: [dyn Any], f) -> [dyn Any]:
    items.map(f)

# Filter a heterogeneous collection by a predicate
fn filter_trait_objects(items: [dyn Any], pred) -> [dyn Any]:
    items.filter(pred)

# Dispatch a method by name on a dyn Trait object
# Useful for reflection-style patterns
fn dispatch(obj, method_name: text, args: []):
    obj.call(method_name, args)
