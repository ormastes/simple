# System module - Process control and standard streams
# Provides basic I/O and process control functionality

# Extern declarations for runtime FFI
extern fn rt_get_args() -> List<text>
extern fn rt_exit(code: i32) -> void

# Exit code semantic type
# Represents process exit status (0 = success, non-zero = error)
unit ExitCode: i32 as exitcode

# Common exit codes
const EXIT_SUCCESS: ExitCode = 0_exitcode
const EXIT_FAILURE: ExitCode = 1_exitcode

impl ExitCode:
    fn success() -> ExitCode:
        """Create success exit code (0)."""
        return 0_exitcode

    fn failure() -> ExitCode:
        """Create generic failure exit code (1)."""
        return 1_exitcode

    fn from_int(code: i32) -> ExitCode:
        """Create exit code from integer."""
        return code as ExitCode

    fn to_int() -> i32:
        """Convert to integer."""
        return self as i32

    fn is_success() -> bool:
        """Check if exit code indicates success."""
        return (self as i32) == 0

    fn is_failure() -> bool:
        """Check if exit code indicates failure."""
        return (self as i32) != 0

# Standard output functions
pub fn stdout_write(s: text):
    print(s)

# Standard error functions
pub fn stderr_write(s: text):
    eprint(s)

# Get command line arguments
pub fn get_args() -> List<text>:
    return rt_get_args()

# Exit the process with semantic exit code
pub fn exit(code: ExitCode):
    rt_exit(code as i32)

# Convenience: exit with integer (deprecated, use ExitCode)
#[deprecated = "Use exit(ExitCode) instead"]
pub fn exit_with_code(code: i32):
    rt_exit(code)
