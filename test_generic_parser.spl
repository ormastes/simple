# Test generic parser directly
use core.parser.{parse_module, parser_has_errors, parser_get_errors}

val source1 = "class Box<T>:\n    value: T\n"
parse_module(source1, "test1.spl")
if parser_has_errors():
    print "FAIL: class Box<T> should parse"
    val errs = parser_get_errors()
    for i in 0..errs.len():
        print errs[i]
else:
    print "PASS: class Box<T> parses correctly"

val source2 = "fn identity<T>(x: T) -> T:\n    x\n"
parse_module(source2, "test2.spl")
if parser_has_errors():
    print "FAIL: fn identity<T> should parse"
    val errs = parser_get_errors()
    for i in 0..errs.len():
        print errs[i]
else:
    print "PASS: fn identity<T> parses correctly"

val source3 = "fn compare<T>(x: i64) -> bool:\n    if x < 5:\n        true\n    else:\n        false\n"
parse_module(source3, "test3.spl")
if parser_has_errors():
    print "FAIL: fn compare<T> with < operator should parse"
    val errs = parser_get_errors()
    for i in 0..errs.len():
        print errs[i]
else:
    print "PASS: fn compare<T> with < operator parses correctly"

print "All manual tests passed!"
