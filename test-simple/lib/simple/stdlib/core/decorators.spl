# Core Decorators Module - Simplified Pure Simple Implementation
#
# NOTE: Full decorator pattern requires dynamic function calling which
# is not fully supported in Pure Simple. This is a simplified version.

export CachedFunction, LoggedFunction, DeprecatedFunction

# ============================================================================
# CachedFunction - Simplified Memoization
# ============================================================================

class CachedFunction:
    """Simplified function wrapper for caching (Pure Simple limitations)."""
    name: text
    cache: Dict<text, Any>
    hits: i64
    misses: i64

    static fn new(name: text) -> CachedFunction:
        """Create new cached function wrapper."""
        CachedFunction(
            name: name,
            cache: {},
            hits: 0,
            misses: 0
        )

    fn cache_info() -> Dict<text, i64>:
        """Get cache statistics."""
        {
            "hits": self.hits,
            "misses": self.misses,
            "size": self.cache.len()
        }

    me clear_cache():
        """Clear all cached values and reset statistics."""
        self.cache = {}
        self.hits = 0
        self.misses = 0

# ============================================================================
# LoggedFunction - Simplified Logging
# ============================================================================

class LoggedFunction:
    """Simplified function wrapper for logging."""
    name: text
    call_count: i64

    static fn new(name: text) -> LoggedFunction:
        """Create new logged function wrapper."""
        LoggedFunction(
            name: name,
            call_count: 0
        )

    me log_call(args_str: text):
        """Log a function call."""
        self.call_count = self.call_count + 1
        print "[CALL {self.call_count}] {self.name}({args_str})"

    fn log_return(result: Any):
        """Log a return value."""
        print "[RETURN] {self.name} -> {result}"

# ============================================================================
# DeprecatedFunction - Deprecation Warning
# ============================================================================

class DeprecatedFunction:
    """Function wrapper that shows deprecation warnings."""
    name: text
    message: text
    warned: bool

    static fn new(name: text, message: text) -> DeprecatedFunction:
        """Create new deprecated function wrapper."""
        DeprecatedFunction(
            name: name,
            message: message,
            warned: false
        )

    me warn():
        """Show deprecation warning (once)."""
        if not self.warned:
            print "DeprecationWarning: {self.name} - {self.message}"
            self.warned = true
