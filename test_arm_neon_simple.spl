use compiler.backend.native.arm_neon.{encode_fadd_4s, encode_fsub_4s}
use compiler.backend.native.mach_inst.{AARCH64_Q0, AARCH64_Q1, AARCH64_Q2, AARCH64_Q3, AARCH64_Q4, AARCH64_Q5}

val bytes_add = encode_fadd_4s(AARCH64_Q0, AARCH64_Q1, AARCH64_Q2)
print "FADD.4S encoded: {bytes_add.len()} bytes"
if bytes_add.len() == 4:
    print "  [0]={bytes_add[0]}, [1]={bytes_add[1]}, [2]={bytes_add[2]}, [3]={bytes_add[3]}"
    print "  Byte 3 (opcode high): 0x{bytes_add[3]} (expected 0x4E=78)"
    print "  Byte 0 (Rd field): {bytes_add[0] % 32} (expected 0)"

val bytes_sub = encode_fsub_4s(AARCH64_Q3, AARCH64_Q4, AARCH64_Q5)
print "FSUB.4S encoded: {bytes_sub.len()} bytes"
if bytes_sub.len() == 4:
    print "  Rd field: {bytes_sub[0] % 32} (expected 3)"
