# Test the patched parser directly

use lib.parser.parser (parse_expr)

fn main():
    print "Testing patched parser with ?? return..."

    # Test 1: Simple expression
    val test1 = "1 + 2"
    match parse_expr(test1):
        case Ok(expr):
            print "✓ Test 1 passed: {test1}"
        case Err(e):
            print "✗ Test 1 failed: {e.message}"

    # Test 2: Return expression (THE FIX!)
    val test2 = "return Err(\"error\")"
    match parse_expr(test2):
        case Ok(expr):
            print "✓ Test 2 passed: return expression works!"
        case Err(e):
            print "✗ Test 2 failed: {e.message}"

    # Test 3: Null coalesce with return (FULL TEST!)
    val test3 = "x ?? return Err(\"failed\")"
    match parse_expr(test3):
        case Ok(expr):
            print "✓ Test 3 passed: ?? return works!!!"
        case Err(e):
            print "✗ Test 3 failed: {e.message}"

    print "\nDone!"
