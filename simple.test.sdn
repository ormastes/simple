# Simple Test Configuration
# Configure test execution and coverage requirements
# SDN (Simple Data Notation) format

test:
  # Test directories
  unit_dir: test/unit
  integration_dir: test/integration
  system_dir: test/system

  # Coverage requirements by test type
  unit_coverage: branch           # branch/condition coverage for unit tests
  integration_coverage: function  # public function touch for integration tests
  system_coverage: method         # class/struct method coverage for system tests

  # Coverage thresholds (percentage)
  unit_threshold: 90.0
  integration_threshold: 100.0  # 100% of public API must be tested
  system_threshold: 100.0       # 100% of class/struct methods

  # Test execution
  parallel: false          # Default: single-threaded (use --parallel or -p to enable parallel)
  max_threads: 0           # 0 = auto (use all available cores when parallel=true)
  fail_fast: false         # Continue after first failure
  timeout: 120             # Default timeout in seconds per test
  slow_timeout: 600        # Timeout for slow tests (10 minutes)

  # Resource-aware throttling (for shared servers with multiple users)
  cpu_throttle:
    enabled: true            # Enable resource-aware thread throttling
    threshold: 70            # CPU usage % threshold to trigger throttling (0-100)
    memory_threshold: 70     # Memory usage % threshold to trigger throttling (0-100)
    throttled_threads: 1     # Number of threads when throttled
    check_interval: 5        # Seconds between resource checks during test run

  # Output
  default_format: progress  # progress, doc, json
  show_colors: true
  verbose: false

  # Filtering
  exclude_tags: []        # Tags to exclude by default
  include_tags: []        # Tags to include (empty = all)
  run_slow_tests: false   # Skip slow tests by default

  # Test modes - what runs with plain `bin/simple test`
  run_spec_tests: true    # Run .spl spec files (SSpec/it/describe tests)
  run_sdoctests: true     # Run documentation tests from docstrings

  # CI mode overrides (activated by --ci flag or CI=true env var)
  # When CI mode is active:
  #   - run_slow_tests: true  (includes long-running tests)
  #   - fail_fast: false      (continue after failures)
  #   - verbose: true         (detailed output)

coverage:
  # Coverage reporting
  enabled: true
  output_dir: coverage
  generate_html: true
  generate_json: true
  export_codecov: false
  export_coveralls: false

  # Coverage calculation
  public_only: true       # Only track public functions/methods
  include_private: false  # Include private in coverage

  # HTML report options
  html_title: Simple Test Coverage
  html_with_source: false  # Include source code in HTML

reports:
  # Test result reports
  output_dir: test-results
  json_output: test-results/results.json
  html_output: test-results/results.html
  junit_output: test-results/junit.xml  # For CI integration
