# Memory Syscalls FFI - Minimal OS Operations Only
#
# Only OS-level memory operations (malloc/free/memcpy/memset).
# NO GC logic - GC is implemented in Simple (src/app/gc/core.spl).
#
# ✅ Only syscalls (malloc/free)
# ❌ NO GC logic in FFI
# ✅ GC logic in Simple

# ============================================================================
# OS Memory Allocation (libc syscalls)
# ============================================================================

## Allocate memory from OS (libc malloc)
extern fn rt_malloc(size: i64) -> i64

## Free memory to OS (libc free)
extern fn rt_free(ptr: i64)

## Reallocate memory (libc realloc)
extern fn rt_realloc(ptr: i64, new_size: i64) -> i64

## Set memory to value (libc memset)
extern fn rt_memset(ptr: i64, value: u8, size: i64)

## Copy memory (libc memcpy)
extern fn rt_memcpy(dest: i64, src: i64, size: i64)

## Compare memory (libc memcmp)
extern fn rt_memcmp(ptr1: i64, ptr2: i64, size: i64) -> i32

# ============================================================================
# Memory Read/Write (direct memory access)
# ============================================================================

## Read byte from memory
extern fn rt_read_u8(ptr: i64) -> u8

## Write byte to memory
extern fn rt_write_u8(ptr: i64, value: u8)

## Read i32 from memory
extern fn rt_read_i32(ptr: i64) -> i32

## Write i32 to memory
extern fn rt_write_i32(ptr: i64, value: i32)

## Read i64 from memory
extern fn rt_read_i64(ptr: i64) -> i64

## Write i64 to memory
extern fn rt_write_i64(ptr: i64, value: i64)

## Read f64 from memory
extern fn rt_read_f64(ptr: i64) -> f64

## Write f64 to memory
extern fn rt_write_f64(ptr: i64, value: f64)

# ============================================================================
# Time (for GC timing)
# ============================================================================

## Get current time in microseconds
extern fn rt_time_now_micros() -> i64

## Get current time in milliseconds
extern fn rt_time_now_millis() -> i64

# ============================================================================
# System Info (for GC stats)
# ============================================================================

## Get total system memory (bytes)
extern fn rt_system_total_memory() -> i64

## Get available system memory (bytes)
extern fn rt_system_available_memory() -> i64

## Get current process memory usage (bytes)
extern fn rt_process_memory_usage() -> i64

# ============================================================================
# FFI Generation Metadata
# ============================================================================

# @ffi-gen-target: build/rust/ffi_gen/src/memory_syscalls.rs
# @ffi-gen-impl: Direct libc bindings (malloc/free/memcpy/memset)
# @ffi-gen-test: test/ffi/memory_syscalls_spec.spl
