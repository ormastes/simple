# Process Full Module - FFI Spec
#
# Complete process execution operations for the Simple runtime.
# Generates build/rust/ffi_gen/src/process.rs
#
# Usage: simple ffi-gen --gen-intern src/app/ffi_gen/specs/process_full.spl

use app.ffi_gen.intern_codegen (InternFnSpec, InternParamSpec)

fn process_full_specs() -> [InternFnSpec]:
    var specs: [InternFnSpec] = []

    # =========================================================================
    # Process Execution (Tuple Returns)
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_process_run", category: "process",
        params: [InternParamSpec(name: "cmd", value_type: "String"),
                 InternParamSpec(name: "args", value_type: "Value")],
        return_type: "Value", runtime_fn: "rt_process_run",
        doc: "Run process, returns (stdout, stderr, exit_code)"
    ))

    specs.push(InternFnSpec(
        name: "rt_process_run_timeout", category: "process",
        params: [InternParamSpec(name: "cmd", value_type: "String"),
                 InternParamSpec(name: "args", value_type: "Value"),
                 InternParamSpec(name: "timeout_ms", value_type: "i64")],
        return_type: "Value", runtime_fn: "rt_process_run_timeout",
        doc: "Run process with timeout, returns (stdout, stderr, exit_code)"
    ))

    specs.push(InternFnSpec(
        name: "rt_process_run_with_limits", category: "process",
        params: [InternParamSpec(name: "cmd", value_type: "String"),
                 InternParamSpec(name: "args", value_type: "Value"),
                 InternParamSpec(name: "timeout_ms", value_type: "i64"),
                 InternParamSpec(name: "memory_bytes", value_type: "i64"),
                 InternParamSpec(name: "cpu_seconds", value_type: "i64"),
                 InternParamSpec(name: "max_fds", value_type: "i64"),
                 InternParamSpec(name: "max_procs", value_type: "i64")],
        return_type: "Value", runtime_fn: "rt_process_run_with_limits",
        doc: "Run process with resource limits"
    ))

    # =========================================================================
    # Process Output
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_process_output", category: "process",
        params: [InternParamSpec(name: "cmd", value_type: "String"),
                 InternParamSpec(name: "args", value_type: "Value")],
        return_type: "String", runtime_fn: "rt_process_output",
        doc: "Run process and return stdout"
    ))

    # =========================================================================
    # Shell Commands
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_shell", category: "process",
        params: [InternParamSpec(name: "command", value_type: "String")],
        return_type: "String", runtime_fn: "rt_shell",
        doc: "Run shell command and return stdout"
    ))

    specs.push(InternFnSpec(
        name: "rt_shell_exec", category: "process",
        params: [InternParamSpec(name: "command", value_type: "String")],
        return_type: "i64", runtime_fn: "rt_shell_exec",
        doc: "Run shell command and return exit code"
    ))

    # =========================================================================
    # Output
    # =========================================================================

    specs.push(InternFnSpec(
        name: "rt_eprintln", category: "process",
        params: [InternParamSpec(name: "msg", value_type: "String")],
        return_type: "void", runtime_fn: "rt_eprintln",
        doc: "Print message to stderr"
    ))

    specs
