# Test Runner Core Constants
#
# Shared constants used by both host and client.
#
# IMPORTANT: Simple does not support top-level val declarations.
# Use the get_*() functions below or define constants inline where needed.
#
# Example:
#   val TEST_STATUS_PASSED: i32 = get_test_status_passed()
#   # OR simply:
#   if status == 2:  # TEST_STATUS_PASSED
#
# Constant Values Reference:
#
# Test Status:
#   PENDING=0, RUNNING=1, PASSED=2, FAILED=3, SKIPPED=4, TIMEOUT=5, CRASHED=6
#
# Protocol:
#   PROTO_MAGIC=0xAB, PROTO_VERSION=0x01
#
# Message Types:
#   MSG_READY=0x01, MSG_SUITE_START=0x10, MSG_SUITE_END=0x11
#   MSG_TEST_START=0x20, MSG_TEST_PASS=0x21, MSG_TEST_FAIL=0x22
#   MSG_TEST_SKIP=0x23, MSG_TEST_TIMEOUT=0x24, MSG_LOG=0x30
#   MSG_ASSERT_FAIL=0x40, MSG_COMPLETE=0xFF
#
# Format Styles:
#   FORMAT_SIMPLE=0, FORMAT_VERBOSE=1, FORMAT_DOC=2, FORMAT_JSON=3, FORMAT_JUNIT=4
#
# Loader Types:
#   LOADER_QEMU=0, LOADER_OPENOCD=1, LOADER_JLINK=2, LOADER_SERIAL=3
#
# Transport Types:
#   TRANSPORT_STDIO=0, TRANSPORT_SERIAL=1, TRANSPORT_TCP=2, TRANSPORT_FILE=3

# =========================================================================
# Test Status Constants
# =========================================================================

fn get_test_status_pending() -> i32:
    0

fn get_test_status_running() -> i32:
    1

fn get_test_status_passed() -> i32:
    2

fn get_test_status_failed() -> i32:
    3

fn get_test_status_skipped() -> i32:
    4

fn get_test_status_timeout() -> i32:
    5

fn get_test_status_crashed() -> i32:
    6

# =========================================================================
# Protocol Constants
# =========================================================================

fn get_proto_magic() -> i32:
    0xAB

fn get_proto_version() -> i32:
    0x01

fn get_proto_header_size() -> i32:
    5

# =========================================================================
# Message Types
# =========================================================================

fn get_msg_ready() -> i32:
    0x01

fn get_msg_suite_start() -> i32:
    0x10

fn get_msg_suite_end() -> i32:
    0x11

fn get_msg_test_start() -> i32:
    0x20

fn get_msg_test_pass() -> i32:
    0x21

fn get_msg_test_fail() -> i32:
    0x22

fn get_msg_test_skip() -> i32:
    0x23

fn get_msg_test_timeout() -> i32:
    0x24

fn get_msg_log() -> i32:
    0x30

fn get_msg_assert_fail() -> i32:
    0x40

fn get_msg_complete() -> i32:
    0xFF

# =========================================================================
# Output Format Constants
# =========================================================================

fn get_format_simple() -> i32:
    0

fn get_format_verbose() -> i32:
    1

fn get_format_doc() -> i32:
    2

fn get_format_json() -> i32:
    3

fn get_format_junit() -> i32:
    4

# =========================================================================
# Loader Types
# =========================================================================

fn get_loader_qemu() -> i32:
    0

fn get_loader_openocd() -> i32:
    1

fn get_loader_jlink() -> i32:
    2

fn get_loader_serial() -> i32:
    3

# =========================================================================
# Transport Types
# =========================================================================

fn get_transport_stdio() -> i32:
    0

fn get_transport_serial() -> i32:
    1

fn get_transport_tcp() -> i32:
    2

fn get_transport_file() -> i32:
    3

# =========================================================================
# Timeout Defaults
# =========================================================================

fn get_default_timeout_ms() -> i64:
    30000

fn get_default_test_timeout_ms() -> i64:
    5000

# =========================================================================
# Helper Functions
# =========================================================================

fn status_to_str(status: i32) -> text:
    if status == 0:
        "PENDING"
    elif status == 1:
        "RUNNING"
    elif status == 2:
        "PASSED"
    elif status == 3:
        "FAILED"
    elif status == 4:
        "SKIPPED"
    elif status == 5:
        "TIMEOUT"
    elif status == 6:
        "CRASHED"
    else:
        "UNKNOWN"

fn msg_type_to_str(msg_type: i32) -> text:
    if msg_type == 0x01:
        "READY"
    elif msg_type == 0x10:
        "SUITE_START"
    elif msg_type == 0x11:
        "SUITE_END"
    elif msg_type == 0x20:
        "TEST_START"
    elif msg_type == 0x21:
        "TEST_PASS"
    elif msg_type == 0x22:
        "TEST_FAIL"
    elif msg_type == 0x23:
        "TEST_SKIP"
    elif msg_type == 0x24:
        "TEST_TIMEOUT"
    elif msg_type == 0x30:
        "LOG"
    elif msg_type == 0x40:
        "ASSERT_FAIL"
    elif msg_type == 0xFF:
        "COMPLETE"
    else:
        "UNKNOWN"

fn format_to_str(format_type: i32) -> text:
    if format_type == 0:
        "simple"
    elif format_type == 1:
        "verbose"
    elif format_type == 2:
        "doc"
    elif format_type == 3:
        "json"
    elif format_type == 4:
        "junit"
    else:
        "unknown"

fn loader_to_str(loader_type: i32) -> text:
    if loader_type == 0:
        "qemu"
    elif loader_type == 1:
        "openocd"
    elif loader_type == 2:
        "jlink"
    elif loader_type == 3:
        "serial"
    else:
        "unknown"

fn transport_to_str(transport_type: i32) -> text:
    if transport_type == 0:
        "stdio"
    elif transport_type == 1:
        "serial"
    elif transport_type == 2:
        "tcp"
    elif transport_type == 3:
        "file"
    else:
        "unknown"
