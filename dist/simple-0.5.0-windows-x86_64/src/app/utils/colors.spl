# ANSI color codes and formatting utilities
# Provides terminal color support for CLI applications

export esc_char, reset, bold, dim, underline
export black, red, green, yellow, blue, magenta, cyan, white
export bg_black, bg_red, bg_green, bg_yellow, bg_blue, bg_magenta, bg_cyan, bg_white
export success, error, warning, info, debug
export colorize, strip_colors

# ANSI escape character helper
fn esc_char() -> text:
    # Return ASCII 27 (ESC) as character
    "{27 as char}"

# Base codes
fn reset() -> text:
    "{esc_char()}[0m"

fn bold() -> text:
    "{esc_char()}[1m"

fn dim() -> text:
    "{esc_char()}[2m"

fn underline() -> text:
    "{esc_char()}[4m"

# Foreground colors
fn black() -> text:
    "{esc_char()}[30m"

fn red() -> text:
    "{esc_char()}[31m"

fn green() -> text:
    "{esc_char()}[32m"

fn yellow() -> text:
    "{esc_char()}[33m"

fn blue() -> text:
    "{esc_char()}[34m"

fn magenta() -> text:
    "{esc_char()}[35m"

fn cyan() -> text:
    "{esc_char()}[36m"

fn white() -> text:
    "{esc_char()}[37m"

# Background colors
fn bg_black() -> text:
    "{esc_char()}[40m"

fn bg_red() -> text:
    "{esc_char()}[41m"

fn bg_green() -> text:
    "{esc_char()}[42m"

fn bg_yellow() -> text:
    "{esc_char()}[43m"

fn bg_blue() -> text:
    "{esc_char()}[44m"

fn bg_magenta() -> text:
    "{esc_char()}[45m"

fn bg_cyan() -> text:
    "{esc_char()}[46m"

fn bg_white() -> text:
    "{esc_char()}[47m"

# Semantic colors
fn success(text: text) -> text:
    "{green()}{text}{reset()}"

fn error(text: text) -> text:
    "{red()}{text}{reset()}"

fn warning(text: text) -> text:
    "{yellow()}{text}{reset()}"

fn info(text: text) -> text:
    "{cyan()}{text}{reset()}"

fn debug(text: text) -> text:
    "{dim()}{text}{reset()}"

# Colorize text with given color function
fn colorize(text: text, color_fn: fn() -> text) -> text:
    "{color_fn()}{text}{reset()}"

# Strip all ANSI color codes from text
fn strip_colors(text: text) -> text:
    # Remove all ANSI escape sequences
    # Pattern: ESC[...m
    val esc = esc_char()
    var result = text

    # Simple approach: replace common patterns
    # A full implementation would use regex
    result = result.replace("{esc}[0m", "")
    result = result.replace("{esc}[1m", "")
    result = result.replace("{esc}[2m", "")
    result = result.replace("{esc}[4m", "")

    # Colors 30-37 and 40-47
    for i in 30..48:
        result = result.replace("{esc}[{i}m", "")

    result
