#!/usr/bin/env simple
# XOR Problem - Pure Simple Deep Learning Demo
# Demonstrates tensor operations without neural network layers yet
#
# Uses concrete TensorF64 (non-generic) for interpreter compatibility

use lib.pure.tensor_f64 (from_data)
use lib.pure.tensor_f64_ops (matmul, relu)

fn main():
    print "=== Pure Simple Deep Learning - XOR Problem ==="
    print ""

    # Create simple tensors
    val x = from_data([0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0], [4, 2])
    print "Input X:"
    print x.to_string()
    print ""

    # Create a simple weight matrix
    val w = from_data([0.5, 0.3, -0.2, 0.7], [2, 2])
    print "Weight matrix W:"
    print w.to_string()
    print ""

    # Forward pass: y = ReLU(X @ W)
    val z = matmul(x, w)
    print "After matmul (X @ W):"
    print z.to_string()
    print ""

    val activated = relu(z)
    print "After ReLU:"
    print activated.to_string()
    print ""

    print "âœ“ Pure Simple tensor operations working!"
    print "Next steps: Implement autograd and training loop"

main()
