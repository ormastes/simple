use lib.pure.autograd (tensor_from_data, backward, tensor_mul_scalar)

fn main():
    print "Testing autograd with debug..."
    
    val x = tensor_from_data([3.0], [1], requires_grad: true)
    print "Created x, requires_grad: {x.requires_grad}"
    
    val y = tensor_mul_scalar(x, 2.0)
    print "Created y, requires_grad: {y.requires_grad}"
    print "y op_type is set: {y.op_type.?}"
    print "y inputs is set: {y.inputs.?}"
    
    print "\nCalling backward..."
    backward(y)
    
    print "After backward:"
    print "x.grad is set: {x.grad.?}"
    
    if x.grad.?:
        print "dy/dx = {x.grad.?.data[0]}"
    else:
        print "No gradient computed"

main()
