# @derive annotation spec
#
# Tests for the @derive annotation system
# (parsing support - actual codegen is done in annotation scanning)

# @derive(Eq, Clone, Display)
struct Color:
    r: i64
    g: i64
    b: i64

# @derive(Eq)
struct Point2D:
    x: i64
    y: i64

describe "@derive annotation parsing":
    it "struct with @derive comment can be constructed":
        val c = Color(r: 255, g: 128, b: 0)
        expect(c.r).to_equal(255)
        expect(c.g).to_equal(128)
        expect(c.b).to_equal(0)

    it "another derived struct works":
        val p = Point2D(x: 3, y: 4)
        expect(p.x).to_equal(3)
        expect(p.y).to_equal(4)

    it "derived struct fields are accessible":
        val c = Color(r: 0, g: 255, b: 0)
        val sum = c.r + c.g + c.b
        expect(sum).to_equal(255)
