# Struct update syntax spec
#
# Tests for `..base` spread in struct constructors

struct Point:
    x: i64
    y: i64

struct Config:
    host: text
    port: i64
    debug: bool

describe "struct update syntax":
    it "can copy a struct unchanged with spread":
        val base = Point(x: 1, y: 2)
        val copy = Point(..base)
        expect(copy.x).to_equal(1)
        expect(copy.y).to_equal(2)

    it "can override first field with spread for rest":
        val base = Point(x: 1, y: 2)
        val updated = Point(x: 10, ..base)
        expect(updated.x).to_equal(10)
        expect(updated.y).to_equal(2)

    it "can override multiple fields with spread":
        val base = Config(host: "localhost", port: 8080, debug: false)
        val prod = Config(host: "example.com", port: 443, ..base)
        expect(prod.host).to_equal("example.com")
        expect(prod.port).to_equal(443)
        expect(prod.debug).to_equal(false)

    it "spread-only copies all fields":
        val a = Config(host: "local", port: 3000, debug: true)
        val b = Config(..a)
        expect(b.host).to_equal("local")
        expect(b.port).to_equal(3000)
        expect(b.debug).to_equal(true)
