use compiler.visibility_checker.{VisibilityChecker, VisibilityWarning}
use compiler.hir_types.{Symbol, SymbolId, SymbolKind, ScopeId}
use compiler.core.lexer.Span

describe "VisibilityChecker static test":
    it "static factory works":
        val checker = VisibilityChecker.new("other.spl")
        val sym = Symbol(
            id: SymbolId(id: 1),
            name: "Helper",
            kind: SymbolKind.Class,
            type_: nil,
            scope: ScopeId(id: 0),
            span: Span.empty(),
            is_public: false,
            is_mutable: false,
            defining_module: Some("test_case.spl")
        )
        val warning = checker.check_symbol_access(sym, "test_case.spl", Span.empty())
        expect warning.?
        val w = warning.unwrap()
        expect w.code == "W0401"
        expect w.symbol_name == "Helper"
