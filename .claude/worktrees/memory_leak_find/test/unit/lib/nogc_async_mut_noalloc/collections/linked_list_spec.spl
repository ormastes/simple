# PoolLinkedList - Pool-Allocated Linked List Tests

describe "PoolLinkedList":

    describe "construction":
        it "creates empty list with node pool":
            val list = PoolLinkedList.new(8)
            expect(list.size()).to_equal(0)
            expect(list.is_empty()).to_equal(true)
            expect(list.is_full()).to_equal(false)

    describe "push_front":
        it "inserts at front":
            val list = PoolLinkedList.new(8)
            list.push_front(10)
            list.push_front(20)
            list.push_front(30)
            expect(list.peek_front()).to_equal(30)
            expect(list.peek_back()).to_equal(10)
            expect(list.size()).to_equal(3)

        it "returns false when pool exhausted":
            val list = PoolLinkedList.new(2)
            expect(list.push_front(1)).to_equal(true)
            expect(list.push_front(2)).to_equal(true)
            expect(list.push_front(3)).to_equal(false)

    describe "push_back":
        it "inserts at back":
            val list = PoolLinkedList.new(8)
            list.push_back(10)
            list.push_back(20)
            list.push_back(30)
            expect(list.peek_front()).to_equal(10)
            expect(list.peek_back()).to_equal(30)

    describe "pop_front":
        it "removes from front":
            val list = PoolLinkedList.new(8)
            list.push_back(10)
            list.push_back(20)
            list.push_back(30)
            expect(list.pop_front()).to_equal(10)
            expect(list.pop_front()).to_equal(20)
            expect(list.size()).to_equal(1)

        it "returns -1 when empty":
            val list = PoolLinkedList.new(4)
            expect(list.pop_front()).to_equal(-1)

    describe "pop_back":
        it "removes from back":
            val list = PoolLinkedList.new(8)
            list.push_back(10)
            list.push_back(20)
            list.push_back(30)
            expect(list.pop_back()).to_equal(30)
            expect(list.pop_back()).to_equal(20)
            expect(list.size()).to_equal(1)

        it "returns -1 when empty":
            val list = PoolLinkedList.new(4)
            expect(list.pop_back()).to_equal(-1)

    describe "contains":
        it "finds existing value":
            val list = PoolLinkedList.new(8)
            list.push_back(10)
            list.push_back(20)
            list.push_back(30)
            expect(list.contains(20)).to_equal(true)
            expect(list.contains(99)).to_equal(false)

    describe "node recycling":
        it "reuses freed nodes":
            val list = PoolLinkedList.new(2)
            list.push_back(10)
            list.push_back(20)
            expect(list.is_full()).to_equal(true)
            list.pop_front()
            expect(list.is_full()).to_equal(false)
            expect(list.push_back(30)).to_equal(true)
            expect(list.peek_back()).to_equal(30)

    describe "mixed operations":
        it "handles front and back operations together":
            val list = PoolLinkedList.new(8)
            list.push_front(10)
            list.push_back(20)
            list.push_front(5)
            list.push_back(25)
            # Order: 5, 10, 20, 25
            expect(list.pop_front()).to_equal(5)
            expect(list.pop_back()).to_equal(25)
            expect(list.size()).to_equal(2)
