# Date Formatting Module
# Format dates to various string representations

# ============================================================================
# Date Formatting
# ============================================================================

# Convert date to string in format "YYYY-MM-DD"
fn to_string(date: any) -> text:
    var year = date[0]
    var month = date[1]
    var day = date[2]

    var year_str = text_from_i64(year)
    var month_str = text_from_i64(month)
    var day_str = text_from_i64(day)

    # Pad month and day with leading zeros
    if month < 10:
        month_str = "0" + month_str
    if day < 10:
        day_str = "0" + day_str

    return year_str + "-" + month_str + "-" + day_str

# Convert date to ISO 8601 format (same as to_string)
fn to_iso8601(date: any) -> text:
    return to_string(date)

# Convert date to readable format "January 15, 2025"
fn to_readable(date: any) -> text:
    var year = date[0]
    var month = date[1]
    var day = date[2]

    var month_str = month_name(month)
    var day_str = text_from_i64(day)
    var year_str = text_from_i64(year)

    return month_str + " " + day_str + ", " + year_str

# Convert date to short format "Jan 15, 2025"
fn to_short(date: any) -> text:
    var year = date[0]
    var month = date[1]
    var day = date[2]

    var month_str = month_abbrev(month)
    var day_str = text_from_i64(day)
    var year_str = text_from_i64(year)

    return month_str + " " + day_str + ", " + year_str

# ============================================================================
# Helper Functions
# ============================================================================

# Convert integer to text
fn text_from_i64(n: i64) -> text:
    if n == 0:
        return "0"

    var negative = false
    var num = n
    if num < 0:
        negative = true
        num = 0 - num

    var digits = ""
    while num > 0:
        var digit = num % 10
        var digit_char = ""

        if digit == 0:
            digit_char = "0"
        if digit == 1:
            digit_char = "1"
        if digit == 2:
            digit_char = "2"
        if digit == 3:
            digit_char = "3"
        if digit == 4:
            digit_char = "4"
        if digit == 5:
            digit_char = "5"
        if digit == 6:
            digit_char = "6"
        if digit == 7:
            digit_char = "7"
        if digit == 8:
            digit_char = "8"
        if digit == 9:
            digit_char = "9"

        digits = digit_char + digits
        num = num / 10

    if negative:
        digits = "-" + digits

    return digits
