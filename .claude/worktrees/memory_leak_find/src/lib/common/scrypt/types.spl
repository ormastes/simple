# Scrypt Types Module
# Constants and parameter management

# =============================================================================
# CONSTANTS
# =============================================================================

# Default scrypt parameters for password hashing (interactive use)
val DEFAULT_N = 16384  # 2^14 - Memory cost
val DEFAULT_R = 8      # Block size
val DEFAULT_P = 1      # Parallelization
val DEFAULT_DKLEN = 32 # Derived key length (32 bytes = 256 bits)

# Recommended salt length (16 bytes = 128 bits)
val DEFAULT_SALT_LENGTH = 16

# Scrypt hash format prefix
val SCRYPT_PREFIX = "$scrypt$"

# Block size for Salsa20/8 (16 words = 64 bytes)
val SALSA20_BLOCK_SIZE = 16

# Number of rounds for Salsa20/8 (8 rounds = 4 double rounds)
val SALSA20_ROUNDS = 8

# =============================================================================
# PARAMETER VALIDATION AND CREATION
# =============================================================================

fn create_scrypt_params(N: i64, r: i64, p: i64, dkLen: i64):
    """Create scrypt parameter tuple.

    Parameters:
    - N: CPU/memory cost parameter (must be power of 2, > 1)
    - r: Block size parameter (typically 8)
    - p: Parallelization parameter (typically 1)
    - dkLen: Desired key length in bytes

    Returns: (N, r, p, dkLen) tuple

    Example:
        val params = create_scrypt_params(16384, 8, 1, 32)
    """
    (N, r, p, dkLen)

fn recommended_params():
    """Get recommended scrypt parameters for current hardware.

    Returns default parameters suitable for interactive use
    (web login, authentication, etc.).

    Returns: (N=16384, r=8, p=1, dkLen=32)

    Example:
        val params = recommended_params()
    """
    create_scrypt_params(DEFAULT_N, DEFAULT_R, DEFAULT_P, DEFAULT_DKLEN)

fn low_memory_params():
    """Get low memory scrypt parameters.

    Suitable for embedded systems or memory-constrained environments.
    Uses ~4 MB of memory.

    Returns: (N=4096, r=8, p=1, dkLen=32)

    Example:
        val params = low_memory_params()
    """
    create_scrypt_params(4096, DEFAULT_R, DEFAULT_P, DEFAULT_DKLEN)

fn high_security_params():
    """Get high security scrypt parameters.

    Suitable for sensitive data protection.
    Uses ~32 MB of memory.

    Returns: (N=32768, r=8, p=1, dkLen=32)

    Example:
        val params = high_security_params()
    """
    create_scrypt_params(32768, DEFAULT_R, DEFAULT_P, DEFAULT_DKLEN)

fn file_encryption_params():
    """Get scrypt parameters for file encryption.

    Very high security for file encryption use cases.
    Uses ~1 GB of memory.

    Returns: (N=1048576, r=8, p=1, dkLen=32)

    Example:
        val params = file_encryption_params()
    """
    create_scrypt_params(1048576, DEFAULT_R, DEFAULT_P, DEFAULT_DKLEN)

fn params_interactive():
    """Interactive login parameters.

    Same as recommended_params().
    """
    recommended_params()

fn params_moderate():
    """Moderate security parameters.

    Balance between security and performance.
    """
    create_scrypt_params(16384, 8, 1, 32)

fn params_sensitive():
    """Sensitive data parameters.

    Higher security for sensitive applications.
    """
    high_security_params()

fn params_very_sensitive():
    """Very sensitive data parameters.

    Maximum practical security.
    """
    create_scrypt_params(65536, 8, 1, 32)

fn params_embedded():
    """Embedded system parameters.

    Low memory usage for constrained devices.
    """
    low_memory_params()

fn params_from_tuple(tuple):
    """Create params from any 4-element tuple.

    Example:
        val params = params_from_tuple((16384, 8, 1, 32))
    """
    tuple
