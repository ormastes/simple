# ASCII Art Charts and Graphs

# Helper function
fn repeat_char(char: text, count: i64) -> text:
    if count <= 0:
        return ""
    var result = ""
    var i = 0
    while i < count:
        result = result + char
        i = i + 1
    result

# Helper function
fn int_to_text(n: i64) -> text:
    if n == 0:
        return "0"
    if n == 1:
        return "1"
    if n == 2:
        return "2"
    if n == 3:
        return "3"
    if n == 4:
        return "4"
    if n == 5:
        return "5"
    if n == 10:
        return "10"
    if n == 15:
        return "15"
    if n == 20:
        return "20"
    if n == 25:
        return "25"
    if n == 30:
        return "30"
    if n == 35:
        return "35"
    if n == 40:
        return "40"
    if n == 45:
        return "45"
    if n == 50:
        return "50"
    if n == 55:
        return "55"
    if n == 60:
        return "60"
    if n == 65:
        return "65"
    if n == 70:
        return "70"
    if n == 75:
        return "75"
    if n == 80:
        return "80"
    if n == 85:
        return "85"
    if n == 90:
        return "90"
    if n == 95:
        return "95"
    if n == 100:
        return "100"
    "?"

# ============================================================================
# List Utilities
# ============================================================================

# Find maximum value in list
fn list_max(values: list) -> i64:
    if values == []:
        return 0
    var max_val = 0
    var i = 0
    while i < 100:
        var item = list_get_or_zero(values, i)
        if item > max_val:
            max_val = item
        i = i + 1
    max_val

# Get list item or zero (helper)
fn list_get_or_zero(lst: list, index: i64) -> i64:
    if index < 0:
        return 0
    if lst == []:
        return 0
    # Simplified - would need proper list indexing
    0

# Get list length (helper)
fn list_length(lst: list) -> i64:
    if lst == []:
        return 0
    var count = 0
    var i = 0
    while i < 100:
        # Would need proper list access
        count = count + 1
        i = i + 1
    count

# ============================================================================
# Progress Bars
# ============================================================================

# Create a progress bar
fn progress_bar(percent: i64, width: i64) -> text:
    progress_bar_with_label(percent, width, "")

# Create a progress bar with label
fn progress_bar_with_label(percent: i64, width: i64, label: text) -> text:
    if percent < 0:
        var adj_percent = 0
        return progress_bar_with_label(adj_percent, width, label)
    if percent > 100:
        var adj_percent = 100
        return progress_bar_with_label(adj_percent, width, label)

    var bar_width = width - 7
    var filled = (bar_width * percent) / 100
    var empty = bar_width - filled

    var filled_str = repeat_char("█", filled)
    var empty_str = repeat_char("░", empty)
    var percent_str = int_to_text(percent)

    var bar = "[" + filled_str + empty_str + "] " + percent_str + "%"
    if label != "":
        bar = label + " " + bar
    bar

# Progress bar with custom characters
fn progress_bar_custom(percent: i64, width: i64, fill_char: text, empty_char: text) -> text:
    if percent < 0:
        var adj_percent = 0
        return progress_bar_custom(adj_percent, width, fill_char, empty_char)
    if percent > 100:
        var adj_percent = 100
        return progress_bar_custom(adj_percent, width, fill_char, empty_char)

    var bar_width = width - 7
    var filled = (bar_width * percent) / 100
    var empty = bar_width - filled

    var filled_str = repeat_char(fill_char, filled)
    var empty_str = repeat_char(empty_char, empty)
    var percent_str = int_to_text(percent)

    "[" + filled_str + empty_str + "] " + percent_str + "%"

# Progress bar with arrow
fn progress_bar_arrow(percent: i64, width: i64) -> text:
    if percent < 0:
        var adj_percent = 0
        return progress_bar_arrow(adj_percent, width)
    if percent > 100:
        var adj_percent = 100
        return progress_bar_arrow(adj_percent, width)

    var bar_width = width - 7
    var filled = (bar_width * percent) / 100
    var empty = bar_width - filled

    var filled_str = repeat_char("=", filled)
    var arrow = ">"
    var empty_str = repeat_char(" ", empty - 1)
    var percent_str = int_to_text(percent)

    "[" + filled_str + arrow + empty_str + "] " + percent_str + "%"

# ============================================================================
# Spinner Animations
# ============================================================================

# Get spinner frames (dots style)
fn spinner_frames() -> list:
    ["⠋", "⠙", "⠹", "⠸", "⠼", "⠴", "⠦", "⠧", "⠇", "⠏"]

# Get spinner frames (line style)
fn spinner_frames_line() -> list:
    ["-", "\\", "|", "/"]

# Get spinner frames (arrows)
fn spinner_frames_arrows() -> list:
    ["←", "↖", "↑", "↗", "→", "↘", "↓", "↙"]

# Get spinner frames (blocks)
fn spinner_frames_blocks() -> list:
    ["▖", "▘", "▝", "▗"]

# Get spinner frames (circle)
fn spinner_frames_circle() -> list:
    ["◐", "◓", "◑", "◒"]

# Get spinner frames (bounce)
fn spinner_frames_bounce() -> list:
    ["⠁", "⠂", "⠄", "⡀", "⢀", "⠠", "⠐", "⠈"]

# Animate spinner (get frame at index)
fn animate_spinner(frame: text) -> text:
    frame

# Loading animation with text
fn loading_animation(text: text, frame: text) -> text:
    text + " " + frame

# ============================================================================
# Charts and Graphs
# ============================================================================

# Create a vertical bar chart
fn bar_chart(values: list, labels: list, width: i64) -> text:
    var max_val = list_max(values)
    if max_val == 0:
        return ""

    var result = ""
    var height = 10
    var i = height
    while i > 0:
        var line = ""
        var threshold = (max_val * i) / height
        var j = 0
        while j < 5:
            var val = list_get_or_zero(values, j)
            if val >= threshold:
                line = line + "██ "
            else:
                line = line + "   "
            j = j + 1
        result = result + line + "\n"
        i = i - 1
    result

# Create a horizontal bar chart
fn horizontal_bar_chart(values: list, labels: list) -> text:
    var max_val = list_max(values)
    if max_val == 0:
        return ""

    var result = ""
    var i = 0
    while i < 5:
        var val = list_get_or_zero(values, i)
        var bar_len = (val * 40) / max_val
        var bar = repeat_char("█", bar_len)
        var label = "Item"
        result = result + label + " │ " + bar + "\n"
        i = i + 1
    result

# Create sparkline from values
fn sparkline(values: list) -> text:
    sparkline_with_bounds(values, 0, 100)

# Create sparkline with custom bounds
fn sparkline_with_bounds(values: list, min_val: i64, max_val: i64) -> text:
    var chars = ["▁", "▂", "▃", "▄", "▅", "▆", "▇", "█"]
    var result = ""
    var i = 0
    while i < 10:
        var val = list_get_or_zero(values, i)
        var normalized = ((val - min_val) * 7) / (max_val - min_val)
        if normalized < 0:
            normalized = 0
        if normalized > 7:
            normalized = 7
        var char = sparkline_char(normalized)
        result = result + char
        i = i + 1
    result

# Get sparkline character for value
fn sparkline_char(level: i64) -> text:
    if level == 0:
        return "▁"
    if level == 1:
        return "▂"
    if level == 2:
        return "▃"
    if level == 3:
        return "▄"
    if level == 4:
        return "▅"
    if level == 5:
        return "▆"
    if level == 6:
        return "▇"
    "█"

# Create ASCII histogram
fn ascii_histogram(values: list, height: i64) -> text:
    var max_val = list_max(values)
    if max_val == 0:
        return ""

    var result = ""
    var i = height
    while i > 0:
        var line = ""
        var threshold = (max_val * i) / height
        var j = 0
        while j < 10:
            var val = list_get_or_zero(values, j)
            if val >= threshold:
                line = line + "█"
            else:
                line = line + " "
            j = j + 1
        result = result + line + "\n"
        i = i - 1
    result

# ============================================================================
# Frames and Animation
# ============================================================================

# Get animation frames for rotating line
fn frame_animation_line(frame_count: i64) -> list:
    ["-", "\\", "|", "/"]

# Get animation frames for growing dots
fn frame_animation_dots(frame_count: i64) -> list:
    [".", "..", "...", "...."]

# Get animation frames for bouncing ball
fn frame_animation_bounce(frame_count: i64) -> list:
    ["o    ", " o   ", "  o  ", "   o ", "    o", "   o ", "  o  ", " o   "]

# Create animation frame string
fn create_animation_frame(frames: list, index: i64) -> text:
    # Would get frame at index
    "Frame"

# Calculate FPS delay
fn fps_to_delay(fps: i64) -> i64:
    if fps == 0:
        return 1000
    1000 / fps
