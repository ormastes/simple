# Map Creation Functions

fn map_create():
    """Create an empty map.

    Example:
        val m = map_create()  # []
    """
    []

fn map_from_array(pairs):
    """Create map from array of (key, value) tuples.

    Same as map itself, but normalizes duplicates (last wins).

    Example:
        val m = map_from_array([("x", 1), ("y", 2)])
        map_get(m, "x")  # 1
    """
    var result = map_create()
    var i = 0
    while i < pairs.len():
        val pair = pairs[i]
        result = map_put(result, pair[0], pair[1])
        i = i + 1
    result

fn map_to_array(map):
    """Convert map to array of (key, value) tuples.

    Same as map itself, provided for consistency.

    Example:
        val m = map_put(map_create(), "x", 1)
        map_to_array(m)  # [("x", 1)]
    """
    map

fn map_from_entries(entries):
    """Create map from array of (key, value) tuples.

    Alias for map_from_array.
    """
    map_from_array(entries)

fn map_from_keys(keys, value_fn):
    """Create map from array of keys using function to generate values.

    Example:
        val m = map_from_keys(["x", "y"], \k: k.len())
        map_get(m, "x")  # 1
    """
    var result = map_create()
    var i = 0
    while i < keys.len():
        val key = keys[i]
        val value = value_fn(key)
        result = map_put(result, key, value)
        i = i + 1
    result

fn map_from_values(values, key_fn):
    """Create map from array of values using function to generate keys.

    Example:
        val m = map_from_values([1, 2, 3], \v: "key{v}")
        map_get(m, "key1")  # 1
    """
    var result = map_create()
    var i = 0
    while i < values.len():
        val value = values[i]
        val key = key_fn(value)
        result = map_put(result, key, value)
        i = i + 1
    result
