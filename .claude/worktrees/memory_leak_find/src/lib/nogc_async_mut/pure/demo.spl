# Pure Simple DL Demo
# Verify all modules work together

use std.pure.tensor (PureTensor)
use std.pure.tensor_ops (add, mul, matmul, relu)
use std.pure.nn (Linear, ReLU)
use std.pure.training (LinearModel, compute_mse, compute_gradients)
use std.pure.data (normalize)

print "Pure Simple DL - Module Integration Test"
print "=" * 50
print ""

# Test 1: Tensor creation
print "Test 1: Tensor Operations"
val t1 = PureTensor.zeros([2, 3])
val t2 = PureTensor.ones([2, 3])
val t3 = add(t1, t2)
print "âœ… Tensor creation and addition: {t3.data[0] == 1.0}"
print ""

# Test 2: NN Layer
print "Test 2: Neural Network Layer"
val linear = Linear.create(in_features: 3, out_features: 2, use_bias: true)
val x = PureTensor.from_data([1.0, 2.0, 3.0], [3])
val y = linear.forward(x)
print "âœ… Linear layer forward pass: shape = {y.shape}"
print ""

# Test 3: Training
print "Test 3: Training (Linear Regression)"
val x_train = PureTensor.from_data([1.0, 2.0, 3.0, 4.0], [4])
val y_train = PureTensor.from_data([3.0, 5.0, 7.0, 9.0], [4])
var model = LinearModel(w: 0.5, b: 0.0)
val pred = model.forward(x_train)
val loss = compute_mse(pred, y_train)
print "âœ… Training setup: initial loss = {loss}"
print ""

# Test 4: Data normalization
print "Test 4: Data Utilities"
val data = [1.0, 2.0, 3.0, 4.0, 5.0]
val normed = normalize(data)
print "âœ… Normalization: min = {normed[0]}, max = {normed[4]}"
print ""

print "=" * 50
print "ðŸŽ‰ All Pure Simple DL modules working!"
print "=" * 50
