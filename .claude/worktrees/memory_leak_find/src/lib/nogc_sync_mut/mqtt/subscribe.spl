# ============================================================================

fn mqtt_create_puback_packet(packet_id):
    """Create a PUBACK packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_PUBACK, 0, headers, nil)

fn mqtt_create_pubrec_packet(packet_id):
    """Create a PUBREC packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_PUBREC, 0, headers, nil)

fn mqtt_create_pubrel_packet(packet_id):
    """Create a PUBREL packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_PUBREL, 2, headers, nil)

fn mqtt_create_pubcomp_packet(packet_id):
    """Create a PUBCOMP packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_PUBCOMP, 0, headers, nil)

fn mqtt_pubx_get_packet_id(packet):
    """Get packet ID from PUBACK/PUBREC/PUBREL/PUBCOMP packet."""
    val headers = mqtt_packet_headers(packet)
    val parts = headers
    parts[0]

# ============================================================================
# SUBSCRIBE Packet Functions
# ============================================================================

fn mqtt_create_subscribe_packet(packet_id, topic_filters):
    """Create a SUBSCRIBE packet.
    topic_filters: list of (topic, qos) tuples."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_SUBSCRIBE, 2, headers, topic_filters)

fn mqtt_subscribe_get_packet_id(packet):
    """Get packet ID from SUBSCRIBE packet."""
    val headers = mqtt_packet_headers(packet)
    val parts = headers
    parts[0]

fn mqtt_subscribe_get_topic_filters(packet):
    """Get topic filters from SUBSCRIBE packet."""
    mqtt_packet_payload(packet)

fn mqtt_subscribe_add_topic_filter(packet, topic, qos):
    """Add a topic filter to SUBSCRIBE packet."""
    val old_filters = mqtt_packet_payload(packet)
    val new_filter = (topic, qos)
    val new_filters = old_filters + [new_filter]
    mqtt_set_packet_payload(packet, new_filters)

# ============================================================================
# SUBACK Packet Functions
# ============================================================================

fn mqtt_create_suback_packet(packet_id, return_codes):
    """Create a SUBACK packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_SUBACK, 0, headers, return_codes)

fn mqtt_suback_get_packet_id(packet):
    """Get packet ID from SUBACK packet."""
    val headers = mqtt_packet_headers(packet)
    val parts = headers
    parts[0]

fn mqtt_suback_get_return_codes(packet):
    """Get return codes from SUBACK packet."""
    mqtt_packet_payload(packet)

# ============================================================================
# UNSUBSCRIBE Packet Functions
# ============================================================================

fn mqtt_create_unsubscribe_packet(packet_id, topics):
    """Create an UNSUBSCRIBE packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_UNSUBSCRIBE, 2, headers, topics)

fn mqtt_unsubscribe_get_packet_id(packet):
    """Get packet ID from UNSUBSCRIBE packet."""
    val headers = mqtt_packet_headers(packet)
    val parts = headers
    parts[0]

fn mqtt_unsubscribe_get_topics(packet):
    """Get topics from UNSUBSCRIBE packet."""
    mqtt_packet_payload(packet)

# ============================================================================
# UNSUBACK Packet Functions
# ============================================================================

fn mqtt_create_unsuback_packet(packet_id):
    """Create an UNSUBACK packet."""
    val headers = (packet_id, nil)
    mqtt_create_packet(PACKET_TYPE_UNSUBACK, 0, headers, nil)

fn mqtt_unsuback_get_packet_id(packet):
    """Get packet ID from UNSUBACK packet."""
    val headers = mqtt_packet_headers(packet)
    val parts = headers
    parts[0]

# ============================================================================
