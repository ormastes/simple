# Text/String Utility Functions
#
# Thin re-export wrapper around string_core.spl for compatibility.
# All core string operations are now in string_core.spl.

# Import from string_core
use std.string_core.{
    str_char_at, str_contains, str_starts_with, str_ends_with,
    str_trim, str_split, str_join, str_index_of, str_last_index_of,
    str_replace, str_replace_all
}

# Re-export for compatibility
export str_char_at, str_contains, str_starts_with, str_ends_with
export str_trim, str_split, str_join, str_index_of, str_last_index_of

# Additional wrappers that don't exist in string_core

fn str_trim_left(s: text) -> text:
    """Remove leading whitespace."""
    s.trim_start()

fn str_trim_right(s: text) -> text:
    """Remove trailing whitespace."""
    s.trim_end()

fn str_to_upper(s: text) -> text:
    """Convert string to uppercase."""
    s.to_upper()

fn str_to_lower(s: text) -> text:
    """Convert string to lowercase."""
    s.to_lower()

fn str_substring(s: text, start: i64, end: i64) -> text:
    """Extract substring from start (inclusive) to end (exclusive)."""
    if start < 0 or end > s.len() or start >= end:
        return ""
    s[start:end]

fn str_is_empty(s: text) -> bool:
    """Check if string is empty."""
    s.len() == 0

fn str_find(s: text, needle: text) -> i64:
    """Find first occurrence of needle in s, return index or -1 if not found."""
    str_index_of(s, needle)

fn str_replace(s: text, old: text, new: text) -> text:
    """Replace all occurrences of old with new in string s."""
    str_replace_all(s, old, new)

fn str_count(s: text, needle: text) -> i64:
    """Count occurrences of needle in s."""
    if needle == "":
        return s.len() + 1
    val parts = s.split(needle)
    parts.len() - 1

export str_trim_left, str_trim_right, str_to_upper, str_to_lower
export str_substring, str_is_empty, str_find, str_replace, str_count
