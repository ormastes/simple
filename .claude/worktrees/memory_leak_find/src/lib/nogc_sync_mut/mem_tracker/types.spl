# Memory Tracker — Type Definitions
#
# Data structures for memory allocation tracking and leak detection.

struct MemSnapshot:
    id: i64
    live_count: i64
    live_bytes: i64

struct MemLeakEntry:
    alloc_id: i64
    size: i64
    tag: text

# Diff between two snapshots — shows what was added (leaked) between them
struct MemDiff:
    before_id: i64
    before_count: i64
    before_bytes: i64
    after_id: i64
    after_count: i64
    after_bytes: i64
    added_count: i64
    added_bytes: i64
    leaked_entries: [MemLeakEntry]

# Named phase snapshot — captures memory state at a labeled point in time
struct MemPhaseSnapshot:
    name: text
    snapshot: MemSnapshot

# Tag group — allocations grouped by their tag
struct MemTagGroup:
    tag: text
    count: i64
    total_bytes: i64

# Full leak report with multiple phase diffs
struct MemLeakReport:
    phases: [MemPhaseSnapshot]
    diffs: [MemDiff]
    tag_groups: [MemTagGroup]
    total_leaked_count: i64
    total_leaked_bytes: i64

export MemSnapshot, MemLeakEntry
export MemDiff, MemPhaseSnapshot, MemTagGroup, MemLeakReport
