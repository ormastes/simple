# Buffer Creation Functions

# Create a new buffer with specified capacity
fn buffer_create(capacity: i64) -> Buffer:
    val data_list = []
    var i = 0
    while i < capacity:
        data_list.append(0)
        i = i + 1
    Buffer(data: data_list, read_pos: 0, write_pos: 0, cap: capacity)

# Create buffer from existing array
fn buffer_from_array(arr: List) -> Buffer:
    val data_copy = []
    var i = 0
    while i < arr.len():
        data_copy.append(arr.get(i))
        i = i + 1
    val cap_val = arr.len()
    Buffer(data: data_copy, read_pos: 0, write_pos: cap_val, cap: cap_val)

# Create buffer from string (UTF-8 bytes)
fn buffer_from_string(s: text) -> Buffer:
    val bytes = string_to_bytes(s)
    buffer_from_array(bytes)

# Allocate a buffer filled with a specific byte value
fn buffer_allocate(capacity: i64, fill_byte: i64) -> Buffer:
    val data_list = []
    var i = 0
    while i < capacity:
        data_list.append(fill_byte)
        i = i + 1
    Buffer(data: data_list, read_pos: 0, write_pos: capacity, cap: capacity)

# Forward declaration
fn string_to_bytes(s: text) -> List
