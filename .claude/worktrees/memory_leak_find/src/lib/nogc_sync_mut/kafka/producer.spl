# Apache Kafka Producer Module
# Producer API structures and functions

import kafka.types

# ============================================================================
# Producer API
# ============================================================================

# Produce request body: (acks, timeout_ms, topic_data)
# topic_data: [(topic_name, partition_data)]
# partition_data: [(partition_id, record_batch)]
fn create_produce_request_body(acks: i64, timeout_ms: i64, topic_data: list) -> list:
    [acks, timeout_ms, topic_data]

fn get_produce_request_acks(body: list) -> i64:
    body[0]

fn get_produce_request_timeout(body: list) -> i64:
    body[1]

fn get_produce_request_topic_data(body: list) -> list:
    body[2]

# Produce response body: (throttle_time_ms, topic_data)
# topic_data: [(topic_name, partition_data)]
# partition_data: [(partition_id, error_code, base_offset, log_append_time, log_start_offset)]
fn create_produce_response_body(throttle_time_ms: i64, topic_data: list) -> list:
    [throttle_time_ms, topic_data]

fn get_produce_response_throttle_time(body: list) -> i64:
    body[0]

fn get_produce_response_topic_data(body: list) -> list:
    body[1]

# Produce partition response: (partition_id, error_code, base_offset, log_append_time, log_start_offset)
fn create_produce_partition_response(partition_id: i64, error_code: i64, base_offset: i64, log_append_time: i64, log_start_offset: i64) -> list:
    [partition_id, error_code, base_offset, log_append_time, log_start_offset]

fn get_produce_partition_response_id(response: list) -> i64:
    response[0]

fn get_produce_partition_response_error(response: list) -> i64:
    response[1]

fn get_produce_partition_response_base_offset(response: list) -> i64:
    response[2]

fn get_produce_partition_response_log_append_time(response: list) -> i64:
    response[3]

fn get_produce_partition_response_log_start_offset(response: list) -> i64:
    response[4]
