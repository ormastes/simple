# LoadedModuleView - bridges module loader output to parser input
# Carries the loaded module source text and metadata from
# the module loader into the parser pipeline stage.

struct LoadedModuleView:
    """A loaded module source ready for parsing."""
    module_name: text
    source_text: text
    file_path: text
    byte_count: i64

    fn is_empty() -> bool:
        self.byte_count == 0

    fn has_source() -> bool:
        self.byte_count > 0

    static fn from_source(name: text, path: text, src: text) -> LoadedModuleView:
        LoadedModuleView(
            module_name: name,
            source_text: src,
            file_path: path,
            byte_count: src.len()
        )

    static fn empty(name: text) -> LoadedModuleView:
        LoadedModuleView(
            module_name: name,
            source_text: "",
            file_path: "",
            byte_count: 0
        )


# Desugared static methods for bootstrap interpreter compatibility

fn LoadedModuleView__from_source(name: text, path: text, src: text) -> LoadedModuleView:
    LoadedModuleView(
        module_name: name,
        source_text: src,
        file_path: path,
        byte_count: src.len()
    )



fn None__empty(name: text) -> LoadedModuleView:
    LoadedModuleView(
        module_name: name,
        source_text: "",
        file_path: "",
        byte_count: 0
    )


export LoadedModuleView
