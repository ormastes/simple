# SMF Enums - Shared type definitions for SMF format
#
# This module defines the core enums used in the Simple Module Format (SMF):
# - Platform: OS/target platform identifiers
# - Arch: CPU architecture identifiers
# - CompressionType: Compression algorithm identifiers
# - SmfAppType: Application type hints for runtime optimization
#
# Ported from: rust/runtime/src/loader/smf/header.rs
# Pattern: Follow mir_data.spl enum style with round-trip u8 conversion

# ============================================================================
# Platform Enum
# ============================================================================

"""SMF platform identifier (maps to TargetOS)."""
enum Platform:
    Any          # Platform-independent (0)
    Linux        # Linux (1)
    Windows      # Windows (2)
    MacOS        # macOS (3)
    FreeBSD      # FreeBSD (4)
    None_        # Bare metal (5)

impl Platform:
    """Convert from u8 value. Returns Platform.Any for unknown values."""
    static fn from_u8(value: u8) -> Platform:
        match value:
            0: Platform.Any
            1: Platform.Linux
            2: Platform.Windows
            3: Platform.MacOS
            4: Platform.FreeBSD
            5: Platform.None_
            _: Platform.Any  # Default for unknown values

    """Convert to u8 value."""
    fn to_u8() -> u8:
        match self:
            Platform.Any: 0
            Platform.Linux: 1
            Platform.Windows: 2
            Platform.MacOS: 3
            Platform.FreeBSD: 4
            Platform.None_: 5

    """Get platform name as string."""
    fn name() -> text:
        match self:
            Platform.Any: "any"
            Platform.Linux: "linux"
            Platform.Windows: "windows"
            Platform.MacOS: "macos"
            Platform.FreeBSD: "freebsd"
            Platform.None_: "none"

# ============================================================================
# Arch Enum
# ============================================================================

"""SMF architecture identifier (maps to TargetArch)."""
enum Arch:
    X86_64       # x86-64 (0)
    Aarch64      # ARM64 (1)
    X86          # x86 32-bit (2)
    Arm          # ARM 32-bit (3)
    Riscv64      # RISC-V 64-bit (4)
    Riscv32      # RISC-V 32-bit (5)
    Wasm32       # WebAssembly 32-bit (6)
    Wasm64       # WebAssembly 64-bit (7)

impl Arch:
    """Convert from u8 value. Returns Arch.X86_64 for unknown values."""
    static fn from_u8(value: u8) -> Arch:
        match value:
            0: Arch.X86_64
            1: Arch.Aarch64
            2: Arch.X86
            3: Arch.Arm
            4: Arch.Riscv64
            5: Arch.Riscv32
            6: Arch.Wasm32
            7: Arch.Wasm64
            _: Arch.X86_64  # Default for unknown values

    """Convert to u8 value."""
    fn to_u8() -> u8:
        match self:
            Arch.X86_64: 0
            Arch.Aarch64: 1
            Arch.X86: 2
            Arch.Arm: 3
            Arch.Riscv64: 4
            Arch.Riscv32: 5
            Arch.Wasm32: 6
            Arch.Wasm64: 7

    """Get architecture name as string."""
    fn name() -> text:
        match self:
            Arch.X86_64: "x86_64"
            Arch.Aarch64: "aarch64"
            Arch.X86: "x86"
            Arch.Arm: "arm"
            Arch.Riscv64: "riscv64"
            Arch.Riscv32: "riscv32"
            Arch.Wasm32: "wasm32"
            Arch.Wasm64: "wasm64"

    """Check if this is a 32-bit architecture."""
    fn is_32bit() -> bool:
        match self:
            Arch.X86: true
            Arch.Arm: true
            Arch.Riscv32: true
            Arch.Wasm32: true
            _: false

    """Check if this is a 64-bit architecture."""
    fn is_64bit() -> bool:
        match self:
            Arch.X86_64: true
            Arch.Aarch64: true
            Arch.Riscv64: true
            Arch.Wasm64: true
            _: false

# ============================================================================
# CompressionType Enum
# ============================================================================

"""SMF compression type (v1.1+)."""
enum CompressionType:
    None_        # No compression (0)
    Zstd         # Zstandard compression - high ratio (1)
    Lz4          # LZ4 compression - high speed (2)

impl CompressionType:
    """Convert from u8 value. Returns CompressionType.None_ for unknown values."""
    static fn from_u8(value: u8) -> CompressionType:
        match value:
            0: CompressionType.None_
            1: CompressionType.Zstd
            2: CompressionType.Lz4
            _: CompressionType.None_  # Default for unknown values

    """Convert to u8 value."""
    fn to_u8() -> u8:
        match self:
            CompressionType.None_: 0
            CompressionType.Zstd: 1
            CompressionType.Lz4: 2

    """Get compression name as string."""
    fn name() -> text:
        match self:
            CompressionType.None_: "none"
            CompressionType.Zstd: "zstd"
            CompressionType.Lz4: "lz4"

# ============================================================================
# SmfAppType Enum
# ============================================================================

"""SMF application type identifier.

Application types provide hints to the runtime for optimal resource
allocation and initialization:
- Cli: Command-line tool (minimal resources)
- Tui: Terminal UI application (terminal mode, buffers)
- Gui: Graphical application (window, GPU context)
- Service: Background service/daemon (IPC, signal handlers)
- Repl: Interactive REPL (history, line editor)
"""
enum SmfAppType:
    Cli          # Command-line tool (0)
    Tui          # Terminal UI application (1)
    Gui          # Graphical application (2)
    Service      # Background service/daemon (3)
    Repl         # Interactive REPL (4)

impl SmfAppType:
    """Convert from u8 value. Returns SmfAppType.Cli for unknown values."""
    static fn from_u8(value: u8) -> SmfAppType:
        match value:
            0: SmfAppType.Cli
            1: SmfAppType.Tui
            2: SmfAppType.Gui
            3: SmfAppType.Service
            4: SmfAppType.Repl
            _: SmfAppType.Cli  # Default for unknown values

    """Convert to u8 value."""
    fn to_u8() -> u8:
        match self:
            SmfAppType.Cli: 0
            SmfAppType.Tui: 1
            SmfAppType.Gui: 2
            SmfAppType.Service: 3
            SmfAppType.Repl: 4

    """Get app type name as string."""
    fn name() -> text:
        match self:
            SmfAppType.Cli: "cli"
            SmfAppType.Tui: "tui"
            SmfAppType.Gui: "gui"
            SmfAppType.Service: "service"
            SmfAppType.Repl: "repl"


# Auto-generated desugared static method wrappers
fn Arch__from_u8(value: u8) -> Arch:
    match value:
        0: Arch.X86_64
        1: Arch.Aarch64
        2: Arch.X86
        3: Arch.Arm
        4: Arch.Riscv64
        5: Arch.Riscv32
        6: Arch.Wasm32
        7: Arch.Wasm64
        _: Arch.X86_64  # Default for unknown values


fn CompressionType__from_u8(value: u8) -> CompressionType:
    match value:
        0: CompressionType.None_
        1: CompressionType.Zstd
        2: CompressionType.Lz4
        _: CompressionType.None_  # Default for unknown values


fn Platform__from_u8(value: u8) -> Platform:
    match value:
        0: Platform.Any
        1: Platform.Linux
        2: Platform.Windows
        3: Platform.MacOS
        4: Platform.FreeBSD
        5: Platform.None_
        _: Platform.Any  # Default for unknown values


fn SmfAppType__from_u8(value: u8) -> SmfAppType:
    match value:
        0: SmfAppType.Cli
        1: SmfAppType.Tui
        2: SmfAppType.Gui
        3: SmfAppType.Service
        4: SmfAppType.Repl
        _: SmfAppType.Cli  # Default for unknown values

