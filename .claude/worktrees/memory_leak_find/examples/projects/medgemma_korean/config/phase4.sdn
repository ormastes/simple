# Phase 4: Korean Text Training (Note.md Phase 3)
# Per-layer CE loss + English retention monitoring

extends: "base.sdn"

training:
  epochs: 5
  learning_rate: 0.0005
  max_length: 512
  max_samples: 3000

per_layer_ce:
  enabled: true
  monitor_layers: [1, 2, 3]

english_retention:
  threshold: 0.97
  recovery_batches: 10
  recovery_lr_scale: 0.5

data:
  type: "korean_text"
  path: "example/medgemma_korean/data/korean_text"
  format: "jsonl"

previous_loras:
  - "example/medgemma_korean/models/phase2/lora_2"

output:
  lora_path: "example/medgemma_korean/models/phase4/lora_3"
  merged_path: "example/medgemma_korean/models/phase4/merged"

validation:
  test_korean_text: true
  test_english_retention: true
  retention_threshold: 0.97

tags:
  - "phase4"
  - "korean_text"
  - "per_layer_ce"
  - "retention_check"
