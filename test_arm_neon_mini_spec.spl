use compiler.backend.native.arm_neon.{q_to_index, encode_fadd_4s, encode_ldr_q}
use compiler.backend.native.mach_inst.{AARCH64_Q0, AARCH64_Q1, AARCH64_Q2, AARCH64_Q3}

describe "ARM NEON Quick Test":
    it "converts Q register IDs":
        expect(q_to_index(AARCH64_Q0)).to_equal(0)
        expect(q_to_index(AARCH64_Q1)).to_equal(1)
        expect(q_to_index(AARCH64_Q2)).to_equal(2)

    it "encodes FADD.4S":
        val bytes = encode_fadd_4s(AARCH64_Q0, AARCH64_Q1, AARCH64_Q2)
        expect(bytes.len()).to_equal(4)
        expect(bytes[3]).to_equal(0x4E)

    it "encodes LDR Q0, [X1, #0]":
        val bytes = encode_ldr_q(AARCH64_Q0, 1, 0)
        expect(bytes.len()).to_equal(4)
        expect(bytes[3]).to_equal(0x3D)
