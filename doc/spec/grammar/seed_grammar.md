# Simple Language Grammar - Seed Tier

> **Seed tier**: The C++ bootstrap compiler (`src/compiler_src/compiler_seed/seed.cpp`). Minimal subset
> of Simple needed to compile the core compiler.

*Generated by `bin/simple grammar-doc` from `doc/spec/grammar/tier_keywords.sdn`.*

---

## Keywords

| Keyword | Category | Tier | Description | Example |
|---------|----------|------|-------------|---------|
| `fn` | declarations | seed | Function definition | `fn square(x: i64) -> i64: x * x` |
| `val` | declarations | seed | Immutable binding | `val name = "Alice"` |
| `var` | declarations | seed | Mutable binding | `var count = 0` |
| `struct` | declarations | seed | Struct definition | `struct Point: x: i64; y: i64` |
| `enum` | declarations | seed | Enum definition | `enum Color: Red; Green; Blue` |
| `class` | declarations | seed | Class definition (struct with methods) | `class Dog: name: text` |
| `impl` | declarations | seed | Method implementation block | `impl Point: fn len(): ...` |
| `extern` | declarations | seed | External function declaration (FFI) | `extern fn rt_print(s: text)` |
| `use` | declarations | seed | Module import | `use std.math.{sqrt, abs}` |
| `export` | declarations | seed | Symbol export | `export my_fn, MyType` |
| `import` | declarations | seed | Module import (deprecated, use use) |  |
| `if` | control_flow | seed | Conditional branch | `if x > 0: print "positive"` |
| `elif` | control_flow | seed | Else-if branch |  |
| `else` | control_flow | seed | Else branch |  |
| `for` | control_flow | seed | For loop | `for item in items: print item` |
| `while` | control_flow | seed | While loop |  |
| `match` | control_flow | seed | Pattern match expression | `match value: case 1: ...` |
| `case` | control_flow | seed | Match arm |  |
| `return` | control_flow | seed | Return from function | `return result` |
| `break` | control_flow | seed | Break out of loop |  |
| `continue` | control_flow | seed | Skip to next iteration |  |
| `in` | control_flow | seed | Membership / iteration operator |  |
| `true` | expressions | seed | Boolean true literal | `val done = true` |
| `false` | expressions | seed | Boolean false literal |  |
| `nil` | expressions | seed | Null/none value | `var result = nil` |

## Operators

| Operator | Symbol | Tier |
|----------|--------|------|
| plus | `+` | seed |
| minus | `-` | seed |
| star | `*` | seed |
| slash | `/` | seed |
| percent | `%` | seed |
| eq | `==` | seed |
| not_eq | `!=` | seed |
| lt | `<` | seed |
| gt | `>` | seed |
| lt_eq | `<=` | seed |
| gt_eq | `>=` | seed |
| assign | `=` | seed |
| plus_eq | `+=` | seed |
| minus_eq | `-=` | seed |
| star_eq | `*=` | seed |
| slash_eq | `/=` | seed |
| percent_eq | `%=` | seed |
| dot_dot | `..` | seed |

## Constructs

| Construct | Tier |
|-----------|------|
| string_interpolation | seed |
| raw_string | seed |
| range_expr | seed |
| array_literal | seed |
| struct_constructor | seed |

---

**Summary:** 25 keywords, 18 operators, 5 constructs

## Conditional Compilation (Platform/CPU)

Seed supports C-style source conditional directives:

- `#if <condition>`
- `#elif <condition>`
- `#else`
- `#endif`

Optional trailing `:` is accepted on hash directives (for example `#if linux:` and `#else:`).

### Supported condition atoms

- OS: `win`, `windows`, `linux`, `mac`, `macos`, `darwin`, `freebsd`, `openbsd`, `netbsd`, `android`, `unix`
- CPU/arch: `x86_64`, `amd64`, `x64`, `x86`, `i386`, `i686`, `aarch64`, `arm64`, `riscv64`, `riscv32`, `arm`, `ppc64le`
- Key/value: `os=linux`, `platform=windows`, `arch=x86_64`, `cpu=arm64`
- Boolean: `true`, `false`, `and`/`&&`, `or`/`||`, `not`/`!`
- Build: `debug`, `release`, `compiled`, `interpreter`

### Target override environment variables

- `SIMPLE_TARGET_OS`
- `SIMPLE_TARGET_ARCH`
- `SIMPLE_TARGET_CPU`

## Binary Completeness Gaps (2026-02-18)

> Hand-maintained status notes. Generated tables above are unchanged.

### Current Seed Limitations For "Generate Any Binary"

| Capability needed for low-level complete binaries | Current seed behavior | Evidence |
|---|---|---|
| Bitfield declarations and exact bit layout | Not supported in seed subset | `src/compiler_src/compiler_seed/seed.cpp:32`, `src/compiler_src/compiler_seed/seed.cpp:35` |
| Packed/representation/alignment controls (`@packed`, `@repr`, `@align`) | No seed-level parse/lowering path | Seed supported-subset list does not include attributes (`src/compiler_src/compiler_seed/seed.cpp:14`) |
| `union` declarations with C-style layout | No declaration support; only reserved-word rename in emitted C++ | `src/compiler_src/compiler_seed/seed.cpp:3763` |
| Inline assembly (`asm`) with constraints/clobbers | No asm translation path in seed (only keyword rename macro) | `src/compiler_src/compiler_seed/seed.cpp:3755` |
| Module/import/export semantics for linker-visible composition | Skipped during translation | `src/compiler_src/compiler_seed/seed.cpp:2929` |
| Trait/type-style declarations in codegen path | Trait blocks are dropped in parse/emission | `src/compiler_src/compiler_seed/seed.cpp:3700`, `src/compiler_src/compiler_seed/seed.cpp:4245` |
| Arbitrary custom/raw blocks (including `asm{...}`-style payload workflows) | Translator uses whitelist and drops non-safe patterns in module init | `src/compiler_src/compiler_seed/seed.cpp:4723` |

### Minimum Additions Needed In Seed

1. Add first-class AST+parser support for `bitfield`, `union`, inline `asm`, and custom payload blocks.
2. Add attribute parsing/lowering for layout and ABI controls (`@repr`, `@packed`, `@align`, `@link_section`, `@addr_space`, `@callconv`, `@naked`, `@interrupt`).
3. Preserve and lower `use`/`import`/`export`/`mod` semantics instead of skipping them.
4. Emit deterministic data layout (`packed`, explicit alignment, explicit union storage) rather than dynamic fallbacks.
5. Add inline asm lowering that carries template, inputs/outputs, clobbers, and volatility options to backend codegen.
