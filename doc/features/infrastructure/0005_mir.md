# Feature #5: MIR

## Overview

| Property | Value |
|----------|-------|
| **Feature ID** | #5 |
| **Feature Name** | MIR |
| **Category** | Infrastructure |
| **Difficulty** | 4 (Hard) |
| **Status** | Complete |
| **Implementation** | Rust |

## Description

Mid-level IR with 50+ instruction variants. Lowers HIR to basic blocks with explicit control flow. Handles arithmetic, memory, collections, patterns, async, and generators.

## Specification

[doc/codegen_technical.md](../../codegen_technical.md)

## Implementation

### Files

| File | Purpose |
|------|---------|
| `src/compiler/src/mir/mod.rs` | MIR module |
| `src/compiler/src/mir/instructions.rs` | 50+ instruction variants |
| `src/compiler/src/mir/blocks.rs` | Basic block management |

## Instruction Categories

| Category | Count | Examples |
|----------|-------|----------|
| Core | 6 | ConstInt, BinOp, UnaryOp |
| Memory | 6 | Load, Store, FieldGet |
| Collections | 7 | ArrayLit, TupleLit, IndexGet |
| Strings | 3 | ConstString, FStringFormat |
| Patterns | 6 | PatternTest, PatternBind |
| Async | 5 | FutureCreate, Await |
| Generators | 3 | GeneratorCreate, Yield |

## Testing

### Test Files

| Test File | Description |
|-----------|-------------|
| `simple/std_lib/test/features/infrastructure/mir_spec.spl` | BDD spec (18 tests) |

## Dependencies

- Depends on: #4
- Required by: #100

## Notes

MIR uses SSA form. Generator lowering creates state machines. Effect tracking for async safety.
