# Feature #9: SMF

## Overview

| Property | Value |
|----------|-------|
| **Feature ID** | #9 |
| **Feature Name** | SMF |
| **Category** | Infrastructure |
| **Difficulty** | 3 (Medium) |
| **Status** | Complete |
| **Implementation** | Rust |

## Description

Simple Module Format - binary executable format for compiled Simple programs. Supports sections, symbols, relocations, and memory mapping for efficient loading and execution.

## Specification

[doc/architecture/README.md](../../architecture/README.md)

## Implementation

### Files

| File | Purpose |
|------|---------|
| `src/loader/src/smf/mod.rs` | SMF format definitions |
| `src/loader/src/smf/header.rs` | Header parsing |
| `src/compiler/src/linker/smf_writer.rs` | SMF emission |

## File Structure

```
+------------------+
| SMF Header       |  Magic, version, flags
+------------------+
| Section Table    |  Section descriptors
+------------------+
| .text (Code)     |  Executable code
+------------------+
| .data (Data)     |  Initialized data
+------------------+
| .rodata (RoData) |  Read-only data
+------------------+
| .bss (Bss)       |  Uninitialized data
+------------------+
| Symbol Table     |  Function/data symbols
+------------------+
| Relocations      |  Address fixups
+------------------+
```

## Section Types

| Type | Purpose | Flags |
|------|---------|-------|
| Code | Executable instructions | R+X |
| Data | Initialized globals | R+W |
| RoData | Constants, strings | R |
| Bss | Zero-initialized data | R+W |
| SymTab | Symbol table | R |
| StrTab | String table | R |
| Debug | Debug information | R |

## Testing

### Test Files

| Test File | Description |
|-----------|-------------|
| `simple/std_lib/test/features/infrastructure/smf_spec.spl` | BDD spec (18 tests) |

## Dependencies

- Depends on: #5
- Required by: None

## Notes

Magic: SMF\0. Sections: Code, Data, RoData, BSS, Reloc, SymTab, StrTab, Debug. Supports 64-bit architectures.
