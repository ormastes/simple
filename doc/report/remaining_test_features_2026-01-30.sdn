report:
  title: "Remaining Test Features Analysis"
  date: 2026-01-30
  generated_from: "doc/test/test_result.md (2026-01-29)"

test_summary:
  total_tests: 912
  passed: 817
  failed: 95
  pass_rate: 89.6%
  fail_rate: 10.4%

runtime_test_summary:
  total_tests: 7436
  passed: 6728
  failed: 708
  pass_rate: 90.5%
  fail_rate: 9.5%

feature_summary:
  total_features: 0
  pending_features: 0
  completion: 100%
  status: "All tracked features complete"

failed_test_categories |category, count, examples|
  parse_errors, 60, "Unexpected token errors"
  missing_files, 15, "/tmp/*.spl files not found"
  semantic_errors, 10, "Function not found, type errors"
  compilation_errors, 10, "Various compile failures"

top_parse_errors |error_type, count, example|
  "expected expression, found X", 15, "expected expression, found Default"
  "expected Fn, found X", 8, "expected Fn, found Static"
  "expected Comma, found X", 7, "expected Comma, found Identifier"
  "expected identifier, found X", 6, "expected identifier, found Static"
  "expected pattern, found X", 5, "expected pattern, found Val"
  "expected RBracket, found Comma", 4, "Array literal parsing"
  indentation_errors, 5, "Unexpected Indent/Dedent"

parse_error_patterns:
  static_keyword:
    issue: "Static methods/functions not properly recognized in all contexts"
    examples:
      - "expected Fn, found Static"
      - "expected identifier, found Static"
    affected_tests: 8
    priority: high

  default_keyword:
    issue: "Default keyword not treated as expression in some contexts"
    examples:
      - "expected expression, found Default"
    affected_tests: 3
    priority: medium

  assignment_in_expression:
    issue: "Assignment operator '=' in expression position"
    examples:
      - "expected expression, found Assign"
    affected_tests: 6
    priority: medium

  missing_commas:
    issue: "Missing comma between identifiers/arguments"
    examples:
      - "expected Comma, found Identifier { name: 'resolve', pattern: Immutable }"
    affected_tests: 7
    priority: high
    note: "Phase 1 partially addresses this for function arguments"

  array_literal_commas:
    issue: "Incorrect comma handling in array literals"
    examples:
      - "expected RBracket, found Comma"
    affected_tests: 4
    priority: medium

  indentation:
    issue: "Indentation-sensitive parsing issues"
    examples:
      - "expected expression, found Indent"
      - "expected indented block after ':', found Dedent"
    affected_tests: 10
    priority: high

improvement_opportunities:
  phase1_impact:
    addressed: "Missing commas in function arguments now have better error messages"
    remaining: "Dict literals, struct initialization, array literals still need work"
    coverage: "~15% of parse errors (7/60 cases for function args)"

  next_priorities:
    - category: "static keyword handling"
      description: "Allow static in more contexts (class bodies, trait impls)"
      affected_tests: 8
      difficulty: medium

    - category: "indentation errors"
      description: "Better indentation tracking and error messages"
      affected_tests: 10
      difficulty: high

    - category: "expression context"
      description: "Allow default/assign/etc in expression positions where appropriate"
      affected_tests: 15
      difficulty: medium

    - category: "missing comma detection"
      description: "Extend Phase 1 work to all comma contexts"
      affected_tests: 11
      difficulty: low
      note: "Can reuse Phase 1 infrastructure"

missing_file_issues:
  pattern: "/tmp/*.spl files"
  count: 15
  issue: "Tests reference temp files that don't exist"
  cause: "Generated test files or test cleanup issue"
  priority: low
  solution: "Clean up test references or regenerate test files"

semantic_error_issues:
  function_not_found: 10
  type_errors: 5
  note: "These are not parser issues but semantic analysis failures"
  priority: low

recommendations:
  phase2_enhancements:
    - "Extend contextual error messages to dict/struct/array parsing"
    - "Add fix suggestions for indentation errors"
    - "Detect 'static' keyword in wrong position and suggest fix"

  parser_improvements:
    - "Allow 'static' keyword in class method definitions"
    - "Better expression vs statement disambiguation"
    - "Smarter indentation error recovery"

  test_cleanup:
    - "Remove/fix references to missing /tmp/*.spl files"
    - "Review semantic test failures (may need stdlib updates)"

phase1_vs_remaining:
  phase1_coverage: "Function argument comma errors (7/95 = 7.4%)"
  remaining_comma_errors: "Dict literals (3), struct init (2), arrays (4) = 9 tests"
  total_addressable_by_phase1_approach: "16/95 = 16.8%"
  other_issues: "79/95 = 83.2% need different solutions"

blockers_for_100_percent:
  parser_features:
    - "Static method syntax in all contexts"
    - "Better indentation tracking"
    - "Expression vs statement context handling"

  test_infrastructure:
    - "Missing temp file cleanup/generation"
    - "Semantic analysis improvements (not parser)"

next_steps:
  immediate:
    - "Extend Phase 1 contextual errors to dict/struct/array"
    - "Add 'static' keyword support in class bodies"
    - "Clean up missing file test references"

  short_term:
    - "Complete Phase 2: Fix Suggestion System"
    - "Add indentation error recovery"
    - "Improve expression context handling"

  long_term:
    - "Complete Phase 3: Interactive CLI"
    - "Address semantic errors (separate from parser)"
    - "Achieve 95%+ test pass rate"

current_status:
  pass_rate: 89.6%
  target_pass_rate: 95%
  gap: 5.4%
  tests_to_fix: 48
  estimate: "2-3 weeks for 95%, 4-6 weeks for 98%"
